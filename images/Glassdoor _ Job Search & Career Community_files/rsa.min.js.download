var rudderanalytics=function(e){"use strict";function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(i,r)}function i(e){return function(){var t=this,i=arguments;return new Promise(function(r,o){var a=e.apply(t,i);function s(e){n(a,r,o,s,u,"next",e)}function u(e){n(a,r,o,s,u,"throw",e)}s(void 0)})}}function r(e,t,n){return t=c(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,v()?Reflect.construct(t,n||[],c(e).constructor):t.apply(e,n))}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,E(i.key),i)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return(t=E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},l.apply(null,arguments)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(v=function(){return!!e})()}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(){var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,i,r,o){var u=i&&i.prototype instanceof s?i:s,l=Object.create(u.prototype);return p(l,"_invoke",function(n,i,r){var o,s,u,l=0,c=r||[],d=!1,v={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,u=e,v.n=n,a}};function f(n,i){for(s=n,u=i,t=0;!d&&l&&!r&&t<c.length;t++){var r,o=c[t],f=v.p,h=o[2];n>3?(r=h===i)&&(u=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(s=0,v.v=i,v.n=o[1]):f<h&&(r=n<3||o[0]>i||i>h)&&(o[4]=n,o[5]=i,v.n=h,s=0))}if(r||n>1)return a;throw d=!0,i}return function(r,c,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,h),s=c,u=h;(t=s<2?e:u)||!d;){o||(s?s<3?(s>1&&(v.n=-1),f(s,u)):v.n=u:v.v=u);try{if(l=2,o){if(s||(r="next"),t=o[r]){if(!(t=t.call(o,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=e}else if((t=(d=v.n<0)?u:n.call(i,v))!==a)break}catch(t){o=e,s=1,u=t}finally{l=1}}return{value:t,done:d}}}(n,r,o),!0),l}var a={};function s(){}function u(){}function l(){}t=Object.getPrototypeOf;var c=[][i]?t(t([][i]())):(p(t={},i,function(){return this}),t),d=l.prototype=s.prototype=Object.create(c);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,p(e,r,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=l,p(d,"constructor",l),p(l,"constructor",u),u.displayName="GeneratorFunction",p(l,r,"GeneratorFunction"),p(d),p(d,r,"Generator"),p(d,i,function(){return this}),p(d,"toString",function(){return"[object Generator]"}),(g=function(){return{w:o,m:v}})()}function p(e,t,n,i){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}p=function(e,t,n,i){function o(t,n){p(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},p(e,t,n,i)}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t);else for(;!(u=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return s}}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t,n,i){var r=l(c(e.prototype),t,n);return 2&i&&"function"==typeof r?function(e){return r.apply(n,e)}:r}function k(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function I(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}function S(e){return null!=e&&"object"===A(e)&&!0===e["@@functional/placeholder"]}function T(e){return function t(n){return 0===arguments.length||S(n)?t:e.apply(this,arguments)}}function w(e){return function t(n,i){switch(arguments.length){case 0:return t;case 1:return S(n)?t:T(function(t){return e(n,t)});default:return S(n)&&S(i)?t:S(n)?T(function(t){return e(t,i)}):S(i)?T(function(t){return e(n,t)}):e(n,i)}}}function O(e){return function t(n,i,r){switch(arguments.length){case 0:return t;case 1:return S(n)?t:w(function(t,i){return e(n,t,i)});case 2:return S(n)&&S(i)?t:S(n)?w(function(t,n){return e(t,i,n)}):S(i)?w(function(t,i){return e(n,t,i)}):T(function(t){return e(n,i,t)});default:return S(n)&&S(i)&&S(r)?t:S(n)&&S(i)?w(function(t,n){return e(t,n,r)}):S(n)&&S(r)?w(function(t,n){return e(t,i,n)}):S(i)&&S(r)?w(function(t,i){return e(n,t,i)}):S(n)?T(function(t){return e(t,i,r)}):S(i)?T(function(t){return e(n,t,r)}):S(r)?T(function(t){return e(n,i,t)}):e(n,i,r)}}}function P(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var C=T(function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)});function D(e){return"[object Object]"===Object.prototype.toString.call(e)}var R=Number.isInteger||function(e){return(e|0)===e};function M(e,t){return t[e<0?t.length+e:e]}function N(e,t,n){if(n||(n=new x),function(e){var t=A(e);return null==e||"object"!=t&&"function"!=t}(e))return e;var i,r=function(t){var i=n.get(e);if(i)return i;for(var r in n.set(e,t),e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=N(e[r],!0,n));return t};switch(C(e)){case"Object":return r(Object.create(Object.getPrototypeOf(e)));case"Array":return r(Array(e.length));case"Date":return new Date(e.valueOf());case"RegExp":return i=e,new RegExp(i.source,i.flags?i.flags:(i.global?"g":"")+(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.sticky?"y":"")+(i.unicode?"u":"")+(i.dotAll?"s":""));case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return e.slice();default:return e}}var x=function(){function e(){this.map={},this.length=0}return e.prototype.set=function(e,t){var n=this.hash(e),i=this.map[n];i||(this.map[n]=i=[]),i.push([e,t]),this.length+=1},e.prototype.hash=function(e){var t=[];for(var n in e)t.push(Object.prototype.toString.call(e[n]));return t.join()},e.prototype.get=function(e){if(this.length<=180)for(var t in this.map)for(var n=this.map[t],i=0;i<n.length;i+=1){if((o=n[i])[0]===e)return o[1]}else{var r=this.hash(e);if(n=this.map[r])for(i=0;i<n.length;i+=1){var o;if((o=n[i])[0]===e)return o[1]}}},e}(),_=T(function(e){return null!=e&&"function"==typeof e.clone?e.clone():N(e)});function L(e,t){for(var n=t,i=0;i<e.length;i+=1){if(null==n)return;var r=e[i];n=R(r)?M(r,n):n[r]}return n}var B=O(function(e,t,n){var i,r={};for(i in n=n||{},t=t||{})P(i,t)&&(r[i]=P(i,n)?e(i,t[i],n[i]):t[i]);for(i in n)P(i,n)&&!P(i,r)&&(r[i]=n[i]);return r}),U=O(function e(t,n,i){return B(function(n,i,r){return D(i)&&D(r)?e(t,i,r):t(n,i,r)},n,i)}),j=O(function(e,t,n){return U(function(t,n,i){return e(n,i)},t,n)}),F=w(L),G=w(function(e,t){var n={};for(var i in t)e(t[i],i,t)&&(n[i]=t[i]);return n}),H=function(e){return"function"==typeof e&&Boolean(e.constructor&&e.call&&e.apply)},z=function(e){return"string"==typeof e},Q=function(e){return null===e},K=function(e){return void 0===e},V=function(e){return Q(e)||K(e)},q=function(e){return!K(e)},X=function(e){return!V(e)},W=function(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}},J=function(e){return"boolean"==typeof e},Y=function(e,t){var n=t.split(".");return F(n,e)},$=function(e){return!Q(e)&&function(e){return"object"===A(e)}(e)&&!Array.isArray(e)},Z=function(e){return!Q(e)&&"[object Object]"===Object.prototype.toString.call(e)},ee=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return _(t);var n=_(e);return t.forEach(function(e,t){n[t]=Array.isArray(e)||$(e)?te(n[t],e):e}),n},te=function(e,t){return j(ee,e,t)},ne=function(e){return Z(e)&&Object.keys(e).length>0},ie=function(e){var t=G(q,e);return Object.keys(t).forEach(function(e){var n=t[e];Z(n)&&(t[e]=ie(n))}),t},re=function(e){var t=G(X,e);return Object.keys(t).forEach(function(e){var n=t[e];Z(n)&&(t[e]=re(n))}),t},oe=function(e){if(ne(e))return re(e)},ae=function(e,t){return"boolean"==typeof e?e:t},se=function(e){return Object.getOwnPropertyNames(e).forEach(function(t){e[t]&&"object"===A(e[t])&&se(e[t])}),Object.freeze(e)},ue=function(e){return e.replace(/^\.+/,"")},le=function(e){var t=e;if(!z(e)&&!V(e))try{t=JSON.stringify(e)}catch(St){t=null}return t},ce=function(e){return t=(new TextEncoder).encode(e),n=Array.from(t,function(e){return String.fromCodePoint(e)}).join(""),globalThis.btoa(n);var t,n},de=function(e){return(new TextDecoder).decode((t=e,n=globalThis.atob(t).split("").map(function(e){return e.charCodeAt(0)}),new Uint8Array(n)));var t,n},ve=function(e,t,n,i,r){var o={category:e,name:t,properties:n,options:i,callback:void 0};H(r)&&(o.callback=r),H(i)&&(o.category=e,o.name=t,o.properties=n,o.options=void 0,o.callback=i),H(n)&&(o.category=e,o.name=t,o.properties=void 0,o.options=void 0,o.callback=n),H(t)&&(o.category=e,o.name=void 0,o.properties=void 0,o.options=void 0,o.callback=t),H(e)&&(o.category=void 0,o.name=void 0,o.properties=void 0,o.options=void 0,o.callback=e),Z(e)?(o.name=void 0,o.category=void 0,o.properties=e,H(t)?o.options=void 0:o.options=t):Z(t)&&(o.name=void 0,o.properties=t,H(n)?o.options=void 0:o.options=n),z(e)&&!z(t)&&(o.category=void 0,o.name=e),q(o.category)||(o.category=void 0),q(o.name)||(o.name=void 0),o.properties=o.properties?_(o.properties):{},q(o.options)?o.options=_(o.options):o.options=void 0;var a=z(o.name)?o.name:o.properties.name,s=z(o.category)?o.category:o.properties.category;return o.properties=te(Z(o.properties)?o.properties:{},h(h({},a&&{name:a}),s&&{category:s})),o},fe=function(e,t,n,i){var r={name:e,properties:t,options:n,callback:void 0};return H(i)&&(r.callback=i),H(n)&&(r.properties=t,r.options=void 0,r.callback=n),H(t)&&(r.properties=void 0,r.options=void 0,r.callback=t),r.properties=X(r.properties)?_(r.properties):{},q(r.options)?r.options=_(r.options):r.options=void 0,r},he=function(e,t,n,i){var r={userId:e,traits:t,options:n,callback:void 0};return H(i)&&(r.callback=i),H(n)&&(r.userId=e,r.traits=t,r.options=void 0,r.callback=n),H(t)&&(r.userId=e,r.traits=void 0,r.options=void 0,r.callback=t),(Z(e)||Q(e))&&(r.userId=null,r.traits=e,H(t)?r.options=void 0:r.options=t),r.userId=le(r.userId),Z(r.traits)?r.traits=_(r.traits):r.traits=void 0,q(r.options)?r.options=_(r.options):r.options=void 0,r},ge=function(e,t,n,i){var r={to:e,from:t,options:n,callback:void 0};return H(i)&&(r.callback=i),H(n)&&(r.to=e,r.from=t,r.options=void 0,r.callback=n),H(t)?(r.to=e,r.from=void 0,r.options=void 0,r.callback=t):(Z(t)||Q(t))&&(r.to=e,r.from=void 0,r.options=t),q(r.to)&&(r.to=le(r.to)),q(r.from)?r.from=le(r.from):r.from=void 0,q(r.options)?r.options=_(r.options):r.options=void 0,r},pe=function(e,t,n,i){var r={groupId:e,traits:t,options:n,callback:void 0};return H(i)&&(r.callback=i),H(n)&&(r.groupId=e,r.traits=t,r.options=void 0,r.callback=n),H(t)&&(r.groupId=e,r.traits=void 0,r.options=void 0,r.callback=t),(Z(e)||Q(e))&&(r.groupId=null,r.traits=e,H(t)?r.options=void 0:r.options=t),r.groupId=le(r.groupId),Z(r.traits)?r.traits=_(r.traits):r.traits=void 0,q(r.options)?r.options=_(r.options):r.options=void 0,r},ye=function(e){return e.UNLOADED="Page Unloaded",e}({}),me="API",be="CapabilitiesManager",ke="ConfigManager",Ee="EventManager",Ae="PluginsManager",Ie="UserSessionManager",Se="ErrorHandler",Te="PluginEngine",we="Ready".concat(me),Oe="Load".concat(me),Pe="AnalyticsCore";for(var Ce,De=[],Re=0;Re<256;Re++)De[Re]=(Re+256).toString(16).substring(1);function Me(){var e;(!Ce||Re+16>4096)&&(e=4096,Ce=crypto.getRandomValues(new Uint8Array(e)),Re=0);for(var t,n=0,i="";n<16;n++)t=Ce[Re+n],i+=6==n?De[15&t|64]:8==n?De[63&t|128]:De[t],1&n&&n>1&&n<11&&(i+="-");return Re+=16,i}for(var Ne,xe=256,_e=[];xe--;)_e[xe]=(xe+256).toString(16).substring(1);var Le=function(){return!V(globalThis.crypto)&&H(globalThis.crypto.getRandomValues)?Me():function(){var e,t=0,n="";if(!Ne||xe+16>256){for(Ne=Array(t=256);t--;)Ne[t]=256*Math.random()|0;t=xe=0}for(;t<16;t++)e=Ne[xe+t],n+=6==t?_e[15&e|64]:8==t?_e[63&e|128]:_e[e],1&t&&t>1&&t<11&&(n+="-");return xe++,n}()},Be=function(){return z(globalThis.navigator.userAgent)&&/Trident.*rv:11\./.test(globalThis.navigator.userAgent)},Ue=function(e){var t=!1,n=!1;function i(){t||(t=!0,e(n),setTimeout(function(){t=!1},0))}Be()&&globalThis.addEventListener("beforeunload",function(){n=!1,i()}),globalThis.addEventListener("blur",function(){n=!0,i()}),globalThis.addEventListener("focus",function(){t=!1}),document.addEventListener("pagehide",function(){n="hidden"===document.visibilityState,i()}),document.addEventListener("visibilitychange",function(){n=!0,"hidden"===document.visibilityState?i():t=!1})},je=function(e){return e.toISOString()},Fe=function(){return je(new Date)},Ge=":: ",He=function(e,t,n){return"Unable to load (".concat(z(n)?n:n.type,') the script with the id "').concat(e,'" from URL "').concat(t,'"')},ze="[Circular Reference]",Qe=function(e,t,n){var i=[];return function(r,o){if(!(null!=t&&t.includes(r)||e&&V(o))){if("object"!==A(o)||Q(o))return o;for(;i.length>0&&i[i.length-1]!==this;)i.pop();return i.includes(o)?(null==n||n.warn(function(e,t){return"".concat(e).concat(Ge,'A circular reference has been detected in the object and the property "').concat(t,'" has been dropped from the output.')}("JSONStringify",r)),ze):(i.push(o),o)}}},Ke=function(e,t,n,i){try{return JSON.stringify(e,Qe(t,n,i))}catch(r){return null==i||i.warn("Failed to convert the value to a JSON string.",r),null}},Ve=function(e,t){var n=Array.isArray(e)?[]:{};for(var i in e)if(Object.hasOwnProperty.call(e,i)){var r=e[i],o=t.call(e,i,r);Z(o)||Array.isArray(o)?n[i]=Ve(o,t):n[i]=o}return n},qe=function(e,t){var n,i=(n=[],function(e,t){if(function(e){return"bigint"==typeof e}(t))return"[BigInt]";for(;n.length>0&&n[n.length-1]!==this;)n.pop();return n.includes(t)?ze:(n.push(t),t)}),r=i.call(e,"",e);return Z(e)||Array.isArray(e)?Ve(e,i):r},Xe="[SDK DISPATCHED ERROR]",We=function(e){var t,n=e.stack,i=e.stacktrace,r=e["opera#sourceloc"],o=null!==(t=null!=n?n:i)&&void 0!==t?t:r;if(o&&"string"==typeof o)return o},Je=function(e,t){if(!W(e))return new Error("".concat(t,": ").concat(Ke(e)));try{var n=new(0,e.constructor)("".concat(t,": ").concat(e.message)),i=We(e);return i&&(n.stack=i),Object.getOwnPropertyNames(e).forEach(function(t){if("message"!==t&&"stack"!==t&&"name"!==t)try{n[t]=e[t]}catch(i){}}),n}catch(r){return new Error("".concat(t,": ").concat(Ke(e)))}},Ye=function(e){if(W(e)){var t=We(e);if(t){var n=e.stack,i=e.stacktrace,r=e["opera#sourceloc"];switch(t){case n:e.stack="".concat(n,"\n").concat(Xe);break;case i:e.stacktrace="".concat(i,"\n").concat(Xe);break;default:e["opera#sourceloc"]="".concat(r,"\n").concat(Xe)}}}globalThis.dispatchEvent(new ErrorEvent("error",{error:e,bubbles:!0,cancelable:!0,composed:!0}))},$e="RudderLabs JavaScript SDK",Ze="3.24.1",et="RudderJS-Initiated",tt="preloadedEventsBuffer",nt="ajs_aid",it="ajs_uid",rt="ajs_event",ot=432e5,at=18e5,st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app";globalThis.RudderStackGlobals||(globalThis.RudderStackGlobals={}),globalThis.RudderStackGlobals[e]||(globalThis.RudderStackGlobals[e]={})},ut=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"app";st(n),globalThis.RudderStackGlobals[n][e]=t},lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"app";return st(t),globalThis.RudderStackGlobals[t][e]};var ct=function(e,t){var n={};return e.forEach(function(i,r){if(r.startsWith(t)){var o=r.substring(t.length);n[o]=e.get(r)}}),n},dt=function(e){var t=lt(tt)||[];!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="ajs_trait_",n="ajs_prop_",i=new URLSearchParams(globalThis.location.search);i.get(rt)&&e.unshift(["track",i.get(rt),ct(i,n)]),i.get(it)&&e.unshift(["identify",i.get(it),ct(i,t)]),i.get(nt)&&e.unshift(["setAnonymousId",i.get(nt)])}(t),t.length>0&&(e.enqueuePreloadBufferEvents(t),ut(tt,[]))},vt=function(e,t){var n,i,r=e.shift();if(H(t[r])){switch(r){case"page":i=ve.apply(void 0,k(e));break;case"track":i=fe.apply(void 0,k(e));break;case"identify":i=he.apply(void 0,k(e));break;case"alias":i=ge.apply(void 0,k(e));break;case"group":i=pe.apply(void 0,k(e));break;default:(n=t)[r].apply(n,k(e))}i&&t[r](i)}},ft=function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4?arguments[4]:void 0;return new Promise(function(o,a){document.getElementById(t)&&a(new Error(function(e){return'A script with the id "'.concat(e,'" is already loaded. Skipping the loading of this script to prevent conflicts')}(t)));try{var s;!function(e){var t,n=document.getElementsByTagName("head");if(n.length>0){var i,r;null===(i=n[0])||void 0===i||i.insertBefore(e,null===(r=n[0])||void 0===r?void 0:r.firstChild)}else{var o=document.getElementsByTagName("script");if(o.length>0&&null!==(t=o[0])&&void 0!==t&&t.parentNode){var a;null===(a=o[0])||void 0===a||a.parentNode.insertBefore(e,o[0])}else{var s=document.createElement("head");s.appendChild(e);var u=document.getElementsByTagName("html")[0];null==u||u.insertBefore(s,u.firstChild)}}}(function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=document.createElement("script");return a.type="text/javascript",a.onload=i,a.onerror=r,a.src=e,a.id=t,a.async=n,Object.keys(o).forEach(function(e){a.setAttribute(e,o[e])}),a.setAttribute("data-loader","RS_JS_SDK"),a}(e,t,i,function(){globalThis.clearTimeout(s),o(t)},function(n){globalThis.clearTimeout(s),a(new Error(He(t,e,n)))},r)),s=globalThis.setTimeout(function(){a(new Error(function(e,t,n){return"A timeout of ".concat(n,' ms occurred while trying to load the script with id "').concat(e,'" from URL "').concat(t,'"')}(t,e,n)))},n)}catch(u){a(Je(u,He(t,e,"unknown")))}})},ht=function(){return s(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;o(this,e),this.logger=t,this.timeout=n},[{key:"loadJSFile",value:function(e){var t=e.url,n=e.id,i=e.timeout,r=e.async,o=e.callback,a=e.extraAttributes,s=!H(o);ft(t,n,i||this.timeout,r,a).then(function(e){s||o(e)}).catch(function(e){s||o(n,e)})}}])}(),gt=Symbol.for("preact-signals");function pt(){if(Et>1)Et--;else{for(var e,t=!1;void 0!==kt;){var n=kt;for(kt=void 0,At++;void 0!==n;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Ot(n))try{n.c()}catch(n){t||(e=n,t=!0)}n=i}}if(At=0,Et--,t)throw e}}function yt(e){if(Et>0)return e();Et++;try{return e()}finally{pt()}}var mt=void 0;function bt(e){var t=mt;mt=void 0;try{return e()}finally{mt=t}}var kt=void 0,Et=0,At=0,It=0;function St(e){if(void 0!==mt){var t=e.n;if(void 0===t||t.t!==mt)return t={i:0,S:e,p:mt.s,n:void 0,t:mt,e:void 0,x:void 0,r:t},void 0!==mt.s&&(mt.s.n=t),mt.s=t,e.n=t,32&mt.f&&e.S(t),t;if(-1===t.i)return t.i=0,void 0!==t.n&&(t.n.p=t.p,void 0!==t.p&&(t.p.n=t.n),t.p=mt.s,t.n=void 0,mt.s.n=t,mt.s=t),t}}function Tt(e,t){this.v=e,this.i=0,this.n=void 0,this.t=void 0,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched}function wt(e,t){return new Tt(e,t)}function Ot(e){for(var t=e.s;void 0!==t;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Pt(e){for(var t=e.s;void 0!==t;t=t.n){var n=t.S.n;if(void 0!==n&&(t.r=n),t.S.n=t,t.i=-1,void 0===t.n){e.s=t;break}}}function Ct(e){for(var t=e.s,n=void 0;void 0!==t;){var i=t.p;-1===t.i?(t.S.U(t),void 0!==i&&(i.n=t.n),void 0!==t.n&&(t.n.p=i)):n=t,t.S.n=t.r,void 0!==t.r&&(t.r=void 0),t=i}e.s=n}function Dt(e,t){Tt.call(this,void 0),this.x=e,this.s=void 0,this.g=It-1,this.f=4,this.W=null==t?void 0:t.watched,this.Z=null==t?void 0:t.unwatched}function Rt(e){var t=e.u;if(e.u=void 0,"function"==typeof t){Et++;var n=mt;mt=void 0;try{t()}catch(Zs){throw e.f&=-2,e.f|=8,Mt(e),Zs}finally{mt=n,pt()}}}function Mt(e){for(var t=e.s;void 0!==t;t=t.n)t.S.U(t);e.x=void 0,e.s=void 0,Rt(e)}function Nt(e){if(mt!==this)throw new Error("Out-of-order effect");Ct(this),mt=e,this.f&=-2,8&this.f&&Mt(this),pt()}function xt(e){this.x=e,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function _t(e){var t=new xt(e);try{t.c()}catch(e){throw t.d(),e}var n=t.d.bind(t);return n[Symbol.dispose]=n,n}Tt.prototype.brand=gt,Tt.prototype.h=function(){return!0},Tt.prototype.S=function(e){var t=this,n=this.t;n!==e&&void 0===e.e&&(e.x=n,this.t=e,void 0!==n?n.e=e:bt(function(){var e;null==(e=t.W)||e.call(t)}))},Tt.prototype.U=function(e){var t=this;if(void 0!==this.t){var n=e.e,i=e.x;void 0!==n&&(n.x=i,e.e=void 0),void 0!==i&&(i.e=n,e.x=void 0),e===this.t&&(this.t=i,void 0===i&&bt(function(){var e;null==(e=t.Z)||e.call(t)}))}},Tt.prototype.subscribe=function(e){var t=this;return _t(function(){var n=t.value,i=mt;mt=void 0;try{e(n)}finally{mt=i}})},Tt.prototype.valueOf=function(){return this.value},Tt.prototype.toString=function(){return this.value+""},Tt.prototype.toJSON=function(){return this.value},Tt.prototype.peek=function(){var e=mt;mt=void 0;try{return this.value}finally{mt=e}},Object.defineProperty(Tt.prototype,"value",{get:function(){var e=St(this);return void 0!==e&&(e.i=this.i),this.v},set:function(e){if(e!==this.v){if(At>100)throw new Error("Cycle detected");this.v=e,this.i++,It++,Et++;try{for(var t=this.t;void 0!==t;t=t.x)t.t.N()}finally{pt()}}}}),Dt.prototype=new Tt,Dt.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===It)return!0;if(this.g=It,this.f|=1,this.i>0&&!Ot(this))return this.f&=-2,!0;var e=mt;try{Pt(this),mt=this;var t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return mt=e,Ct(this),this.f&=-2,!0},Dt.prototype.S=function(e){if(void 0===this.t){this.f|=36;for(var t=this.s;void 0!==t;t=t.n)t.S.S(t)}Tt.prototype.S.call(this,e)},Dt.prototype.U=function(e){if(void 0!==this.t&&(Tt.prototype.U.call(this,e),void 0===this.t)){this.f&=-33;for(var t=this.s;void 0!==t;t=t.n)t.S.U(t)}},Dt.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var e=this.t;void 0!==e;e=e.x)e.t.N()}},Object.defineProperty(Dt.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var e=St(this);if(this.h(),void 0!==e&&(e.i=this.i),16&this.f)throw this.v;return this.v}}),xt.prototype.c=function(){var e=this.S();try{if(8&this.f)return;if(void 0===this.x)return;var t=this.x();"function"==typeof t&&(this.u=t)}finally{e()}},xt.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Rt(this),Pt(this),Et++;var e=mt;return mt=this,Nt.bind(this,e)},xt.prototype.N=function(){2&this.f||(this.f|=2,this.o=kt,kt=this)},xt.prototype.d=function(){this.f|=8,1&this.f||Mt(this)},xt.prototype.dispose=function(){this.d()};var Lt=function(){return s(function e(){o(this,e),this.items=[]},[{key:"enqueue",value:function(e){this.items.push(e)}},{key:"dequeue",value:function(){return 0===this.items.length?null:this.items.shift()}},{key:"isEmpty",value:function(){return 0===this.items.length}},{key:"size",value:function(){return this.items.length}},{key:"clear",value:function(){this.items=[]}}])}(),Bt={LOG:0,INFO:1,DEBUG:2,WARN:3,ERROR:4,NONE:5},Ut="ERROR",jt=function(){return s(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LOG",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;o(this,e),this.minLogLevel=Bt[t],this.scope=n,this.logProvider=i},[{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.outputLog("LOG",t)}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.outputLog("INFO",t)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.outputLog("DEBUG",t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.outputLog("WARN",t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.outputLog("ERROR",t)}},{key:"outputLog",value:function(e,t){var n,i;this.minLogLevel<=Bt[e]&&(null===(n=(i=this.logProvider)[e.toLowerCase()])||void 0===n||n.call.apply(n,[i].concat(k(this.formatLogData(t)))))}},{key:"setScope",value:function(e){this.scope=e||this.scope}},{key:"setMinLogLevel",value:function(e){this.minLogLevel=Bt[e],K(this.minLogLevel)&&(this.minLogLevel=Bt.LOG)}},{key:"formatLogData",value:function(e){if(Array.isArray(e)&&e.length>0){var t="%c ".concat("RS SDK");this.scope&&(t="".concat(t," - ").concat(this.scope));var n=z(e[0])?e[0].trim():"",i=[t="".concat(t," %c ").concat(n),"font-weight: bold; background: black; color: white;","font-weight: normal;"];return z(e[0])||i.push(e[0]),i.push.apply(i,k(e.slice(1))),i}return e}}])}(),Ft=new jt,Gt=function(e){return e.HANDLEDEXCEPTION="handledException",e.UNHANDLEDEXCEPTION="unhandledException",e.UNHANDLEDREJECTION="unhandledPromiseRejection",e}({}),Ht=["localStorage","memoryStorage","cookieStorage","sessionStorage","none"],zt="cookieStorage",Qt="Unable to process/parse source configuration response",Kt="Failed to log breadcrumb",Vt=function(e){return"".concat(e).concat(Ge,"Failed to handle the error.")},qt="Failed to fetch the source config",Xt=function(e){return"".concat(e).concat(Ge,"The provided callback parameter is not a function.")},Wt=function(e,t,n){return"".concat(e," due to timeout or no connection (").concat(t?t.type:"",") at the client side for URL: ").concat(n)},Jt="Failed to set/remove cookies via server. As a fallback, the cookies will be managed client side.",Yt={All:!0},$t="js-integrations",Zt=new RegExp("^(https?:\\/\\/)(((([a-zA-Z\\d]([a-zA-Z\\d-]*[a-zA-Z\\d])*)\\.)+[a-zA-Z]{2,}|localhost|((25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)))(\\:\\d+)?(\\/[-a-zA-Z\\d%_.~+]*)*(\\?[;&a-zA-Z\\d%_.~+=-]*)?(\\#[-a-zA-Z\\d_]*)?$"),en="legacy",tn="https://cdn.rudderlabs.com",nn="v3",rn="".concat(tn,"/").concat(nn,"/").concat(en,"/").concat($t),on="".concat(tn,"/").concat(nn,"/").concat(en,"/").concat("plugins"),an="https://api.rudderstack.com",sn="v3",un={iubenda:"IubendaConsentManager",oneTrust:"OneTrustConsentManager",ketch:"KetchConsentManager",custom:"CustomConsentManager"},ln=u(u({},sn,"StorageEncryption"),"legacy","StorageEncryptionLegacy"),cn=u(u({},"xhr","XhrQueue"),"beacon","BeaconQueue"),dn=wt(_({configUrl:an,loadIntegration:!0,sessions:{autoTrack:!0,timeout:at,cutOff:{enabled:!1}},sameSiteCookie:"Lax",polyfillIfRequired:!0,integrations:Yt,useBeacon:!1,beaconQueueOptions:{},destinationsQueueOptions:{},queueOptions:{},lockIntegrationsVersion:!0,lockPluginsVersion:!0,uaChTrackLevel:"none",plugins:[],useGlobalIntegrationsConfigInEvents:!1,bufferDataPlaneEventsUntilReady:!1,dataPlaneEventsBufferTimeout:1e4,storage:{encryption:{version:sn},migrate:!0,cookie:{}},sendAdblockPage:!1,sameDomainCookiesOnly:!1,secureCookie:!1,sendAdblockPageOptions:{},useServerSideCookies:!1})),vn=se({userId:"",userTraits:{},anonymousId:"",groupId:"",groupTraits:{},initialReferrer:"",initialReferringDomain:"",sessionInfo:{},authToken:null}),fn=se({entries:{userId:!0,userTraits:!0,groupId:!0,groupTraits:!0,sessionInfo:!0,authToken:!0,anonymousId:!1,initialReferrer:!1,initialReferringDomain:!1}}),hn={userId:wt(vn.userId),userTraits:wt(vn.userTraits),anonymousId:wt(vn.anonymousId),groupId:wt(vn.groupId),groupTraits:wt(vn.groupTraits),initialReferrer:wt(vn.initialReferrer),initialReferringDomain:wt(vn.initialReferringDomain),sessionInfo:wt(vn.sessionInfo),authToken:wt(vn.authToken)},gn={isOnline:wt(!0),storage:{isLocalStorageAvailable:wt(!1),isCookieStorageAvailable:wt(!1),isSessionStorageAvailable:wt(!1)},isBeaconAvailable:wt(!1),isLegacyDOM:wt(!1),isUaCHAvailable:wt(!1),isCryptoAvailable:wt(!1),isIE11:wt(!1),isAdBlockerDetectionInProgress:wt(!1),isAdBlocked:wt(void 0),cspBlockedURLs:wt([])},pn={isErrorReportingEnabled:wt(!1),isMetricsReportingEnabled:wt(!1),breadcrumbs:wt([])},yn=wt(void 0),mn={activeDataplaneUrl:wt(void 0),integrationsCDNPath:wt(rn),pluginsCDNPath:wt(on),sourceConfigUrl:wt(void 0),status:wt(void 0),initialized:wt(!1),logLevel:wt(Ut),loaded:wt(!1),readyCallbacks:wt([]),writeKey:wt(void 0),dataPlaneUrl:wt(void 0),safeAnalyticsInstance:wt(void 0)},bn={enabled:wt(!1),initialized:wt(!1),data:wt({}),activeConsentManagerPluginName:wt(void 0),preConsent:wt({enabled:!1}),postConsent:wt({}),resolutionStrategy:wt("and"),provider:wt(void 0),metadata:wt(void 0)},kn={retries:wt(0),dropped:wt(0),sent:wt(0),queued:wt(0),triggered:wt(0),metricsServiceUrl:wt(void 0)},En={app:wt({name:$e,namespace:"com.rudderlabs.javascript",version:Ze,installType:"cdn"}),traits:wt(null),library:wt({name:$e,version:Ze,snippetVersion:globalThis.RudderSnippetVersion}),userAgent:wt(null),device:wt(null),network:wt(null),os:wt({name:"",version:""}),locale:wt(null),screen:wt({density:0,width:0,height:0,innerWidth:0,innerHeight:0}),"ua-ch":wt(void 0),timezone:wt(void 0)},An={configuredDestinations:wt([]),activeDestinations:wt([]),loadOnlyIntegrations:wt({}),failedDestinations:wt([]),loadIntegration:wt(!0),initializedDestinations:wt([]),clientDestinationsReady:wt(!1),integrationsConfig:wt({})},In={toBeProcessedArray:wt([]),readyCallbacksArray:wt([])},Sn={ready:wt(!1),loadedPlugins:wt([]),failedPlugins:wt([]),pluginsToLoadFromConfig:wt([]),activePlugins:wt([]),totalPluginsToLoad:wt(0)},Tn={encryptionPluginName:wt(void 0),migrate:wt(!1),type:wt(void 0),cookie:wt(void 0),entries:wt({}),trulyAnonymousTracking:wt(!1)},wn={isEnabledServerSideCookies:wt(!1),dataServiceUrl:wt(void 0)},On={eventsQueuePluginName:wt(void 0),deliveryEnabled:wt(!0)},Pn={enabled:wt(!1),pageLifecycle:{enabled:wt(!1),pageViewId:wt(void 0),pageLoadedTimestamp:wt(void 0)}},Cn=h({},_({capabilities:gn,consents:bn,context:En,eventBuffer:In,lifecycle:mn,loadOptions:dn,metrics:kn,nativeDestinations:An,plugins:Sn,reporting:pn,session:hn,source:yn,storage:Tn,serverCookies:wn,dataPlaneEvents:On,autoTrack:Pn}));function Dn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rn,Mn={exports:{}},Nn={exports:{}};function xn(){return Rn||(Rn=1,Nn.exports=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var i=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],o=["fileName","functionName","source"],a=["args"],s=["evalOrigin"],u=i.concat(r,o,a,s);function l(e){if(e)for(var n=0;n<u.length;n++)void 0!==e[u[n]]&&this["set"+t(u[n])](e[u[n]])}l.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof l)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new l(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:i?i+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},l.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),i=e.substring(0,t),r=e.substring(t+1,n).split(","),o=e.substring(n+1);if(0===o.indexOf("@"))var a=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),s=a[1],u=a[2],c=a[3];return new l({functionName:i,args:r||void 0,fileName:s,lineNumber:u||void 0,columnNumber:c||void 0})};for(var c=0;c<i.length;c++)l.prototype["get"+t(i[c])]=n(i[c]),l.prototype["set"+t(i[c])]=function(e){return function(t){this[e]=Boolean(t)}}(i[c]);for(var d=0;d<r.length;d++)l.prototype["get"+t(r[d])]=n(r[d]),l.prototype["set"+t(r[d])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(r[d]);for(var v=0;v<o.length;v++)l.prototype["get"+t(o[v])]=n(o[v]),l.prototype["set"+t(o[v])]=function(e){return function(t){this[e]=String(t)}}(o[v]);return l}()),Nn.exports}var _n;var Ln,Bn,Un,jn,Fn=(_n||(_n=1,Mn.exports=(Ln=xn(),Bn=/(^|@)\S+:\d+/,Un=/^\s*at .*(\S+:\d+|\(native\))/m,jn=/^(eval@)?(\[native code])?$/,{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(Un))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(Un)},this).map(function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),n=t.match(/ (\(.+\)$)/);t=n?t.replace(n[0],""):t;var i=this.extractLocation(n?n[1]:t),r=n&&t||void 0,o=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new Ln({functionName:r,fileName:o,lineNumber:i[1],columnNumber:i[2],source:e})},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(jn)},this).map(function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new Ln({functionName:e});var t=/((.*".+"[^@]*)?[^@]*)(?:@)/,n=e.match(t),i=n&&n[1]?n[1]:void 0,r=this.extractLocation(e.replace(t,""));return new Ln({functionName:i,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split("\n"),i=[],r=2,o=n.length;r<o;r+=2){var a=t.exec(n[r]);a&&i.push(new Ln({fileName:a[2],lineNumber:a[1],source:n[r]}))}return i},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split("\n"),i=[],r=0,o=n.length;r<o;r+=2){var a=t.exec(n[r]);a&&i.push(new Ln({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:n[r]}))}return i},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(Bn)&&!e.match(/^Error created at/)},this).map(function(e){var t,n=e.split("@"),i=this.extractLocation(n.pop()),r=n.shift()||"",o=r.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;r.match(/\(([^)]*)\)/)&&(t=r.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var a=void 0===t||"[arguments not available]"===t?void 0:t.split(",");return new Ln({functionName:o,args:a,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:e})},this)}})),Mn.exports),Gn=Dn(Fn),Hn="global code",zn=function(e){return z(e)?e:""};function Qn(e,t,n,i){return{errorClass:zn(e),message:"".concat(n).concat(zn(t)),type:"browserjs",stacktrace:i.reduce(function(e,t){var n=function(e){var t,n={file:e.fileName,method:(t=e.functionName,q(t)&&/^global code$/i.test(t)?Hn:t),lineNumber:e.lineNumber,columnNumber:e.columnNumber};return n.lineNumber&&n.lineNumber>-1&&!n.file&&!n.method&&(n.file=Hn),n}(t);try{return"{}"===JSON.stringify(n)?e:e.concat(n)}catch(i){return e}},[])}}var Kn=function(e,t){var n,i,r;return W(e)&&z(We(e))?n=e:(t.warn((i=Se,r=Ke(e),"".concat(i).concat(Ge,"Ignoring a non-error: ").concat(r,"."))),n=void 0),n},Vn=function(e,t){try{var n=Gn.parse(e);return Qn(e.name,e.message,t,n)}catch(i){return Qn(e.name,e.message,t,[])}},qn=function(e,t){try{return JSON.parse(e||"")}catch(n){t(Je(n,"Failed to parse response data"))}},Xn="The request failed",Wn=[new RegExp("".concat(Xn,".*")),/A script with the id .* is already loaded\./],Jn=[].concat([/Failed to fetch dynamically imported module: .*/],[/Unable to load \(.*\) the script with the id .*/,/A timeout of \d+ ms occurred while trying to load the script with id .*/]),Yn={headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},method:"GET"},$n=function(e,t,n){var i=te(Yn,t||{});return n&&(i.headers=te(i.headers,{Authorization:n})),i.url=e,i},Zn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,n=arguments.length>2?arguments[2]:void 0;return new Promise(function(i,r){var o;if(!0===e.sendRawData)o=e.data;else if(o=Ke(e.data,!1,[],n),Q(o))return void r({error:new Error("Failed to prepare data for the request."),undefined:void 0,options:e});var a,s,u=new XMLHttpRequest,l=function(t){r(h({error:new Error(Wt(Xn,t,e.url)),xhr:u,options:e},"timeout"===(null==t?void 0:t.type)?{timedOut:!0}:{}))};u.ontimeout=l,u.onerror=l,u.onload=function(){var t,n,o,a,s;u.status>=200&&u.status<400?i({response:u.responseText,xhr:u,options:e}):r({error:new Error((t=Xn,n=u.status,o=u.statusText,a=e.url,s=u.responseText,"".concat(t," with status ").concat(n," (").concat(o,") for URL: ").concat(a,". Response: ").concat(s.trim()))),xhr:u,options:e})},u.open(e.method,e.url,!0),!0===e.withCredentials&&(u.withCredentials=!0),u.timeout=t,Object.keys(e.headers).forEach(function(t){e.headers[t]&&u.setRequestHeader(t,e.headers[t])});try{u.send(o)}catch(c){r({error:Je(c,(a=Xn,s=e.url,"".concat(a," for URL: ").concat(s))),xhr:u,options:e})}})},ei=function(){return s(function e(t){o(this,e),this.logger=t,this.onError=this.onError.bind(this)},[{key:"init",value:function(e){this.errorHandler=e}},{key:"getData",value:(e=i(g().m(function e(t){var n,i,r,o,a,s;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=t.url,i=t.options,r=t.timeout,o=t.isRawResponse,e.p=1,e.n=2,Zn($n(n,i,this.basicAuthHeader),r,this.logger);case 2:return a=e.v,e.a(2,{data:o?a.response:qn(a.response,this.onError),details:a});case 3:return e.p=3,s=e.v,e.a(2,{data:void 0,details:s})}},e,this,[[1,3]])})),function(t){return e.apply(this,arguments)})},{key:"getAsyncData",value:function(e){var t=this,n=e.callback,i=e.url,r=e.options,o=e.timeout,a=e.isRawResponse,s=!H(n);Zn($n(i,r,this.basicAuthHeader),o,this.logger).then(function(e){s||n(a?e.response:qn(e.response,t.onError),e)}).catch(function(e){s||n(void 0,e)})}},{key:"onError",value:function(e,t){var n;null===(n=this.errorHandler)||void 0===n||n.onError({error:e,context:"HttpClient",groupingHash:t})}},{key:"setAuthHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:ce("".concat(e,":"));this.basicAuthHeader="Basic ".concat(t)}},{key:"resetAuthHeader",value:function(){this.basicAuthHeader=void 0}}]);var e}(),ti=new ei(Ft),ni=["www.test-host.com","localhost","127.0.0.1","[::1]"],ii=["userId","userTraits","groupId","groupTraits","anonymousId","config","integration","eventBuffer","traits","authToken"],ri=function(e){Cn.capabilities.isAdBlockerDetectionInProgress.value=!0;try{var t=new URL(Cn.lifecycle.sourceConfigUrl.value),n="".concat(t.origin).concat(t.pathname,"?view=ad");e.getAsyncData({url:n,options:{method:"HEAD",headers:{"Content-Type":void 0}},isRawResponse:!0,callback:function(e,t){var i;Cn.capabilities.isAdBlockerDetectionInProgress.value=!1,Cn.capabilities.isAdBlocked.value=void 0!==(null==t?void 0:t.error)||(null==t||null===(i=t.xhr)||void 0===i?void 0:i.responseURL)!==n}})}catch(i){throw Cn.capabilities.isAdBlockerDetectionInProgress.value=!1,i}},oi=function(e,t){switch(t){case Gt.UNHANDLEDEXCEPTION:return e.error||e;case Gt.UNHANDLEDREJECTION:return e.reason;case Gt.HANDLEDEXCEPTION:default:return e}},ai=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return window.location.hostname})();return!e||e&&ni.includes(e)?"development":"production"},si=function(e){var t=Ke(e,!1,ii);return null!==t?JSON.parse(t):{}},ui=function(e,t,n,i){var r,o,a,s,u,l;return{id:"".concat(null!==(r=null===(o=e.value)||void 0===o?void 0:o.id)&&void 0!==r?r:n.writeKey.value,"..").concat(null!==(a=t.sessionInfo.value.id)&&void 0!==a?a:"NA","..").concat(null!==(s=i.pageLifecycle.pageViewId.value)&&void 0!==s?s:"NA"),name:null!==(u=null===(l=e.value)||void 0===l?void 0:l.name)&&void 0!==u?u:"NA"}},li=function(e,t){var n,i;return{locale:null!==(n=e.value)&&void 0!==n?n:"NA",userAgent:null!==(i=t.value)&&void 0!==i?i:"NA",time:new Date}},ci=function(e,t,n,i){var r=n.context,o=n.lifecycle,a=n.session,s=n.source,u=n.reporting,l=n.autoTrack,c=r.app,d=r.locale,v=r.userAgent,f=r.timezone,g=r.screen,p=r.library;return{payloadVersion:"5",notifier:{name:"RudderStack JavaScript SDK",version:c.value.version,url:"git+https://github.com/rudderlabs/rudder-sdk-js.git"},events:[{exceptions:[_(e)],severity:t.severity,unhandled:t.unhandled,severityReason:t.severityReason,app:{version:c.value.version,releaseStage:ai(),type:c.value.installType},device:li(d,v),request:{url:globalThis.location.href.split("?")[0],clientIp:"[NOT COLLECTED]"},breadcrumbs:_(u.breadcrumbs.value),context:e.message,groupingHash:i,metaData:h({app:{snippetVersion:p.value.snippetVersion},device:h(h({},g.value),{},{timezone:f.value})},si(n)),user:ui(s,a,o,l)}]}},di=function(e,t,n){var i=e.message;return new Promise(function(e){if(Jn.some(function(e){return e.test(i)})){var r,o=null===(r=/https?:\/\/[^\s"'(),;<>[\]{}]+/.exec(i))||void 0===r?void 0:r[0];z(o)?o.startsWith(tn)?t.capabilities.cspBlockedURLs.value.includes(o)?e(!1):function(e,t,n){if(K(e.capabilities.isAdBlocked.value)){!1===e.capabilities.isAdBlockerDetectionInProgress.value&&ri(t);var i=_t(function(){q(e.capabilities.isAdBlocked.value)&&(n(!1===e.capabilities.isAdBlocked.value),i())})}else n(!1===e.capabilities.isAdBlocked.value)}(t,n,e):e(!1):e(!0)}else e(!Wn.some(function(e){return e.test(i)}))})},vi=function(e){var t,n=null===(t=e.stacktrace[0])||void 0===t?void 0:t.file;if(!n||"string"!=typeof n)return!1;var i=n.substring(n.lastIndexOf("/")+1),r=n.split("/");return r[r.length-2]===$t||["rsa"].some(function(e){return i.startsWith(e)&&i.endsWith(".js")})},fi=function(e,t,n){var i={version:"1",message_id:Le(),source:{name:"js",sdk_version:t.context.app.value.version,write_key:t.lifecycle.writeKey.value,install_type:t.context.app.value.installType,category:null!=n?n:"sdk"},errors:e};return Ke(i)},hi=function(e,t,n,i){var r;if("cdn"!==n.context.app.value.installType)return r;if(q(e))if(z(e))r=e;else{var o=Kn(e,i);r=q(o)?o.message:t}else r=t;return r},gi=function(){return s(function e(t,n){o(this,e),u(this,"initialized",!1),this.httpClient=t,this.logger=n},[{key:"init",value:function(){this.initialized||(this.attachErrorListeners(),this.initialized=!0)}},{key:"attachErrorListeners",value:function(){var e=this;globalThis.addEventListener("error",function(t){e.onError({error:t,context:Se,errorType:Gt.UNHANDLEDEXCEPTION})}),globalThis.addEventListener("unhandledrejection",function(t){e.onError({error:t,context:Se,errorType:Gt.UNHANDLEDREJECTION})}),document.addEventListener("securitypolicyviolation",function(e){var t=z(e.blockedURI)?e.blockedURI:"";"enforce"===e.disposition&&t.startsWith(tn)&&!Cn.capabilities.cspBlockedURLs.value.includes(t)&&(Cn.capabilities.cspBlockedURLs.value=[].concat(k(Cn.capabilities.cspBlockedURLs.value),[t]))})}},{key:"onError",value:(e=i(g().m(function e(t){var n,i,r,o,a,s,u,l,c,d,v,f,h,p,y,m,b,k;return g().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,i=t.error,r=t.context,o=t.customMessage,a=t.groupingHash,s=t.category,u=null!==(n=t.errorType)&&void 0!==n?n:Gt.HANDLEDEXCEPTION,l=oi(i,u),c=Kn(l,this.logger),!K(c)){e.n=1;break}return e.a(2);case 1:if(d=o?"".concat(o," - "):"",v="".concat(r).concat(Ge).concat(d),f=Vn(c,v),h=We(c),(p=h.includes(Xe))||vi(f)||u===Gt.HANDLEDEXCEPTION){e.n=2;break}return e.a(2);case 2:if(!Cn.reporting.isErrorReportingEnabled.value){e.n=4;break}return e.n=3,di(f,Cn,this.httpClient);case 3:e.v&&(y={severity:"error",unhandled:u!==Gt.HANDLEDEXCEPTION,severityReason:{type:u}},m=hi(a,f.message,Cn,this.logger),b=ci(f,y,Cn,m),this.httpClient.getAsyncData({url:Cn.metrics.metricsServiceUrl.value,options:{method:"POST",data:fi(b,Cn,s),sendRawData:!0},isRawResponse:!0}));case 4:(u===Gt.HANDLEDEXCEPTION||p)&&this.logger.error(f.message),e.n=6;break;case 5:e.p=5,k=e.v,this.logger.error(Vt(Se),k);case 6:return e.a(2)}},e,this,[[0,5]])})),function(t){return e.apply(this,arguments)})},{key:"leaveBreadcrumb",value:function(e){try{Cn.reporting.breadcrumbs.value=[].concat(k(Cn.reporting.breadcrumbs.value),[(t=e,{type:"manual",name:t,timestamp:new Date,metaData:{}})])}catch(n){this.onError({error:n,context:Se,customMessage:Kt,groupingHash:Kt})}var t}}]);var e}(),pi=new gi(ti,Ft),yi=function(){return s(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),u(this,"plugins",[]),u(this,"byName",{}),u(this,"cache",{}),u(this,"config",{throws:!0}),this.config=h({throws:!0},n),this.logger=t},[{key:"register",value:function(e,t){if(e.name){if(this.byName[e.name]){var n=function(e,t){return"".concat(e).concat(Ge,'Plugin "').concat(t,'" already exists.')}(Te,e.name);if(this.config.throws)throw new Error(n);this.logger.error(n)}else{this.cache={},this.plugins=this.plugins.slice();var i=this.plugins.length;this.plugins.forEach(function(t,n){var r;null!==(r=t.deps)&&void 0!==r&&r.includes(e.name)&&(i=Math.min(i,n))}),this.plugins.splice(i,0,e),this.byName[e.name]=e,H(e.initialize)&&e.initialize(t)}}else{var r="".concat(Te).concat(Ge,"Plugin name is missing.");if(this.config.throws)throw new Error(r);this.logger.error(r,e)}}},{key:"unregister",value:function(e){var t=this.byName[e];if(t){var n=this.plugins.indexOf(t);if(-1!==n)this.cache={},delete this.byName[e],this.plugins=this.plugins.slice(),this.plugins.splice(n,1);else{var i=function(e,t){return"".concat(e).concat(Ge,'Plugin "').concat(t,'" not found in plugins but found in byName. This indicates a bug in the plugin engine. Please report this issue to the development team.')}(Te,e);if(this.config.throws)throw new Error(i);this.logger.error(i)}}else{var r=function(e,t){return"".concat(e).concat(Ge,'Plugin "').concat(t,'" not found.')}(Te,e);if(this.config.throws)throw new Error(r);this.logger.error(r)}}},{key:"getPlugin",value:function(e){return this.byName[e]}},{key:"getPlugins",value:function(e){var t=this,n=null!=e?e:".";return this.cache[n]||(this.cache[n]=this.plugins.filter(function(e){var i;if(null!==(i=e.deps)&&void 0!==i&&i.some(function(e){return!t.byName[e]})){var r=e.deps.filter(function(e){return!t.byName[e]});return t.logger.error(function(e,t,n){return"".concat(e).concat(Ge,'Plugin "').concat(t,'" could not be loaded because some of its dependencies "').concat(n,'" do not exist.')}(Te,e.name,r)),!1}return"."===n||function(e,t){return Boolean(Y(e,t))}(e,n)})),this.cache[n]}},{key:"processRawPlugins",value:function(e){e(this.plugins),this.cache={}}},{key:"invoke",value:function(e){for(var t,n=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];var s=e;if(!s)throw new Error("Failed to invoke plugin because the extension point name is missing.");var u=s.startsWith("!"),l=null!==(t=this.config.throws)&&void 0!==t?t:s.endsWith("!");if(!(s=s.replace(/(^!|!$)/g,"")))throw new Error("Failed to invoke plugin because the extension point name is invalid.");var c=s.split(".");c.pop();var d=c.join(".");return(i?this.getPlugins(s):[this.getPlugins(s)[0]]).map(function(e){var t=Y(e,s);if(!H(t)||u)return t;try{return t.apply(Y(e,d),o)}catch(i){if(l)throw i;n.logger.error(function(e,t,n){return"".concat(e).concat(Ge,'Failed to invoke the "').concat(t,'" extension point of plugin "').concat(n,'".')}(Te,s,e.name),i)}return null})}},{key:"invokeSingle",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.invoke.apply(this,[e,!1].concat(n))[0]}},{key:"invokeMultiple",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.invoke.apply(this,[e,!0].concat(n))}}])}(),mi=new yi(Ft,{throws:!0}),bi=function(e){return Boolean("cloud"!==e.config.connectionMode||!0===e.config.useNativeSDKToSend||!0===e.config.useNativeSDK)},ki=function(e){return Boolean("hybrid"===e.config.connectionMode||!0===e.config.useNativeSDKToSend)},Ei=function(e){return e.filter(bi)},Ai=["BeaconQueue","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ExternalAnonymousId","GoogleLinker","IubendaConsentManager","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],Ii=["Bugsnag","ErrorReporting"],Si="cookieStorage",Ti="localStorage",wi="sessionStorage",Oi="memoryStorage",Pi="none",Ci=function(e){return e.replace(/\/{2,}/g,"/")},Di=function(e){if(!z(e))return!1;try{return H(globalThis.URL)&&new URL(e),Zt.test(e)}catch(St){return!1}},Ri=function(e){return 429===e||!(e>=400&&e<500)},Mi=function(e,t){try{return encodeURIComponent(e)}catch(n){return void(null==t||t.error("Failed to encode the cookie data.",n))}},Ni=function(e){try{return decodeURIComponent(e)}catch(t){return}},xi=function(){var e,t,n,i=globalThis.document.cookie;return t={},(n=i.split(/\s*;\s*/))[0]?(n.forEach(function(n){var i=(e=n.split("="))[0]?Ni(e[0]):void 0;i&&(t[i]=e[1]?Ni(e[1]):void 0)}),t):t},_i=function(e,t,n,i){switch(arguments.length){case 4:case 3:case 2:return function(e,t,n,i){var r=h({},n||{}),o="".concat(Mi(e,i),"=").concat(Mi(t,i));Q(t)&&(r.maxage=-1),r.maxage&&(r.expires=new Date(+new Date+r.maxage)),r.path&&(o+="; path=".concat(r.path)),r.domain&&(o+="; domain=".concat(r.domain)),r.expires&&(o+="; expires=".concat(r.expires.toUTCString())),r.samesite&&(o+="; samesite=".concat(r.samesite)),r.secure&&(o+="; secure"),globalThis.document.cookie=o}(e,t,n,i);case 1:return e?function(e){return xi()[e]}(e):xi();default:return xi()}},Li={userId:"rl_user_id",userTraits:"rl_trait",anonymousId:"rl_anonymous_id",groupId:"rl_group_id",groupTraits:"rl_group_trait",initialReferrer:"rl_page_init_referrer",initialReferringDomain:"rl_page_init_referring_domain",sessionInfo:"rl_session",authToken:"rl_auth_token"},Bi="RS_ENC_v3_",Ui=function(e){return null!=e&&e.startsWith(Bi)?de(e.substring(10)):e},ji="client-network",Fi="integrations",Gi="QueueUtilities",Hi=function(e,t){return Ke(e,!0,void 0,t)},zi=function(e,t){return Ke(e,!0,void 0,t)},Qi=function(e,t){var n=Hi(e,t);if(n){var i=n.length;i>32768&&(null==t||t.warn(function(e,t,n){return"".concat(e).concat(Ge,"The size of the event payload (").concat(t," bytes) exceeds the maximum limit of ").concat(n," bytes. Events with large payloads may be dropped in the future. Please review your instrumentation to ensure that event payloads are within the size limit.")}(Gi,i,32768)))}else null==t||t.warn("".concat(Gi).concat(Ge,"Failed to validate event payload size. Please make sure that the event payload is within the size limit and is a valid JSON object."))},Ki=function(e,t){var n=_(e);return n.sentAt=t,n},Vi={IN_PROGRESS:"inProgress",QUEUE:"queue",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd",ACK:"ack",BATCH_QUEUE:"batchQueue"},qi=function(e,t){return"".concat(e).concat(Ge).concat(Xi(t))},Xi=function(e){return"Failed to send events batch data to the browser's beacon queue for URL ".concat(e,".")},Wi={maxItems:10,flushQueueInterval:6e5},Ji="v1",Yi="BeaconQueuePlugin",$i=function(e,t,n){var i={batch:e,sentAt:t};try{var r=Ke(i,!0);if(r)return new Blob([r],{type:"text/plain"});null==n||n.error("".concat(Yi).concat(Ge,"Failed to convert events batch object to string."))}catch(o){null==n||n.error(function(e){return"".concat(e).concat(Ge,"Failed to convert events batch object to Blob.")}(Yi),o)}},Zi=function(e){return e[e.ASAP=1]="ASAP",e[e.RESCHEDULE=2]="RESCHEDULE",e[e.ABANDON=3]="ABANDON",e}({}),er={setTimeout:function(e,t){return globalThis.setTimeout(e,t)},clearTimeout:function(e){return globalThis.clearTimeout(e)},Date:globalThis.Date,clockLateFactor:2},tr=function(){return s(function e(){o(this,e),this.tasks={},this.nextId=1,this.clock=er},[{key:"now",value:function(){return+new this.clock.Date}},{key:"run",value:function(e,t,n){this.nextId===Number.MAX_SAFE_INTEGER&&(this.nextId=1);var i=(this.nextId++).toString();return this.tasks[i]=this.clock.setTimeout(this.handle(i,e,t,n||Zi.ASAP),t),i}},{key:"handle",value:function(e,t,n,i){var r=this,o=this.now();return function(){delete r.tasks[e];var a=o+n*(r.clock.clockLateFactor||2),s=r.now();if(!(i>=Zi.RESCHEDULE&&a<s))return t();i===Zi.RESCHEDULE&&r.run(t,n,i)}}},{key:"cancel",value:function(e){this.tasks[e]&&(this.clock.clearTimeout(this.tasks[e]),delete this.tasks[e])}},{key:"cancelAll",value:function(){Object.values(this.tasks).forEach(this.clock.clearTimeout),this.tasks={}}}])}(),nr=1/0,ir=1/0,rr=524288,or="Batch",ar="Single",sr=function(e,t){return e.time-t.time},ur="RetryQueue",lr=function(){return s(function e(t,n,i,r){var a,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ti,u=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;o(this,e),this.storeManager=r,this.logger=u,this.name=t,this.id=Le(),this.processQueueCb=i,this.batchSizeCalcCb=l,this.maxItems=n.maxItems||ir,this.maxAttempts=n.maxAttempts||nr,this.batch={enabled:!1},this.configureBatchMode(n),this.backoff={minRetryDelay:n.minRetryDelay||1e3,maxRetryDelay:n.maxRetryDelay||3e4,factor:n.backoffFactor||2,jitter:n.backoffJitter||0};var c=Math.max(null!==(a=n.timerScaleFactor)&&void 0!==a?a:1,1);c=Math.min(c,10),this.timeouts={ackTimer:Math.round(1e3*c),reclaimTimer:Math.round(3e3*c),reclaimTimeout:Math.round(1e4*c),reclaimWait:Math.round(500*c)},this.schedule=new tr,this.processId="0",this.store=this.storeManager.setStore({id:this.id,name:this.name,validKeys:Vi,type:s,errorHandler:this.storeManager.errorHandler,logger:this.storeManager.logger}),this.setDefaultQueueEntries(),this.ack=this.ack.bind(this),this.checkReclaim=this.checkReclaim.bind(this),this.processHead=this.processHead.bind(this),this.flushBatch=this.flushBatch.bind(this),this.isPageAccessible=!0,this.flushBatchOnPageLeave(),this.scheduleTimeoutActive=!1},[{key:"setDefaultQueueEntries",value:function(){this.setStorageEntry(Vi.IN_PROGRESS,{}),this.setStorageEntry(Vi.QUEUE,[]),this.setStorageEntry(Vi.BATCH_QUEUE,[])}},{key:"configureBatchMode",value:function(e){if(this.batchingInProgress=!1,Z(e.batch)){var t,n,i,r=e.batch;if(this.batch.enabled=!0===r.enabled,this.batch.enabled)this.batch.maxSize=Math.min(null!==(t=r.maxSize)&&void 0!==t?t:rr,rr),this.batch.maxItems=null!==(n=r.maxItems)&&void 0!==n?n:100,this.batch.flushInterval=null!==(i=r.flushInterval)&&void 0!==i?i:6e4}}},{key:"flushBatchOnPageLeave",value:function(){this.batch.enabled&&Ue(this.flushBatch)}},{key:"getStorageEntry",value:function(e){return this.store.get(e)}},{key:"setStorageEntry",value:function(e,t){V(t)?this.store.remove(e):this.store.set(e,t)}},{key:"stop",value:function(){this.schedule.cancelAll(),this.scheduleTimeoutActive=!1}},{key:"start",value:function(){this.scheduleTimeoutActive&&this.stop(),this.scheduleTimeoutActive=!0,this.scheduleFlushBatch(),this.ack(),this.checkReclaim(),this.processHead()}},{key:"scheduleFlushBatch",value:function(){var e;this.batch.enabled&&null!==(e=this.batch)&&void 0!==e&&e.flushInterval&&(this.flushBatchTaskId&&this.schedule.cancel(this.flushBatchTaskId),this.flushBatchTaskId=this.schedule.run(this.flushBatch,this.batch.flushInterval,Zi.ASAP))}},{key:"flushBatch",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.batchingInProgress){var t;this.isPageAccessible=e,this.batchingInProgress=!0;var n=null!==(t=this.getStorageEntry(Vi.BATCH_QUEUE))&&void 0!==t?t:[];if(n.length>0){n=n.slice(-n.length);var i=this.genQueueItem(n.map(function(e){return e.item}),or);this.setStorageEntry(Vi.BATCH_QUEUE,[]),this.pushToMainQueue(i)}this.batchingInProgress=!1,this.scheduleFlushBatch()}}},{key:"shouldRetry",value:function(e,t){return t<=this.maxAttempts}},{key:"getDelay",value:function(e){var t=this.backoff.minRetryDelay*Math.pow(this.backoff.factor,e);if(this.backoff.jitter){var n=Math.random(),i=Math.floor(n*this.backoff.jitter*t);Math.floor(10*n)<5?t-=i:t+=i}return Number(Math.min(t,this.backoff.maxRetryDelay).toPrecision(1))}},{key:"enqueue",value:function(e){var t;(t=this.batch.enabled&&e.type===ar?this.handleNewItemForBatch(e):e)&&this.pushToMainQueue(t)}},{key:"handleNewItemForBatch",value:function(e){var t,n,i=null!==(t=this.getStorageEntry(Vi.BATCH_QUEUE))&&void 0!==t?t:[];if(this.batchingInProgress)i.push(e);else{this.batchingInProgress=!0,(i=i.slice(-i.length)).push(e);var r=this.getBatchDispatchInfo(i);if(r.criteriaMet||r.criteriaExceeded){var o;if(r.criteriaExceeded?(o=i.slice(0,i.length-1),i=[e]):(o=i,i=[]),o.length>0){var a=o.every(function(e){return e.reclaimed}),s=o.map(function(e){return e.item});n=a?this.genQueueItem(s,or,!0):this.genQueueItem(s,or)}this.scheduleFlushBatch()}this.batchingInProgress=!1}return this.setStorageEntry(Vi.BATCH_QUEUE,i),n}},{key:"pushToMainQueue",value:function(e){var t,n=null!==(t=this.getStorageEntry(Vi.QUEUE))&&void 0!==t?t:[];(n=this.maxItems>1?n.slice(-(this.maxItems-1)):[]).push(e),n=n.sort(sr),this.setStorageEntry(Vi.QUEUE,n),this.scheduleTimeoutActive&&this.processHead()}},{key:"addItem",value:function(e){this.enqueue(this.genQueueItem(e))}},{key:"genQueueItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ar,n=arguments.length>2?arguments[2]:void 0;return h({item:e,attemptNumber:0,time:this.schedule.now(),id:Le(),type:t},q(n)?{reclaimed:n}:{})}},{key:"requeue",value:function(e){var t=e.attemptNumber,n=e.item,i=e.type,r=e.id,o=e.firstAttemptedAt,a=e.lastAttemptedAt,s=e.reclaimed,u=e.retryReason,l=t+1;this.shouldRetry(n,l)&&this.enqueue({item:n,attemptNumber:l,time:this.schedule.now()+this.getDelay(l),id:null!=r?r:Le(),type:i,firstAttemptedAt:o,lastAttemptedAt:a,reclaimed:s,retryReason:u})}},{key:"getBatchDispatchInfo",value:function(e){var t,n,i=!1,r=!1,o=null===(t=this.batch)||void 0===t?void 0:t.maxItems;if(q(o)&&(i=e.length===o,r=e.length>o),i||r)return{criteriaMet:i,criteriaExceeded:r};var a=!1,s=!1,u=null===(n=this.batch)||void 0===n?void 0:n.maxSize;if(q(u)&&q(this.batchSizeCalcCb)){var l=this.batchSizeCalcCb(e.map(function(e){return e.item}));a=l===u,s=l>u}return{criteriaMet:a,criteriaExceeded:s}}},{key:"processHead",value:function(){var e,t,n,i=this;this.schedule.cancel(this.processId);for(var r=null!==(e=this.getStorageEntry(Vi.QUEUE))&&void 0!==e?e:[],o=this.schedule.now(),a=[],s=function(e,t){return function(n,r){var o,a,s=null!==(o=i.getStorageEntry(Vi.IN_PROGRESS))&&void 0!==o?o:{},u=s[t],l=null==u?void 0:u.firstAttemptedAt,c=null==u?void 0:u.lastAttemptedAt;(delete s[t],i.setStorageEntry(Vi.IN_PROGRESS,s),n)&&i.requeue(h(h({},e),{},{firstAttemptedAt:l,lastAttemptedAt:c,retryReason:null!==(a=null==r?void 0:r.retryReason)&&void 0!==a?a:ji}))}},u=function(e,t){a.push({id:t,item:e.item,done:s(e,t),attemptNumber:e.attemptNumber})},l=null!==(t=this.getStorageEntry(Vi.IN_PROGRESS))&&void 0!==t?t:{},c=Object.keys(l).length;r.length>0&&r[0].time<=o&&c++<this.maxItems;){var d=r.shift();if(d){var v=Le();l[v]={item:d.item,attemptNumber:d.attemptNumber,time:this.schedule.now(),type:d.type,firstAttemptedAt:d.firstAttemptedAt,lastAttemptedAt:d.lastAttemptedAt,reclaimed:d.reclaimed},u(d,v)}}if(this.setStorageEntry(Vi.QUEUE,r),this.setStorageEntry(Vi.IN_PROGRESS,l),a.forEach(function(e){try{var t,n,r,o,a,s=i.schedule.now(),u=null!==(t=i.getStorageEntry(Vi.IN_PROGRESS))&&void 0!==t?t:{},l=u[e.id],c=s,d=s,v=!1,f=ji;if(l)f=null!==(n=l.retryReason)&&void 0!==n?n:f,c=null!==(r=l.firstAttemptedAt)&&void 0!==r?r:c,d=null!==(o=l.lastAttemptedAt)&&void 0!==o?o:d,v=null!==(a=l.reclaimed)&&void 0!==a?a:v,l.firstAttemptedAt=c,l.lastAttemptedAt=s,u[e.id]=l,i.setStorageEntry(Vi.IN_PROGRESS,u);var h=s-c,g=s-d,p=i.shouldRetry(e.item,e.attemptNumber+1);i.processQueueCb(e.item,e.done,{retryAttemptNumber:e.attemptNumber,maxRetryAttempts:i.maxAttempts,willBeRetried:p,timeSinceFirstAttempt:h,timeSinceLastAttempt:g,reclaimed:v,isPageAccessible:i.isPageAccessible,retryReason:f})}catch(b){var y,m="";e.attemptNumber<i.maxAttempts?(m="The item will be requeued.",e.attemptNumber>0&&(m="".concat(m," Retry attempt ").concat(e.attemptNumber," of ").concat(i.maxAttempts,".")),e.done(b)):(m="Retries exhausted (".concat(i.maxAttempts,"). The item will be dropped."),e.done()),null===(y=i.logger)||void 0===y||y.error(function(e,t){return"".concat(e).concat(Ge,"An unknown error occurred while processing the queue item. ").concat(t)}(ur,m),b)}}),r=null!==(n=this.getStorageEntry(Vi.QUEUE))&&void 0!==n?n:[],this.schedule.cancel(this.processId),r.length>0){var f=r[0].time-o;this.processId=this.schedule.run(this.processHead,f,Zi.ASAP)}}},{key:"ack",value:function(){this.setStorageEntry(Vi.ACK,this.schedule.now()),null!=this.reclaimStartVal&&(this.reclaimStartVal=null,this.setStorageEntry(Vi.RECLAIM_START,null)),null!=this.reclaimEndVal&&(this.reclaimEndVal=null,this.setStorageEntry(Vi.RECLAIM_END,null)),this.schedule.run(this.ack,this.timeouts.ackTimer,Zi.ASAP)}},{key:"reclaim",value:function(e){var t,n,i,r,o=this,a=this.storeManager.setStore({id:e,name:this.name,validKeys:Vi,type:Ti,errorHandler:this.storeManager.errorHandler,logger:this.storeManager.logger}),s={queue:null!==(t=this.getStorageEntry(Vi.QUEUE))&&void 0!==t?t:[]},u={inProgress:null!==(n=a.get(Vi.IN_PROGRESS))&&void 0!==n?n:{},batchQueue:null!==(i=a.get(Vi.BATCH_QUEUE))&&void 0!==i?i:[],queue:null!==(r=a.get(Vi.QUEUE))&&void 0!==r?r:[]},l=[],c=function(e,t){var n=function(e){var n,i=null!==(n=e.id)&&void 0!==n?n:Le();if(l.includes(i));else{var r,a=Array.isArray(e.item)?or:ar;s.queue.push({item:e.item,attemptNumber:e.attemptNumber+t,time:o.schedule.now(),id:i,type:null!==(r=e.type)&&void 0!==r?r:a,firstAttemptedAt:e.firstAttemptedAt,lastAttemptedAt:e.lastAttemptedAt,retryReason:e.retryReason,reclaimed:!0}),l.push(i)}};Array.isArray(e)?e.forEach(n):e&&Object.values(e).forEach(n)};c(u.queue,0),this.batch.enabled?u.batchQueue.forEach(function(e){var t,n,i=null!==(t=e.id)&&void 0!==t?t:Le();l.includes(i)||(o.enqueue(h(h({},e),{},{id:i,retryReason:e.retryReason,reclaimed:!0,type:null!==(n=e.type)&&void 0!==n?n:ar,time:o.schedule.now()})),l.push(i))}):c(u.batchQueue,0),c(u.inProgress,1),s.queue.sort(sr),this.setStorageEntry(Vi.QUEUE,s.queue),this.clearQueueEntries(a,1),this.processHead()}},{key:"clearQueueEntries",value:function(e,t){this.removeStorageEntry(e,0,t)}},{key:"removeStorageEntry",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=Object.keys(Vi),a=Vi[o[t]];globalThis.setTimeout(function(){try{e.remove(a),t+1<o.length&&i.removeStorageEntry(e,t+1,n)}catch(l){var s,u="NS_ERROR_STORAGE_BUSY";if((l.name===u||l.code===u||2153971713===l.code)&&r<2)i.removeStorageEntry(e,t,n+40,r+1);else null===(s=i.logger)||void 0===s||s.error(function(e,t,n){return"".concat(e).concat(Ge,'Failed to remove local storage entry "').concat(t,'" (attempt: ').concat(n,".")}(ur,a,r),l);2===r&&t+1<o.length&&i.removeStorageEntry(e,t+1,n)}},n)}},{key:"checkReclaim",value:function(){var e=this,t=function(t){return function(){t.get(Vi.RECLAIM_START)===e.id&&(t.set(Vi.RECLAIM_END,e.id),e.schedule.run(function(t){return function(){t.get(Vi.RECLAIM_END)===e.id&&t.get(Vi.RECLAIM_START)===e.id&&e.reclaim(t.id)}}(t),e.timeouts.reclaimWait,Zi.ABANDON))}};(function(t){var n=[],i=e.store.getOriginalEngine(),r=[];if(H(i.keys))r=i.keys();else for(var o=0;o<i.length;o++){var a=i.key(o);a&&r.push(a)}return r.forEach(function(i){var r=i?i.split("."):[];r.length>=3&&r[0]===t&&r[1]!==e.id&&r[2]===Vi.ACK&&n.push(e.storeManager.setStore({id:r[1],name:t,validKeys:Vi,type:Ti,errorHandler:e.storeManager.errorHandler,logger:e.storeManager.logger}))}),n})(this.name).forEach(function(n){e.schedule.now()-n.get(Vi.ACK)<e.timeouts.reclaimTimeout||function(n){n.set(Vi.RECLAIM_START,e.id),n.set(Vi.ACK,e.schedule.now()),e.schedule.run(t(n),e.timeouts.reclaimWait,Zi.ABANDON)}(n)}),this.schedule.run(this.checkReclaim,this.timeouts.reclaimTimer,Zi.RESCHEDULE)}},{key:"clear",value:function(){this.schedule.cancelAll(),this.setDefaultQueueEntries()}}])}(),cr="BeaconQueue",dr=function(){return{name:cr,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[cr])},dataplaneEventsQueue:{init:function(e,t,n,i,r){var o,a,s=e.lifecycle.writeKey.value,u=function(e,t){var n=new URL(e);return new URL(Ci([n.pathname,"/","beacon","/",Ji,"/","batch?writeKey=".concat(t)].join("")),n).href}(e.lifecycle.activeDataplaneUrl.value,s),l=(a=null!==(o=e.loadOptions.value.beaconQueueOptions)&&void 0!==o?o:{},te(Wi,a));return new lr("".concat("rudder_beacon","_").concat(s),{batch:{enabled:!0,flushInterval:l.flushQueueInterval,maxSize:65536,maxItems:l.maxItems}},function(e,t,n){var o=n.isPageAccessible;null==r||r.debug("".concat(Yi).concat(Ge,"Sending events to data plane."));var a=Fe(),s=e.map(function(e){return Ki(e.event,a)}),l=$i(s,a,r);if(l)try{navigator.sendBeacon(u,l)?t(null):o?(null==r||r.error("".concat(qi(Yi,u)," The event(s) will be dropped.")),t(null)):null==r||r.warn("".concat(qi(Yi,u)," The event(s) will be retried as the current page is being unloaded."))}catch(c){null==i||i.onError({error:c,context:Yi,customMessage:Xi(u)}),t(null)}else t(null)},n,Ti,r,function(e){var t=Fe(),n=e.map(function(e){return e.event});return $i(n,t,r).size})},enqueue:function(e,t,n,i,r){n.sentAt=Fe(),Qi(n,r),t.addItem({event:n})}}}},vr="CustomConsentManager",fr=function(){return{name:vr,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[vr])},consentManager:{init:function(e,t){},updateConsentsInfo:function(e,t,n){},isDestinationConsented:function(e,t,n,i){if(!e.consents.initialized.value)return!0;var r=e.consents.data.value.allowedConsentIds;try{var o,a=t.consentManagement;if(!a)return!0;var s=a.find(function(t){return t.provider===e.consents.provider.value});if(null==s||!s.consents)return!0;var u=s.consents.map(function(e){return e.consent.trim()}).filter(function(e){return e}),l=null!==(o=s.resolutionStrategy)&&void 0!==o?o:e.consents.resolutionStrategy.value,c=function(e){return r.includes(e)};return"or"===l?u.some(c)||0===u.length:u.every(c)}catch(d){return null==n||n.onError({error:d,context:"CustomConsentManagerPlugin",customMessage:"Failed to determine the consent status for the destination. Please check the destination configuration and try again."}),!0}}}}},hr="DeviceModeDestinationsPlugin",gr=function(e){return'Failed to initialize integration for destination "'.concat(e,'".')},pr=function(e){return'Failed to get integrations data for destination "'.concat(e,'".')},yr=function(e){return'Failed to get the ready status from integration for destination "'.concat(e,'"')},mr=function(e,t){var n,i=null===(n=e.All)||void 0===n||n;return t.filter(function(t){var n,r,o=t.displayName;return i?(n=!0,r=e[o],K(r)||!1!==Boolean(r)||(n=!1)):(n=!1,function(e){return!K(e)&&!0===Boolean(e)}(e[o])&&(n=!0)),n})},br="ACTIVE_CAMPAIGN",kr="ADOBE_ANALYTICS",Er="ADROLL",Ar="AM",Ir="APPCUES",Sr="AXEPTIO",Tr="BINGADS",wr="BRAZE",Or="BUGSNAG",Pr="CHARTBEAT",Cr="CLEVERTAP",Dr="COMMANDBAR",Rr="CONVERTFLOW",Mr="CRITEO",Nr="CUSTOMERIO",xr="DCM_FLOODLIGHT",_r="DRIP",Lr="ENGAGE",Br="FACEBOOK_PIXEL",Ur="FULLSTORY",jr="GA",Fr="GA360",Gr="GA4",Hr="GA4_V2",zr="GAINSIGHT_PX",Qr="GOOGLE_OPTIMIZE",Kr="GOOGLEADS",Vr="GTM",qr="HEAP",Xr="HOTJAR",Wr="HS",Jr="INTERCOM",Yr="ITERABLE",$r="JUNE",Zr="KEEN",eo="KISSMETRICS",to="KLAVIYO",no="LAUNCHDARKLY",io="LEMNISK",ro="LINKEDIN_INSIGHT_TAG",oo="LIVECHAT",ao="LOTAME",so="LYTICS",uo="MATOMO",lo="MICROSOFT_CLARITY",co="MOENGAGE",vo="MOUSEFLOW",fo="MP",ho="NINETAILED",go="OLARK",po="OPTIMIZELY",yo="PENDO",mo="PINTEREST_TAG",bo="PODSIGHTS",ko="POST_AFFILIATE_PRO",Eo="POSTHOG",Ao="PROFITWELL",Io="QUALAROO",So="QUALTRICS",To="QUANTUMMETRIC",wo="QUORA_PIXEL",Oo="REDDIT_PIXEL",Po="REFINER",Co="ROCKERBOX",Do="ROLLBAR",Ro="SATISMETER",Mo="SENDINBLUE",No="SENTRY",xo="SHYNET",_o="SNAP_PIXEL",Lo="SNAPENGAGE",Bo="SPOTIFYPIXEL",Uo="SPRIG",jo="TIKTOK_ADS",Fo="TVSQUARED",Go="VERO",Ho="VWO",zo="WOOPRA",Qo="XPIXEL",Ko="YANDEX_METRICA",Vo="USERPILOT",qo="COMSCORE",Xo="Comscore";u(u(u(u(u(u({},Wr,Wr),"Hubspot",Wr),"HUBSPOT",Wr),"hub spot",Wr),"Hub Spot",Wr),"Hub spot",Wr);u(u(u(u(u({},jr,jr),"Google Analytics",jr),"GoogleAnalytics",jr),"GOOGLE ANALYTICS",jr),"google analytics",jr);u(u(u(u(u({},Xr,Xr),"Hotjar",Xr),"hotjar",Xr),"Hot Jar",Xr),"hot jar",Xr);u(u(u(u(u(u({},Kr,Kr),"Google Ads",Kr),"GoogleAds",Kr),"GOOGLE ADS",Kr),"google ads",Kr),"googleads",Kr);u(u(u(u(u(u(u(u({},Ho,Ho),"VisualWebsiteOptimizer",Ho),"Visualwebsiteoptimizer",Ho),"visualwebsiteoptimizer",Ho),"vwo",Ho),"Visual Website Optimizer",Ho),"Visual website optimizer",Ho),"visual website optimizer",Ho);u(u(u(u(u({},Vr,Vr),"Google Tag Manager",Vr),"google tag manager",Vr),"googletag manager",Vr),"googletagmanager",Vr);u(u(u({},wr,wr),"Braze",wr),"braze",wr);u(u(u({},Jr,Jr),"Intercom",Jr),"intercom",Jr);u(u(u(u(u({},Zr,Zr),"Keen",Zr),"Keen.io",Zr),"keen",Zr),"keen.io",Zr);u(u(u({},eo,eo),"Kissmetrics",eo),"kissmetrics",eo);u(u(u(u(u({},Nr,Nr),"Customerio",Nr),"Customer.io",Nr),"CUSTOMER.IO",Nr),"customer.io",Nr);u(u(u(u(u({},Pr,Pr),"Chartbeat",Pr),"chartbeat",Pr),"Chart Beat",Pr),"chart beat",Pr);u(u(u(u(u(u(u({},Br,Br),"FB Pixel",Br),"Facebook Pixel",Br),"facebook pixel",Br),"fbpixel",Br),"FBPIXEL",Br),"FB_PIXEL",Br);u(u(u({},ao,ao),"Lotame",ao),"lotame",ao);u(u(u({},po,po),"Optimizely",po),"optimizely",po);u(u(u({},Or,Or),"bugsnag",Or),"Bugsnag",Or);u(u(u(u(u(u(u(u({},Ur,Ur),"Fullstory",Ur),"FullStory",Ur),"full Story",Ur),"Full Story",Ur),"Full story",Ur),"full story",Ur),"fullstory",Ur);u(u(u(u(u(u(u(u(u({},Fo,Fo),"TVSquared",Fo),"tvsquared",Fo),"tvSquared",Fo),"TvSquared",Fo),"Tvsquared",Fo),"TV Squared",Fo),"tv squared",Fo),"tv Squared",Fo);u(u(u(u(u(u(u(u(u(u({},Gr,Gr),"Google Analytics 4",Gr),"Google analytics 4",Gr),"google analytics 4",Gr),"Google Analytics4",Gr),"Google analytics4",Gr),"google analytics4",Gr),"Google Analytics 4 (GA4)",Gr),"google analytics 4 (ga4)",Gr),"GoogleAnalytics4",Gr);u(u(u(u(u(u(u(u(u(u({},Hr,Hr),"Google Analytics 4 V2",Hr),"Google analytics 4 V2",Hr),"google analytics 4 V2",Hr),"Google Analytics4 V2",Hr),"Google analytics4 V2",Hr),"google analytics4 V2",Hr),"Google Analytics 4 (GA4) V2",Hr),"google analytics 4 (ga4) V2",Hr),"GoogleAnalytics4V2",Hr);u(u(u(u(u(u(u({},co,co),"MoEngage",co),"moengage",co),"Moengage",co),"Mo Engage",co),"mo engage",co),"Mo engage",co);u(u(u(u({},Ar,Ar),"AMPLITUDE",Ar),"Amplitude",Ar),"am",Ar);u(u(u({},yo,yo),"Pendo",yo),"pendo",yo);u(u(u({},so,so),"Lytics",so),"lytics",so);u(u(u(u({},Ir,Ir),"Appcues",Ir),"App Cues",Ir),"appcues",Ir);u(u(u(u(u(u(u({},Eo,Eo),"PostHog",Eo),"Posthog",Eo),"posthog",Eo),"Post Hog",Eo),"Post hog",Eo),"post hog",Eo);u(u(u({},to,to),"Klaviyo",to),"klaviyo",to);u(u(u({},Cr,Cr),"Clevertap",Cr),"clevertap",Cr);var Wo;u(u(u(u(u(u(u({},Tr,Tr),"BingAds",Tr),"bingads",Tr),"Bing Ads",Tr),"Bing ads",Tr),"bing Ads",Tr),"bing ads",Tr);u(u(u(u(u(u(u(u(u(u(Wo={},mo,mo),"PinterestTag",mo),"Pinterest_Tag",mo),"PINTERESTTAG",mo),"pinterest",mo),"PinterestAds",mo),"Pinterest_Ads",mo),"Pinterest",mo),"Pinterest Tag",mo),"Pinterest tag",mo),u(u(u(u(Wo,"PINTEREST TAG",mo),"pinterest tag",mo),"Pinterest Ads",mo),"Pinterest ads",mo);var Jo;u(u(u(u(u(u({"Adobe Analytics":kr,ADOBEANALYTICS:kr,"ADOBE ANALYTICS":kr},kr,kr),"AdobeAnalytics",kr),"adobeanalytics",kr),"adobe analytics",kr),"Adobe analytics",kr),"adobe Analytics",kr);u(u(u(u(u(u(u(u(u(u(Jo={},ro,ro),"LinkedIn Insight Tag",ro),"LinkedIn insight tag",ro),"linkedIn insight tag",ro),"Linkedin_insight_tag",ro),"LinkedinInsighttag",ro),"LinkedinInsightTag",ro),"LinkedInInsightTag",ro),"Linkedininsighttag",ro),"LINKEDININSIGHTTAG",ro),u(Jo,"linkedininsighttag",ro);u(u(u(u(u(u(u(u({},Oo,Oo),"Reddit_Pixel",Oo),"RedditPixel",Oo),"REDDITPIXEL",Oo),"redditpixel",Oo),"Reddit Pixel",Oo),"REDDIT PIXEL",Oo),"reddit pixel",Oo);u(u(u({},_r,_r),"Drip",_r),"drip",_r);u(u(u(u({},qr,qr),"Heap",qr),"heap",qr),"Heap.io",qr);u(u(u({},Mr,Mr),"Criteo",Mr),"criteo",Mr);u(u(u(u(u(u({},fo,fo),"MIXPANEL",fo),"Mixpanel",fo),"MIX PANEL",fo),"Mix panel",fo),"Mix Panel",fo);u(u(u({},So,So),"Qualtrics",So),"qualtrics",So);u(u(u(u(u(u(u({},Ao,Ao),"ProfitWell",Ao),"profitwell",Ao),"Profitwell",Ao),"Profit Well",Ao),"profit well",Ao),"Profit well",Ao);u(u(u({},No,No),"sentry",No),"Sentry",No);u(u(u(u(u(u(u(u({},To,To),"Quantum Metric",To),"quantum Metric",To),"quantum metric",To),"QuantumMetric",To),"quantumMetric",To),"quantummetric",To),"Quantum_Metric",To);u(u(u(u(u(u(u(u({},_o,_o),"Snap_Pixel",_o),"SnapPixel",_o),"SNAPPIXEL",_o),"snappixel",_o),"Snap Pixel",_o),"SNAP PIXEL",_o),"snap pixel",_o);u(u(u(u(u(u(u(u({},ko,ko),"PostAffiliatePro",ko),"Post_affiliate_pro",ko),"Post Affiliate Pro",ko),"Post affiliate pro",ko),"post affiliate pro",ko),"postaffiliatepro",ko),"POSTAFFILIATEPRO",ko);u(u(u(u(u(u(u(u({},Qr,Qr),"Google Optimize",Qr),"GoogleOptimize",Qr),"Googleoptimize",Qr),"GOOGLEOPTIMIZE",Qr),"google optimize",Qr),"Google optimize",Qr),"GOOGLE OPTIMIZE",Qr);u(u(u(u(u(u({},no,no),"LaunchDarkly",no),"Launch_Darkly",no),"Launch Darkly",no),"launchDarkly",no),"launch darkly",no);u(u(u(u(u(u(u(u(u({},Fr,Fr),"Google Analytics 360",Fr),"Google analytics 360",Fr),"google analytics 360",Fr),"Google Analytics360",Fr),"Google analytics360",Fr),"google analytics360",Fr),"GoogleAnalytics360",Fr),"GA 360",Fr);u(u(u(u(u({},Er,Er),"Adroll",Er),"Ad roll",Er),"ad roll",Er),"adroll",Er);u(u(u(u(u(u(u(u(u({},xr,xr),"DCM Floodlight",xr),"dcm floodlight",xr),"Dcm Floodlight",xr),"DCMFloodlight",xr),"dcmfloodlight",xr),"DcmFloodlight",xr),"dcm_floodlight",xr),"DCM_Floodlight",xr);u(u(u({},uo,uo),"Matomo",uo),"matomo",uo);u(u(u({},Go,Go),"Vero",Go),"vero",Go);u(u(u(u(u(u(u(u(u({},vo,vo),"Mouseflow",vo),"mouseflow",vo),"mouseFlow",vo),"MouseFlow",vo),"Mouse flow",vo),"mouse flow",vo),"mouse Flow",vo),"Mouse Flow",vo);u(u(u(u(u(u(u({},Co,Co),"Rockerbox",Co),"rockerbox",Co),"RockerBox",Co),"Rocker box",Co),"rocker box",Co),"Rocker Box",Co);u(u(u(u(u(u(u(u(u(u({},Rr,Rr),"Convertflow",Rr),"convertflow",Rr),"convertFlow",Rr),"ConvertFlow",Rr),"Convert flow",Rr),"convert flow",Rr),"convert Flow",Rr),"Convert Flow",Rr),"CONVERT FLOW",Rr);u(u(u(u(u(u(u({},Lo,Lo),"SnapEngage",Lo),"Snap_Engage",Lo),"snapengage",Lo),"SNAP ENGAGE",Lo),"Snap Engage",Lo),"snap engage",Lo);u(u(u(u(u(u(u({},oo,oo),"LiveChat",oo),"Live_Chat",oo),"livechat",oo),"LIVE CHAT",oo),"Live Chat",oo),"live chat",oo);u(u(u(u(u(u(u(u(u({},xo,xo),"shynet",xo),"ShyNet",xo),"shyNet",xo),"Shynet",xo),"shy net",xo),"Shy Net",xo),"shy Net",xo),"Shy net",xo);u(u(u({},zo,zo),"Woopra",zo),"woopra",zo);u(u(u(u(u(u(u(u({},Do,Do),"RollBar",Do),"Roll_Bar",Do),"rollbar",Do),"Rollbar",Do),"ROLL BAR",Do),"Roll Bar",Do),"roll bar",Do);u(u(u(u(u(u(u(u(u(u({},wo,wo),"Quora Pixel",wo),"Quora pixel",wo),"QUORA PIXEL",wo),"QuoraPixel",wo),"Quorapixel",wo),"QUORAPIXEL",wo),"Quora_Pixel",wo),"quora_pixel",wo),"Quora",wo);u(u(u({},$r,$r),"June",$r),"june",$r);u(u(u({},Lr,Lr),"Engage",Lr),"engage",Lr);u(u(u({},Yr,Yr),"Iterable",Yr),"iterable",Yr);u(u(u(u(u({},Ko,Ko),"Yandexmetrica",Ko),"yandexmetrica",Ko),"yandexMetrica",Ko),"YandexMetrica",Ko);u(u(u({},Po,Po),"Refiner",Po),"refiner",Po);u(u(u({},Io,Io),"Qualaroo",Io),"qualaroo",Io);u(u(u(u(u(u(u(u({},bo,bo),"Podsights",bo),"PodSights",bo),"pod Sights",bo),"Pod Sights",bo),"pod sights",bo),"POD SIGHTS",bo),"Pod sights",bo);u(u(u({},Sr,Sr),"Axeptio",Sr),"axeptio",Sr);u(u(u({},Ro,Ro),"Satismeter",Ro),"SatisMeter",Ro);u(u(u(u(u(u(u(u(u({},lo,lo),"Microsoft Clarity",lo),"Microsoft clarity",lo),"microsoft clarity",lo),"Microsoft_clarity",lo),"MicrosoftClarity",lo),"MICROSOFTCLARITY",lo),"microsoftclarity",lo),"microsoftClarity",lo);u(u(u(u({},Mo,Mo),"Sendinblue",Mo),"sendinblue",Mo),"SendinBlue",Mo);u(u(u({},go,go),"Olark",go),"olark",go);u(u(u(u(u(u(u(u({},io,io),"LEMNISK_MARKETING_AUTOMATION",io),"Lemnisk Marketing Automation",io),"LemniskMarketingAutomation",io),"lemniskmarketingautomation",io),"lemniskMarketingAutomation",io),"lemnisk",io),"Lemnisk",io);u(u(u(u(u(u(u({},jo,jo),"TiktokAds",jo),"Tiktok ads",jo),"Tiktok Ads",jo),"Tik Tok Ads",jo),"tik tok ads",jo),"tiktokads",jo);u(u(u(u(u(u({ActiveCampaign:br,"Active Campaign":br,"ACTIVE CAMPAIGN":br},br,br),"activecampaign",br),"active campaign",br),"Active campaign",br),"active Campaign",br),"active_campaign",br);u(u(u({},Uo,Uo),"Sprig",Uo),"sprig",Uo);u(u(u(u({},Bo,Bo),"Spotify Pixel",Bo),"spotify pixel",Bo),"SPOTIFY_PIXEL",Bo);u(u(u(u(u({},Dr,Dr),"Command Bar",Dr),"Commandbar",Dr),"COMMAND_BAR",Dr),"commandbar",Dr);u(u(u(u({},ho,ho),"Ninetailed",ho),"ninetailed",ho),"NineTailed",ho);u(u({},zr,zr),"Gainsight_PX",zr);u(u(u(u(u({},Qo,Qo),"XPixel",Qo),"Xpixel",Qo),"xpixel",Qo),"xPixel",Qo);u(u(u({},Vo,Vo),"userpilot",Vo),"Userpilot",Vo);var Yo,$o="Comscore";u({},Xo,$o),u(u(u(u({},qo,qo),"Comscore",qo),"comscore",qo),"comScore",qo);var Zo,ea,ta,na,ia,ra,oa=(u(u(u(u(u(u(u(u(u(u(Yo={},"HubSpot","HubSpot"),"Google Analytics","GA"),"Hotjar","Hotjar"),"Google Ads","GoogleAds"),"VWO","VWO"),"Google Tag Manager","GoogleTagManager"),"Braze","Braze"),"Intercom","INTERCOM"),"Keen","Keen"),"Kiss Metrics","Kissmetrics"),u(u(u(u(u(u(u(u(u(u(Yo,"Customer IO","CustomerIO"),"Chartbeat","Chartbeat"),"Facebook Pixel","FacebookPixel"),"Lotame","Lotame"),"Optimizely Web","Optimizely"),"Bugsnag","Bugsnag"),"Fullstory","Fullstory"),"TVSquared","TVSquared"),"Google Analytics 4 (GA4)","GA4"),"Google Analytics 4 (GA4) V2","GA4_V2"),u(u(u(u(u(u(u(u(u(u(Yo,"MoEngage","MoEngage"),"Amplitude","Amplitude"),"Pendo","Pendo"),"Lytics","Lytics"),"Appcues","Appcues"),"PostHog","Posthog"),"Klaviyo","Klaviyo"),"CleverTap","Clevertap"),"Bing Ads","BingAds"),"Pinterest Tag","PinterestTag"),u(u(u(u(u(u(u(u(u(u(Yo,"Adobe Analytics","AdobeAnalytics"),"Linkedin Insight Tag","LinkedInInsightTag"),"Reddit Pixel","RedditPixel"),"Drip","Drip"),"Heap.io","Heap"),"Criteo","Criteo"),"Mixpanel","Mixpanel"),"Qualtrics","Qualtrics"),"ProfitWell","ProfitWell"),"Sentry","Sentry"),u(u(u(u(u(u(u(u(u(u(Yo,"Quantum Metric","QuantumMetric"),"Snap Pixel","SnapPixel"),"Post Affiliate Pro","PostAffiliatePro"),"Google Optimize","GoogleOptimize"),"LaunchDarkly","LaunchDarkly"),"Google Analytics 360","GA360"),"Adroll","Adroll"),"DCM Floodlight","DCMFloodlight"),"Matomo","Matomo"),"Vero","Vero"),u(u(u(u(u(u(u(u(u(u(Yo,"Mouseflow","Mouseflow"),"Rockerbox","Rockerbox"),"Convertflow","ConvertFlow"),"SnapEngage","SnapEngage"),"livechat","LiveChat"),"Shynet","Shynet"),"WOOPRA","Woopra"),"rollbar","RollBar"),"Quora Pixel","QuoraPixel"),"JUNE","June"),u(u(u(u(u(u(u(u(u(u(Yo,"Engage","Engage"),"Iterable","Iterable"),"Yandex.Metrica","YandexMetrica"),"Refiner","Refiner"),"Qualaroo","Qualaroo"),"Podsights","Podsights"),"Axeptio","Axeptio"),"SatisMeter","Satismeter"),"Microsoft Clarity","MicrosoftClarity"),"Sendinblue","Sendinblue"),u(u(u(u(u(u(u(u(u(u(Yo,"Olark","Olark"),"Lemnisk Marketing Automation","Lemnisk"),"TikTok Ads","TiktokAds"),"ActiveCampaign","ActiveCampaign"),"Sprig","Sprig"),"Spotify Pixel","SpotifyPixel"),"CommandBar","CommandBar"),"Ninetailed","Ninetailed"),"Gainsight PX","Gainsight_PX"),"XPixel","XPixel"),u(u(Yo,"Userpilot","Userpilot"),Xo,$o)),aa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(n,i){var r;if(null!==(r=e.integration)&&void 0!==r&&r.isReady())n(!0);else if(t>=11e3)i(new Error("A timeout of ".concat(11e3," ms occurred")));else{var o=Date.now();(function(e){return new Promise(function(t){globalThis.setTimeout(t,e)})})(100).then(function(){var r=Date.now()-o;aa(e,t+r).then(n).catch(function(e){return i(e)})})}})},sa=function(e,t,n,i,r,o){try{var a,s,u=_(e),l=u.integration;K(l)&&(l=function(e,t,n,i){var r,o,a=h({loadIntegration:i.nativeDestinations.loadIntegration.value,logLevel:i.lifecycle.logLevel.value,loadOnlyIntegrations:null!==(r=null===(o=i.consents.postConsent.value)||void 0===o?void 0:o.integrations)&&void 0!==r?r:i.nativeDestinations.loadOnlyIntegrations.value},i.lifecycle.safeAnalyticsInstance.value);return new globalThis[e][t](_(n.config),a,{shouldApplyDeviceModeTransformation:n.shouldApplyDeviceModeTransformation,propagateEventsUntransformedOnError:n.propagateEventsUntransformedOnError,destinationId:n.id})}(n,i,e,t),u.integration=l),null===(a=(s=l).init)||void 0===a||a.call(s),aa(u).then(function(){ki(u)&&(t.nativeDestinations.integrationsConfig.value=function(e,t,n){var i,r=t;if(H(null===(i=e.integration)||void 0===i?void 0:i.getDataForIntegrationsObject))try{r=h(h({},t),qe(e.integration.getDataForIntegrationsObject()))}catch(o){null==n||n.onError({error:o,context:hr,customMessage:pr(e.userFriendlyId),groupingHash:pr(e.displayName),category:Fi})}return r}(u,t.nativeDestinations.integrationsConfig.value,r)),t.nativeDestinations.initializedDestinations.value=[].concat(k(t.nativeDestinations.initializedDestinations.value),[u])}).catch(function(n){t.nativeDestinations.failedDestinations.value=[].concat(k(t.nativeDestinations.failedDestinations.value),[e]),null==r||r.onError({error:n,context:hr,customMessage:yr(e.userFriendlyId),groupingHash:yr(e.displayName),category:Fi})})}catch(c){t.nativeDestinations.failedDestinations.value=[].concat(k(t.nativeDestinations.failedDestinations.value),[e]),null==r||r.onError({error:c,context:hr,customMessage:gr(e.userFriendlyId),groupingHash:gr(e.displayName),category:Fi})}},ua=function(e){return e.filter(function(e){return e.enabled})},la=function(e,t,n){var i=J(t.enabled)&&t.enabled!==e.enabled,r=ne(t.config),o=J(t.enabled)?t.enabled:e.enabled,a=r&&o;if(!i&&!a&&!n)return e;var s=_(e);return n&&(s.id="".concat(e.id,"_").concat(n),s.userFriendlyId="".concat(e.userFriendlyId,"_").concat(n)),i&&(s.enabled=t.enabled,s.overridden=!0),a&&(s.config=re(h(h({},s.config),t.config)),s.overridden=!0),s},ca=function(e,t,n,i){var r=n.nativeDestinations.configuredDestinations.value.find(function(t){return t.id===e&&!0===t.isCustomIntegration});if(r)if(q(r.integration))i.error(function(e,t){return"".concat(e).concat(Ge,'A custom integration with destination ID "').concat(t,'" was already added.')}(hr,e));else{if(!(V(t)||!H(t.isReady)||q(t.init)&&!H(t.init)||q(t.track)&&!H(t.track)||q(t.page)&&!H(t.page)||q(t.identify)&&!H(t.identify)||q(t.group)&&!H(t.group)||q(t.alias)&&!H(t.alias)))return r;i.error(function(e,t){return"".concat(e).concat(Ge,'The custom integration added for destination ID "').concat(t,'" does not match the expected implementation format.')}(hr,e))}else i.error(function(e,t){return"".concat(e).concat(Ge,'The destination ID "').concat(t,'" does not correspond to a custom device mode destination.')}(hr,e))},da="DeviceModeDestinations",va=function(){return{name:da,initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[da])},nativeDestinations:{addCustomIntegration:function(e,t,n,i){var r=ca(e,t,n,i);r&&(!function(e,t,n,i){var r=n.lifecycle.safeAnalyticsInstance.value,o=_(i);o.setScope(e.displayName);var a={log:o.log.bind(o),info:o.info.bind(o),debug:o.debug.bind(o),warn:o.warn.bind(o),error:o.error.bind(o),setMinLogLevel:o.setMinLogLevel.bind(o)},s=_(e.config);e.integration=h(h(h(h(h(h(h({},t.init&&{init:function(){return t.init(s,r,a)}}),t.track&&{track:function(e){return t.track(r,a,e)}}),t.page&&{page:function(e){return t.page(r,a,e)}}),t.identify&&{identify:function(e){return t.identify(r,a,e)}}),t.group&&{group:function(e){return t.group(r,a,e)}}),t.alias&&{alias:function(e){return t.alias(r,a,e)}}),{},{isReady:function(){return t.isReady(r,a)}})}(r,t,n,i),n.nativeDestinations.configuredDestinations.value=k(n.nativeDestinations.configuredDestinations.value))},setActiveDestinations:function(e,t,n,i){var r,o;e.nativeDestinations.loadIntegration.value=e.loadOptions.value.loadIntegration;var a=e.nativeDestinations.configuredDestinations.value.filter(function(e){if(e.isCustomIntegration&&K(e.integration))return e.enabled&&(null==i||i.warn((t=hr,r=e.id,"".concat(t).concat(Ge,'No valid custom integration was added for destination ID "').concat(r,'". Ignoring it.')))),!1;var t,r;if(e.isCustomIntegration||oa[e.displayName])return!0;var o,a=(o=e.displayName,'Integration for destination "'.concat(o,'" is not supported.'));return null==n||n.onError({error:new Error(a),context:hr,category:Fi}),!1}),s=e.loadOptions.value.sourceConfigurationOverride?function(e,t,n){var i;if(null==t||null===(i=t.destinations)||void 0===i||!i.length)return ua(e);var r=e.map(function(e){return e.id}),o={};t.destinations.forEach(function(e){var t=o[e.id]||[];t.push(e),o[e.id]=t});var a=Object.keys(o).filter(function(e){return!r.includes(e)});a.length>0&&(null==n||n.warn("".concat(hr,':: Source configuration override - Unable to identify the destinations with the following IDs: "').concat(a.join(", "),'"')));var s=[];return e.forEach(function(e){var t=o[e.id];if(t&&0!==t.length)if(t.length>1)t.forEach(function(t,n){var i=la(e,t,"".concat(n+1));i.cloned=!0,i.originalId=e.id,s.push(i)});else{var n=la(e,t[0]);s.push(n)}else s.push(e)}),ua(s)}(a,e.loadOptions.value.sourceConfigurationOverride,i):ua(a),u=mr(null!==(r=null===(o=e.consents.postConsent.value)||void 0===o?void 0:o.integrations)&&void 0!==r?r:e.nativeDestinations.loadOnlyIntegrations.value,s).filter(function(r){var o;return null===(o=t.invokeSingle("consentManager.isDestinationConsented",e,r.config,n,i))||void 0===o||o});e.nativeDestinations.activeDestinations.value=[].concat(k(e.nativeDestinations.activeDestinations.value),k(u))},load:function(e,t,n,i,r){var o=e.lifecycle.integrationsCDNPath.value;e.nativeDestinations.activeDestinations.value.forEach(function(i){var a=oa[i.displayName],s="".concat(a,"_RS"),u=a;if(u&&!function(e,t){var n;return Boolean((null===(n=globalThis[e])||void 0===n||null===(n=n[t])||void 0===n?void 0:n.prototype)&&void 0!==globalThis[e][t].prototype.constructor)}(s,u)){var l="".concat(o,"/").concat(a,".min.js");t.loadJSFile({url:l,id:i.userFriendlyId,callback:null!=r?r:function(t,r){if(r){var o=(a=i.displayName,'Failed to load integration SDK for destination "'.concat(a,'"'));null==n||n.onError({error:r,context:hr,customMessage:o,groupingHash:o,category:Fi}),e.nativeDestinations.failedDestinations.value=[].concat(k(e.nativeDestinations.failedDestinations.value),[i])}else sa(i,e,s,u,n);var a},timeout:1e4})}else sa(i,e,s,u,n)})}}}},fa={minRetryDelay:500,backoffFactor:2,maxAttempts:3},ha="DeviceModeTransformationPlugin",ga=function(e,t,n,i,r){return"".concat(e).concat(Ge,'Event transformation unsuccessful for destination "').concat(t,'" with id "').concat(n,'". Reason: ').concat(i,". ").concat(r,".")},pa=function(e,t,n,i,r){return"".concat(e).concat(Ge,"[Destination: ").concat(t,' with id "').concat(n,'"].Transformation request failed with status: ').concat(i,". Retries exhausted. ").concat(r,".")},ya=function(e){var t;return null!==(t=e.originalId)&&void 0!==t?t:e.id},ma=function(e,t,n){t.includes(e)||(t.push(e),n())},ba=function(e,t,n,i,r,o,a,s){var u="Sending untransformed event",l="Dropping the event",c=e.nativeDestinations.initializedDestinations.value.filter(function(e){return e&&n.includes(ya(e))}),d=[];c.forEach(function(n){try{var c=[],v=ya(n);switch(r){case 200:var f=JSON.parse(i).transformedBatch.find(function(e){return e.id===v});null==f||f.payload.forEach(function(e){if("200"===e.status)c.push(e.event);else{var t="Unknown";"410"===e.status&&(t="Transformation is not available");var i=l;!0===n.propagateEventsUntransformedOnError?(i=u,c.push(o),ma(v,d,function(){null==s||s.warn(ga(ha,n.displayName,v,t,i))})):ma(v,d,function(){null==s||s.error(ga(ha,n.displayName,v,t,i))})}});break;case 404:ma(v,d,function(){null==s||s.warn("".concat(ha).concat(Ge,"Transformation server access is denied. The configuration data seems to be out of sync. Sending untransformed event to the destination."))}),c.push(o);break;default:!0===n.propagateEventsUntransformedOnError?(ma(v,d,function(){null==s||s.warn(pa(ha,n.displayName,v,r,u))}),c.push(o)):ma(v,d,function(){null==s||s.error(pa(ha,n.displayName,v,r,l))})}null==c||c.forEach(function(i){ne(i)&&t.invokeSingle("destinationsEventsQueue.enqueueEventToDestination",e,i,n,a,s)})}catch(p){null==a||a.onError({error:p,context:ha,customMessage:(h=n.displayName,g=n.id,'Transformation failed for destination "'.concat(h,'" with id "').concat(g,'"'))})}var h,g})},ka="DeviceModeTransformation",Ea=function(){return{name:ka,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[ka])},transformEvent:{init:function(e,t,n,i,r,o){var a=e.lifecycle.writeKey.value;return n.setAuthHeader(a),new lr("".concat("rudder","_").concat(a),fa,function(i,a,s){var u,l,c=(u=i.event,l=i.destinationIds,{metadata:{"Custom-Authorization":i.token},batch:[{orderNo:Date.now(),destinationIds:l,event:u}]});n.getAsyncData({url:"".concat(e.lifecycle.activeDataplaneUrl.value,"/transform"),options:{method:"POST",data:zi(c),sendRawData:!0},isRawResponse:!0,timeout:1e4,callback:function(n,u){var l,c,d,v=Ri(null!==(l=null==u||null===(c=u.xhr)||void 0===c?void 0:c.status)&&void 0!==l?l:0);K(null==u?void 0:u.error)||!v||s.retryAttemptNumber===s.maxRetryAttempts?(ba(e,t,i.destinationIds,n,null==u||null===(d=u.xhr)||void 0===d?void 0:d.status,i.event,r,o),a(null)):a(u)}})},i,Oi)},enqueue:function(e,t,n,i){var r=[];i.forEach(function(e){var t=ya(e);r.includes(t)||r.push(t)}),t.addItem({event:n,destinationIds:r,token:e.session.authToken.value})}}}},Aa={segment:"ajs_anonymous_id"},Ia="ExternalAnonymousId",Sa=function(){return{name:Ia,initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[Ia])},storage:{getAnonymousId:function(e,t){var n,i;if(null!=t&&null!==(n=t.autoCapture)&&void 0!==n&&n.enabled&&t.autoCapture.source){var r=t.autoCapture.source.toLowerCase();if(!Object.keys(Aa).includes(r))return i;if("segment"===r)i=function(e){var t,n=e(Ti);null!=n&&n.isEnabled&&(t=n.getItem(Aa.segment));var i=e(Si);return!t&&null!=i&&i.isEnabled&&(t=i.getItem(Aa.segment)),t}(e)}return i}}}},Ta=function(){var e;return null===(e=navigator)||void 0===e?void 0:e.language},wa=function(){var e;return null===(e=navigator)||void 0===e?void 0:e.userAgent},Oa=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t.endsWith("..")?t.substring(0,t.length-2):t;return e=n,decodeURIComponent(globalThis.atob(e).split("").map(function(e){var t="00".concat(e.charCodeAt(0).toString(16));return"%".concat(t.slice(-2))}).join(""))},Pa=/^[\w.-]+$/,Ca="*",Da=function(e,t,n,i){var r=function(e,t){return[e,(new Date).getTimezoneOffset(),t].join(Ca)}(n,i),o=t||0,a=function(e){for(var t=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}(),n=-1,i=0;i<e.length;i++)n=n>>>8^t[255&(n^e.charCodeAt(i))];return(-1^n)>>>0}([r,Math.floor(Date.now()/6e4)-o,e].join(Ca));return a.toString(36)},Ra=function(e){var t=function(e){var t=e.split(Ca),n=t.length%2==0;if(t.length<4||!n)return null;if(1!==Number(t.shift()))return null;var i=t.shift();return{checksum:null!=i?i:"",serializedIds:t.join(Ca)}}(e);if(!t)return null;var n=t.checksum,i=t.serializedIds;return i&&n&&function(e,t){for(var n=wa(),i=Ta(),r=0;r<=1;r+=1)if(Da(e,r,n,i)===t)return!0;return!1}(i,n)?function(e){if(!e)return{};for(var t={},n=e.split(Ca),i=0;i<n.length;i+=2){var r=n[i];Pa.test(r)&&(t[r]=Oa(n[i+1]))}return t}(i):null},Ma="GoogleLinker",Na=function(){return{name:Ma,initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[Ma])},userSession:{anonymousIdGoogleLinker:function(e){if(!e)return null;var t=e?Ra(e):null;return t?t.rs_amp_id:null}}}},xa=function(e){return"".concat(e).concat(Ge,"Failed to read the consent cookie.")},_a="IubendaConsentManagerPlugin",La=/^_iub_cs-\d+$/,Ba=function(e,t){var n=null;try{var i=null==e?void 0:e.setStore({id:_a,name:_a,type:Si,errorHandler:null==e?void 0:e.errorHandler,logger:null==e?void 0:e.logger});n=null==i?void 0:i.engine.getItem(function(e){try{var t=document.cookie.split("; ").find(function(e){var t=m(e.split("="),1)[0];return La.test((t||"").trim())});if(!t)throw new Error("Iubenda Cookie not found with the specified pattern.");return m(t.split("="),1)[0]||""}catch(n){return null==e||e.error(xa(_a),n),""}}(t))}catch(a){return void(null==t||t.error(xa(_a),a))}if(!V(n)){var r,o;try{r=JSON.parse(decodeURIComponent(n))}catch(a){return void(null==t||t.error((o=_a,"".concat(o).concat(Ge,"Failed to parse the consent cookie.")),a))}if(r)return r.purposes}},Ua=function(e,t){var n=function(e){var t=[],n=[];return e&&Object.entries(e).forEach(function(e){var i=e[0];e[1]?t.push(i):n.push(i)}),{allowedConsentIds:t,deniedConsentIds:n}}(t);e.consents.initialized.value=q(t),e.consents.data.value=n},ja="IubendaConsentManager",Fa=function(){return{name:ja,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[ja])},consentManager:{init:function(e,t){globalThis.getIubendaUserConsentedPurposes=function(){var t;return null===(t=e.consents.data.value.allowedConsentIds)||void 0===t?void 0:t.slice()},globalThis.getIubendaUserDeniedPurposes=function(){var t;return null===(t=e.consents.data.value.deniedConsentIds)||void 0===t?void 0:t.slice()},globalThis.updateIubendaConsent=function(t){Ua(e,t)}},updateConsentsInfo:function(e,t,n){var i;i=K(globalThis._iub.cs.consent.purposes)?Ba(t,n):globalThis._iub.cs.consent.purposes,Ua(e,i)},isDestinationConsented:function(e,t,n,i){if(!e.consents.initialized.value)return!0;var r=e.consents.data.value.allowedConsentIds,o=function(e){return r.includes(e)};try{var a=t.consentManagement;if(a){var s,u=a.find(function(t){return t.provider===e.consents.provider.value});if(null==u||!u.consents)return!0;var l=u.consents.map(function(e){return e.consent.trim()}).filter(function(e){return e});return"or"===(null!==(s=u.resolutionStrategy)&&void 0!==s?s:e.consents.resolutionStrategy.value)?l.some(o)||0===l.length:l.every(o)}return!0}catch(c){return null==n||n.onError({error:c,context:_a,customMessage:"Failed to determine the consent status for the destination. Please check the destination configuration and try again."}),!0}}}}},Ga="KetchConsentManagerPlugin",Ha=function(e,t){var n,i=null;try{var r=null==e?void 0:e.setStore({id:Ga,name:Ga,type:Si,errorHandler:null==e?void 0:e.errorHandler,logger:null==e?void 0:e.logger});i=null==r?void 0:r.engine.getItem("_ketch_consent_v1_")}catch(s){return void(null==t||t.error((n=Ga,"".concat(n).concat(Ge,"Failed to read the consent cookie.")),s))}if(!V(i)){var o;try{o=JSON.parse(de(i))}catch(s){return void(null==t||t.error(function(e){return"".concat(e).concat(Ge,"Failed to parse the consent cookie.")}(Ga),s))}if(o){var a={};return Object.entries(o).forEach(function(e){var t=e[0],n=e[1];a[t]="granted"===(null==n?void 0:n.status)}),a}}},za=function(e,t){var n=function(e){var t=[],n=[];return e&&Object.entries(e).forEach(function(e){var i=e[0];e[1]?t.push(i):n.push(i)}),{allowedConsentIds:t,deniedConsentIds:n}}(t);e.consents.initialized.value=q(t),e.consents.data.value=n},Qa="KetchConsentManager",Ka=function(){return{name:Qa,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[Qa])},consentManager:{init:function(e,t){globalThis.getKetchUserConsentedPurposes=function(){var t;return null===(t=e.consents.data.value.allowedConsentIds)||void 0===t?void 0:t.slice()},globalThis.getKetchUserDeniedPurposes=function(){var t;return null===(t=e.consents.data.value.deniedConsentIds)||void 0===t?void 0:t.slice()},globalThis.updateKetchConsent=function(t){za(e,t)}},updateConsentsInfo:function(e,t,n){var i;i=K(globalThis.ketchConsent)?Ha(t,n):globalThis.ketchConsent,za(e,i)},isDestinationConsented:function(e,t,n,i){if(!e.consents.initialized.value)return!0;var r=e.consents.data.value.allowedConsentIds;try{var o=t.ketchConsentPurposes,a=t.consentManagement,s=function(e){return r.includes(e)};if(a){var u,l=null===(u=a.find(function(t){return t.provider===e.consents.provider.value}))||void 0===u?void 0:u.consents;if(!l)return!0;var c=l.map(function(e){return e.consent.trim()}).filter(function(e){return e});return"or"===e.consents.resolutionStrategy.value?c.some(s)||0===c.length:c.every(s)}if(o){var d=o.map(function(e){return e.purpose.trim()}).filter(function(e){return e});return d.some(s)||0===d.length}return!0}catch(v){return null==n||n.onError({error:v,context:Ga,customMessage:"Failed to determine the consent status for the destination. Please check the destination configuration and try again."}),!0}}}}},Va={maxItems:100},qa="NativeDestinationQueuePlugin",Xa=function(e,t,n){return'Failed to send "'.concat(e,'" event ').concat(n?'"'.concat(n,'" '):"",'to integration for destination "').concat(t,'".')},Wa=function(e){return e&&"string"==typeof e},Ja=function(e,t,n,i){var r=e.type.toString();try{var o,a,s={message:e};null===(o=(a=t.integration)[r])||void 0===o||o.call(a,s)}catch(u){null==n||n.onError({error:u,context:qa,customMessage:Xa(r,t.userFriendlyId,e.event),groupingHash:Xa(r,t.displayName,e.event),category:Fi})}},Ya="NativeDestinationQueue",$a=function(){return{name:Ya,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[Ya])},destinationsEventsQueue:{init:function(e,t,n,i,r,o){var a,s=(a=e.loadOptions.value.destinationsQueueOptions,te(Va,a)),u=e.lifecycle.writeKey.value,l=new lr("".concat("rudder_destinations_events","_").concat(u),s,function(n,a){var s=mr(n.integrations,e.nativeDestinations.initializedDestinations.value),u=[],l=_(n);s.forEach(function(e){try{var t=!function(e,t,n){if("track"!==e)return!1;var i=n.config,r=i.blacklistedEvents,o=i.whitelistedEvents;switch(i.eventFilteringOption){case"blacklistedEvents":if(!Wa(t))return!1;var a=t.trim();return!!Array.isArray(r)&&r.some(function(e){return e.eventName.trim()===a});case"whitelistedEvents":if(!Wa(t))return!0;var s=t.trim();return!Array.isArray(o)||!o.some(function(e){return e.eventName.trim()===s});default:return!1}}(l.type,l.event,e);if(!t)return void(null==o||o.warn((n=qa,i=l.event,a=e.userFriendlyId,"".concat(n).concat(Ge,'The "').concat(i,'" track event has been filtered for the "').concat(a,'" destination.'))));!function(e){return e.shouldApplyDeviceModeTransformation}(e)?Ja(l,e,r):u.push(e)}catch(St){null==r||r.onError({error:St,context:qa,category:Fi})}var n,i,a}),u.length>0&&t.invokeSingle("transformEvent.enqueue",e,i,l,u,r,o),a(null)},n,Oi);return l},enqueue:function(e,t,n,i,r){t.addItem(n)},enqueueEventToDestination:function(e,t,n,i,r){Ja(t,n,i)}}}},Za="OneTrustConsentManagerPlugin",es="OneTrustConsentManager",ts=function(){return{name:es,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[es])},consentManager:{init:function(e,t){},updateConsentsInfo:function(e,t,n){if(!globalThis.OneTrust||!globalThis.OnetrustActiveGroups)return null==n||n.error("".concat(Za).concat(Ge,"Failed to access OneTrust SDK resources. Please ensure that the OneTrust SDK is loaded successfully before RudderStack SDK.")),void(e.consents.initialized.value=!1);var i=globalThis.OneTrust.GetDomainData().Groups,r=globalThis.OnetrustActiveGroups.split(",").filter(function(e){return e}),o=[];i.forEach(function(e){var t=e.CustomGroupId;r.includes(t)||o.push(t)}),e.consents.initialized.value=!0,e.consents.data.value={allowedConsentIds:r,deniedConsentIds:o}},isDestinationConsented:function(e,t,n,i){if(!e.consents.initialized.value)return!0;var r=e.consents.data.value.allowedConsentIds;try{var o=t.oneTrustCookieCategories,a=t.consentManagement,s=function(e){return r.includes(e)};if(a){var u,l=null===(u=a.find(function(t){return t.provider===e.consents.provider.value}))||void 0===u?void 0:u.consents;if(!l)return!0;var c=l.map(function(e){return e.consent.trim()}).filter(function(e){return e});return"or"===e.consents.resolutionStrategy.value?c.some(s)||0===c.length:c.every(s)}if(o){var d=o.map(function(e){return e.oneTrustCookieCategory.trim()}).filter(function(e){return e});return d.every(s)}return!0}catch(v){return null==n||n.onError({error:v,context:Za,customMessage:"Failed to determine the consent status for the destination. Please check the destination configuration and try again."}),!0}}}}},ns="StorageEncryption",is=function(){return{name:ns,initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[ns])},storage:{encrypt:function(e){return function(e){return"".concat(Bi).concat(ce(e))}(e)},decrypt:function(e){return Ui(e)}}}},rs=(null===(Zo="undefined"!=typeof globalThis?globalThis:void 0)||void 0===Zo?void 0:Zo.crypto)||(null===(ea="undefined"!=typeof global?global:void 0)||void 0===ea?void 0:ea.crypto)||(null===(ta="undefined"!=typeof window?window:void 0)||void 0===ta?void 0:ta.crypto)||(null===(na="undefined"!=typeof self?self:void 0)||void 0===na?void 0:na.crypto)||(null===(ia="undefined"!=typeof frames?frames:void 0)||void 0===ia||null===(ia=ia[0])||void 0===ia?void 0:ia.crypto);ra=rs?function(e){for(var t=[],n=0;n<e;n+=4)t.push(rs.getRandomValues(new Uint32Array(1))[0]);return new as(t,e)}:function(e){for(var t,n=[],i=function(e){var t=e,n=987654321,i=4294967295;return function(){var e=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return e/=4294967296,(e+=.5)*(Math.random()>.5?1:-1)}},r=0;r<e;r+=4){var o=i(4294967296*(t||Math.random()));t=987654071*o(),n.push(4294967296*o()|0)}return new as(n,e)};var os=function(){return s(function e(){o(this,e)},[{key:"mixIn",value:function(e){return Object.assign(this,e)}},{key:"clone",value:function(){var e=new this.constructor;return Object.assign(e,this),e}}],[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t,n){if(v())return Reflect.construct.apply(null,arguments);var i=[null];return i.push.apply(i,t),new(e.bind.apply(e,i))}(this,t)}}])}(),as=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4*n.length;o(this,t),e=r(this,t);var a=n;if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),(a instanceof Int8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),a instanceof Uint8Array){for(var s=a.byteLength,u=[],l=0;l<s;l+=1)u[l>>>2]|=a[l]<<24-l%4*8;e.words=u,e.sigBytes=s}else e.words=n,e.sigBytes=i;return e}return d(t,e),s(t,[{key:"toString",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:ss).stringify(this)}},{key:"concat",value:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o+=1){var a=n[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=a<<24-(i+o)%4*8}else for(var s=0;s<r;s+=4)t[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this}},{key:"clamp",value:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=Math.ceil(t/4)}},{key:"clone",value:function(){var e=b(t,"clone",this,1).call(this);return e.words=this.words.slice(0),e}}])}(os);u(as,"random",ra);for(var ss={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r+=1){var o=t[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new as(n,t/2)}},us=function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r+=1){var o=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},ls=function(e){for(var t=e.length,n=[],i=0;i<t;i+=1)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new as(n,t)},cs={stringify:function(e){try{return decodeURIComponent(escape(us(e)))}catch(St){throw new Error("Malformed UTF-8 data")}},parse:function(e){return ls(unescape(encodeURIComponent(e)))}},ds=function(e){function t(){var e;return o(this,t),(e=r(this,t))._minBufferSize=0,e}return d(t,e),s(t,[{key:"reset",value:function(){this._data=new as,this._nDataBytes=0}},{key:"_append",value:function(e){var t=e;"string"==typeof t&&(t=cs.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}},{key:"_process",value:function(e){var t,n=this._data,i=this.blockSize,r=n.words,o=n.sigBytes,a=o/(4*i),s=(a=e?Math.ceil(a):Math.max((0|a)-this._minBufferSize,0))*i,u=Math.min(4*s,o);if(s){for(var l=0;l<s;l+=i)this._doProcessBlock(r,l);t=r.splice(0,s),n.sigBytes-=u}return new as(t,u)}},{key:"clone",value:function(){var e=b(t,"clone",this,1).call(this);return e._data=this._data.clone(),e}}])}(os),vs=function(e){function t(e){var n;return o(this,t),(n=r(this,t)).blockSize=16,n.cfg=Object.assign(new os,e),n.reset(),n}return d(t,e),s(t,[{key:"reset",value:function(){b(t,"reset",this,1).call(this),this._doReset()}},{key:"update",value:function(e){return this._append(e),this._process(),this}},{key:"finalize",value:function(e){return e&&this._append(e),this._doFinalize()}}],[{key:"_createHelper",value:function(e){return function(t,n){return new e(n).finalize(t)}}},{key:"_createHmacHelper",value:function(e){return function(t,n){return new fs(e,n).finalize(t)}}}])}(ds),fs=function(e){function t(e,n){var i;o(this,t),i=r(this,t);var a=new e;i._hasher=a;var s=n;"string"==typeof s&&(s=cs.parse(s));var u=a.blockSize,l=4*u;s.sigBytes>l&&(s=a.finalize(n)),s.clamp();var c=s.clone();i._oKey=c;var d=s.clone();i._iKey=d;for(var v=c.words,f=d.words,h=0;h<u;h+=1)v[h]^=1549556828,f[h]^=909522486;return c.sigBytes=l,d.sigBytes=l,i.reset(),i}return d(t,e),s(t,[{key:"reset",value:function(){var e=this._hasher;e.reset(),e.update(this._iKey)}},{key:"update",value:function(e){return this._hasher.update(e),this}},{key:"finalize",value:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}}])}(os),hs={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],o=0;o<n;o+=3)for(var a=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<n;s+=1)r.push(i.charAt(a>>>6*(3-s)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){this._reverseMap=[],i=this._reverseMap;for(var r=0;r<n.length;r+=1)i[n.charCodeAt(r)]=r}var o=n.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return function(e,t,n){for(var i=[],r=0,o=0;o<t;o+=1)if(o%4){var a=n[e.charCodeAt(o-1)]<<o%4*2|n[e.charCodeAt(o)]>>>6-o%4*2;i[r>>>2]|=a<<24-r%4*8,r+=1}return as.create(i,r)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},gs=[],ps=0;ps<64;ps+=1)gs[ps]=4294967296*Math.abs(Math.sin(ps+1))|0;var ys=function(e,t,n,i,r,o,a){var s=e+(t&n|~t&i)+r+a;return(s<<o|s>>>32-o)+t},ms=function(e,t,n,i,r,o,a){var s=e+(t&i|n&~i)+r+a;return(s<<o|s>>>32-o)+t},bs=function(e,t,n,i,r,o,a){var s=e+(t^n^i)+r+a;return(s<<o|s>>>32-o)+t},ks=function(e,t,n,i,r,o,a){var s=e+(n^(t|~i))+r+a;return(s<<o|s>>>32-o)+t},Es=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t,[{key:"_doReset",value:function(){this._hash=new as([1732584193,4023233417,2562383102,271733878])}},{key:"_doProcessBlock",value:function(e,t){for(var n=e,i=0;i<16;i+=1){var r=t+i,o=e[r];n[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var a=this._hash.words,s=n[t+0],u=n[t+1],l=n[t+2],c=n[t+3],d=n[t+4],v=n[t+5],f=n[t+6],h=n[t+7],g=n[t+8],p=n[t+9],y=n[t+10],m=n[t+11],b=n[t+12],k=n[t+13],E=n[t+14],A=n[t+15],I=a[0],S=a[1],T=a[2],w=a[3];I=ys(I,S,T,w,s,7,gs[0]),w=ys(w,I,S,T,u,12,gs[1]),T=ys(T,w,I,S,l,17,gs[2]),S=ys(S,T,w,I,c,22,gs[3]),I=ys(I,S,T,w,d,7,gs[4]),w=ys(w,I,S,T,v,12,gs[5]),T=ys(T,w,I,S,f,17,gs[6]),S=ys(S,T,w,I,h,22,gs[7]),I=ys(I,S,T,w,g,7,gs[8]),w=ys(w,I,S,T,p,12,gs[9]),T=ys(T,w,I,S,y,17,gs[10]),S=ys(S,T,w,I,m,22,gs[11]),I=ys(I,S,T,w,b,7,gs[12]),w=ys(w,I,S,T,k,12,gs[13]),T=ys(T,w,I,S,E,17,gs[14]),S=ys(S,T,w,I,A,22,gs[15]),I=ms(I,S,T,w,u,5,gs[16]),w=ms(w,I,S,T,f,9,gs[17]),T=ms(T,w,I,S,m,14,gs[18]),S=ms(S,T,w,I,s,20,gs[19]),I=ms(I,S,T,w,v,5,gs[20]),w=ms(w,I,S,T,y,9,gs[21]),T=ms(T,w,I,S,A,14,gs[22]),S=ms(S,T,w,I,d,20,gs[23]),I=ms(I,S,T,w,p,5,gs[24]),w=ms(w,I,S,T,E,9,gs[25]),T=ms(T,w,I,S,c,14,gs[26]),S=ms(S,T,w,I,g,20,gs[27]),I=ms(I,S,T,w,k,5,gs[28]),w=ms(w,I,S,T,l,9,gs[29]),T=ms(T,w,I,S,h,14,gs[30]),S=ms(S,T,w,I,b,20,gs[31]),I=bs(I,S,T,w,v,4,gs[32]),w=bs(w,I,S,T,g,11,gs[33]),T=bs(T,w,I,S,m,16,gs[34]),S=bs(S,T,w,I,E,23,gs[35]),I=bs(I,S,T,w,u,4,gs[36]),w=bs(w,I,S,T,d,11,gs[37]),T=bs(T,w,I,S,h,16,gs[38]),S=bs(S,T,w,I,y,23,gs[39]),I=bs(I,S,T,w,k,4,gs[40]),w=bs(w,I,S,T,s,11,gs[41]),T=bs(T,w,I,S,c,16,gs[42]),S=bs(S,T,w,I,f,23,gs[43]),I=bs(I,S,T,w,p,4,gs[44]),w=bs(w,I,S,T,b,11,gs[45]),T=bs(T,w,I,S,A,16,gs[46]),S=bs(S,T,w,I,l,23,gs[47]),I=ks(I,S,T,w,s,6,gs[48]),w=ks(w,I,S,T,h,10,gs[49]),T=ks(T,w,I,S,E,15,gs[50]),S=ks(S,T,w,I,v,21,gs[51]),I=ks(I,S,T,w,b,6,gs[52]),w=ks(w,I,S,T,c,10,gs[53]),T=ks(T,w,I,S,y,15,gs[54]),S=ks(S,T,w,I,u,21,gs[55]),I=ks(I,S,T,w,g,6,gs[56]),w=ks(w,I,S,T,A,10,gs[57]),T=ks(T,w,I,S,f,15,gs[58]),S=ks(S,T,w,I,k,21,gs[59]),I=ks(I,S,T,w,d,6,gs[60]),w=ks(w,I,S,T,m,10,gs[61]),T=ks(T,w,I,S,l,15,gs[62]),S=ks(S,T,w,I,p,21,gs[63]),a[0]=a[0]+I|0,a[1]=a[1]+S|0,a[2]=a[2]+T|0,a[3]=a[3]+w|0}},{key:"_doFinalize",value:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32;var r=Math.floor(n/4294967296),o=n;t[15+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t[14+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,s=a.words,u=0;u<4;u+=1){var l=s[u];s[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return a}},{key:"clone",value:function(){var e=b(t,"clone",this,1).call(this);return e._hash=this._hash.clone(),e}}])}(vs);vs._createHelper(Es),vs._createHmacHelper(Es);var As=function(e){function t(e){var n;return o(this,t),(n=r(this,t)).cfg=Object.assign(new os,{keySize:4,hasher:Es,iterations:1},e),n}return d(t,e),s(t,[{key:"compute",value:function(e,t){for(var n,i=this.cfg,r=i.hasher.create(),o=as.create(),a=o.words,s=i.keySize,u=i.iterations;a.length<s;){n&&r.update(n),n=r.update(e).finalize(t),r.reset();for(var l=1;l<u;l+=1)n=r.finalize(n),r.reset();o.concat(n)}return o.sigBytes=4*s,o}}])}(os),Is="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}:Object.assign,Ss=function(e){function t(e,n,i){var a;return o(this,t),(a=r(this,t)).cfg=Is(new os,i),a._xformMode=e,a._key=n,a.reset(),a}return d(t,e),s(t,[{key:"reset",value:function(){b(t,"reset",this,1).call(this),this._doReset()}},{key:"process",value:function(e){return this._append(e),this._process()}},{key:"finalize",value:function(e){return e&&this._append(e),this._doFinalize()}}],[{key:"createEncryptor",value:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)}},{key:"createDecryptor",value:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)}},{key:"_createHelper",value:function(e){var t=function(e){return"string"==typeof e?Ns:Rs};return{encrypt:function(n,i,r){return t(i).encrypt(e,n,i,r)},decrypt:function(n,i,r){return t(i).decrypt(e,n,i,r)}}}}])}(ds);function Ts(e,t,n){var i,r=e,o=this._iv;o?(i=o,this._iv=void 0):i=this._prevBlock;for(var a=0;a<n;a+=1)r[t+a]^=i[a]}Ss._ENC_XFORM_MODE=1,Ss._DEC_XFORM_MODE=2,Ss.keySize=4,Ss.ivSize=4;var ws=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t)}(function(e){function t(e,n){var i;return o(this,t),(i=r(this,t))._cipher=e,i._iv=n,i}return d(t,e),s(t,null,[{key:"createEncryptor",value:function(e,t){return this.Encryptor.create(e,t)}},{key:"createDecryptor",value:function(e,t){return this.Decryptor.create(e,t)}}])}(os));ws.Encryptor=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t,[{key:"processBlock",value:function(e,t){var n=this._cipher,i=n.blockSize;Ts.call(this,e,t,i),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}])}(ws),ws.Decryptor=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t,[{key:"processBlock",value:function(e,t){var n=this._cipher,i=n.blockSize,r=e.slice(t,t+i);n.decryptBlock(e,t),Ts.call(this,e,t,i),this._prevBlock=r}}])}(ws);var Os={pad:function(e,t){for(var n=4*t,i=n-e.sigBytes%n,r=i<<24|i<<16|i<<8|i,o=[],a=0;a<i;a+=4)o.push(r);var s=as.create(o,i);e.concat(s)},unpad:function(e){var t=e,n=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=n}},Ps=function(e){function t(e,n,i){var a;return o(this,t),(a=r(this,t,[e,n,Is({mode:ws,padding:Os},i)])).blockSize=4,a}return d(t,e),s(t,[{key:"reset",value:function(){var e;b(t,"reset",this,1).call(this);var n=this.cfg,i=n.iv,r=n.mode;this._xformMode===this.constructor._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode=e.call(r,this,i&&i.words),this._mode.__creator=e}},{key:"_doProcessBlock",value:function(e,t){this._mode.processBlock(e,t)}},{key:"_doFinalize",value:function(){var e,t=this.cfg.padding;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e}}])}(Ss),Cs=function(e){function t(e){var n;return o(this,t),(n=r(this,t)).mixIn(e),n}return d(t,e),s(t,[{key:"toString",value:function(e){return(e||this.formatter).stringify(this)}}])}(os),Ds={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?as.create([1398893684,1701076831]).concat(n).concat(t):t).toString(hs)},parse:function(e){var t,n=hs.parse(e),i=n.words;return 1398893684===i[0]&&1701076831===i[1]&&(t=as.create(i.slice(2,4)),i.splice(0,4),n.sigBytes-=16),Cs.create({ciphertext:n,salt:t})}},Rs=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t,null,[{key:"encrypt",value:function(e,t,n,i){var r=Is(new os,this.cfg,i),o=e.createEncryptor(n,r),a=o.finalize(t),s=o.cfg;return Cs.create({ciphertext:a,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:o.blockSize,formatter:r.format})}},{key:"decrypt",value:function(e,t,n,i){var r=t,o=Is(new os,this.cfg,i);return r=this._parse(r,o.format),e.createDecryptor(n,o).finalize(r.ciphertext)}},{key:"_parse",value:function(e,t){return"string"==typeof e?t.parse(e,this):e}}])}(os);Rs.cfg=Is(new os,{format:Ds});var Ms={execute:function(e,t,n,i,r){var o,a=i;a||(a=as.random(8)),o=r?As.create({keySize:t+n,hasher:r}).compute(e,a):As.create({keySize:t+n}).compute(e,a);var s=as.create(o.words.slice(t),4*n);return o.sigBytes=4*t,Cs.create({key:o,iv:s,salt:a})}},Ns=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t,null,[{key:"encrypt",value:function(e,t,n,i){var r=Is(new os,this.cfg,i),o=r.kdf.execute(n,e.keySize,e.ivSize,r.salt,r.hasher);r.iv=o.iv;var a=Rs.encrypt.call(this,e,t,o.key,r);return a.mixIn(o),a}},{key:"decrypt",value:function(e,t,n,i){var r=t,o=Is(new os,this.cfg,i);r=this._parse(r,o.format);var a=o.kdf.execute(n,e.keySize,e.ivSize,r.salt,o.hasher);return o.iv=a.iv,Rs.decrypt.call(this,e,r,a.key,o)}}])}(Rs);Ns.cfg=Is(Rs.cfg,{kdf:Ms});for(var xs=[],_s=[],Ls=[],Bs=[],Us=[],js=[],Fs=[],Gs=[],Hs=[],zs=[],Qs=[],Ks=0;Ks<256;Ks+=1)Qs[Ks]=Ks<128?Ks<<1:Ks<<1^283;for(var Vs=0,qs=0,Xs=0;Xs<256;Xs+=1){var Ws=qs^qs<<1^qs<<2^qs<<3^qs<<4;Ws=Ws>>>8^255&Ws^99,xs[Vs]=Ws,_s[Ws]=Vs;var Js=Qs[Vs],Ys=Qs[Js],$s=Qs[Ys],Zs=257*Qs[Ws]^16843008*Ws;Ls[Vs]=Zs<<24|Zs>>>8,Bs[Vs]=Zs<<16|Zs>>>16,Us[Vs]=Zs<<8|Zs>>>24,js[Vs]=Zs,Zs=16843009*$s^65537*Ys^257*Js^16843008*Vs,Fs[Ws]=Zs<<24|Zs>>>8,Gs[Ws]=Zs<<16|Zs>>>16,Hs[Ws]=Zs<<8|Zs>>>24,zs[Ws]=Zs,Vs?(Vs=Js^Qs[Qs[Qs[$s^Js]]],qs^=Qs[Qs[qs]]):Vs=qs=1}var eu=[0,1,2,4,8,16,32,64,128,27,54],tu=function(e){function t(){return o(this,t),r(this,t,arguments)}return d(t,e),s(t,[{key:"_doReset",value:function(){var e;if(!this._nRounds||this._keyPriorReset!==this._key){this._keyPriorReset=this._key;var t=this._keyPriorReset,n=t.words,i=t.sigBytes/4;this._nRounds=i+6;var r=4*(this._nRounds+1);this._keySchedule=[];for(var o=this._keySchedule,a=0;a<r;a+=1)a<i?o[a]=n[a]:(e=o[a-1],a%i?i>6&&a%i===4&&(e=xs[e>>>24]<<24|xs[e>>>16&255]<<16|xs[e>>>8&255]<<8|xs[255&e]):(e=xs[(e=e<<8|e>>>24)>>>24]<<24|xs[e>>>16&255]<<16|xs[e>>>8&255]<<8|xs[255&e],e^=eu[a/i|0]<<24),o[a]=o[a-i]^e);this._invKeySchedule=[];for(var s=this._invKeySchedule,u=0;u<r;u+=1){var l=r-u;e=u%4?o[l]:o[l-4],s[u]=u<4||l<=4?e:Fs[xs[e>>>24]]^Gs[xs[e>>>16&255]]^Hs[xs[e>>>8&255]]^zs[xs[255&e]]}}}},{key:"encryptBlock",value:function(e,t){this._doCryptBlock(e,t,this._keySchedule,Ls,Bs,Us,js,xs)}},{key:"decryptBlock",value:function(e,t){var n=e,i=n[t+1];n[t+1]=n[t+3],n[t+3]=i,this._doCryptBlock(n,t,this._invKeySchedule,Fs,Gs,Hs,zs,_s),i=n[t+1],n[t+1]=n[t+3],n[t+3]=i}},{key:"_doCryptBlock",value:function(e,t,n,i,r,o,a,s){for(var u=e,l=this._nRounds,c=u[t]^n[0],d=u[t+1]^n[1],v=u[t+2]^n[2],f=u[t+3]^n[3],h=4,g=1;g<l;g+=1){var p=i[c>>>24]^r[d>>>16&255]^o[v>>>8&255]^a[255&f]^n[h];h+=1;var y=i[d>>>24]^r[v>>>16&255]^o[f>>>8&255]^a[255&c]^n[h];h+=1;var m=i[v>>>24]^r[f>>>16&255]^o[c>>>8&255]^a[255&d]^n[h];h+=1;var b=i[f>>>24]^r[c>>>16&255]^o[d>>>8&255]^a[255&v]^n[h];h+=1,c=p,d=y,v=m,f=b}var k=(s[c>>>24]<<24|s[d>>>16&255]<<16|s[v>>>8&255]<<8|s[255&f])^n[h];h+=1;var E=(s[d>>>24]<<24|s[v>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[h];h+=1;var A=(s[v>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&d])^n[h];h+=1;var I=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[d>>>8&255]<<8|s[255&v])^n[h];h+=1,u[t]=k,u[t+1]=E,u[t+2]=A,u[t+3]=I}}])}(Ps);tu.keySize=8;var nu,iu=Ps._createHelper(tu),ru="RudderEncrypt:",ou="Rudder",au=function(e){return e.startsWith(ru)?iu.decrypt(e.substring(14),ou).toString(cs):e},su="StorageEncryptionLegacy",uu=function(){return{name:su,initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[su])},storage:{encrypt:function(e){return function(e){return"".concat(ru).concat(iu.encrypt(e,ou).toString())}(e)},decrypt:function(e){return au(e)}}}},lu="StorageMigrator",cu=function(){return{name:lu,initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[lu])},storage:{migrate:function(e,t,n,i){try{var r=t.getItem(e);if(V(r))return null;var o=r,a=au(o);for(a=Ui(a),o=JSON.parse(a);z(o)&&(a=au(o),(a=Ui(a))!==o);)o=JSON.parse(a);return o}catch(u){var s=function(e){return'Failed to retrieve or parse data for "'.concat(e,'" from storage.')}(e);return null==n||n.onError({error:u,context:"StorageMigratorPlugin",customMessage:s,groupingHash:s}),null}}}}},du={maxRetryDelay:36e4,minRetryDelay:1e3,backoffFactor:2,maxAttempts:10,maxItems:100},vu="v1",fu=function(e,t,n){return Ke({batch:e,sentAt:t},!0,void 0,n)},hu=function(e,t){var n=new URL(e);return new URL(Ci([n.pathname,"/",vu,"/",t].join("")),n).href},gu=function(e,t,n,i){var r,o;if(i){var a,s,u=(a="XhrQueuePlugin",s=null!==(r=null==e||null===(o=e.error)||void 0===o?void 0:o.message)&&void 0!==r?r:"Unknown","".concat(a).concat(Ge,"Failed to deliver event(s). Cause: ").concat(s,".")),l="The event(s) will be dropped.";t?n.willBeRetried?(u="".concat(u," The event(s) will be retried."),n.retryAttemptNumber>0&&(u="".concat(u," Retry attempt ").concat(n.retryAttemptNumber," of ").concat(n.maxRetryAttempts,".")),i.warn(u)):i.error("".concat(u," Retries exhausted (").concat(n.maxRetryAttempts,"). ").concat(l)):i.error("".concat(u," ").concat(l))}},pu=function(e,t,n,i){var r,o,a,s,u=Fe();if(Array.isArray(e)){var l=e.map(function(e){return Ki(e.event,u)});r=fu(l,u,i),o=e[0]?_(e[0].headers):{},s=t.lifecycle.activeDataplaneUrl.value,a=hu(s,"batch")}else{var c=e.url,d=e.event,v=e.headers,f=Ki(d,u);r=Hi(f,i),o=_(v),a=c}return o.SentAt=u,n.reclaimed&&(o["Rsa-Recovered"]="true"),n.retryAttemptNumber>0&&(o["Rsa-Retry-Attempt"]=n.retryAttemptNumber.toString(),o["Rsa-Since-Last-Attempt"]=n.timeSinceLastAttempt.toString(),o["Rsa-Since-First-Attempt"]=n.timeSinceFirstAttempt.toString(),o["Rsa-Retry-Reason"]=n.retryReason),{data:r,headers:o,url:a}},yu="XhrQueue",mu=function(){return{name:yu,deps:[],initialize:function(e){e.plugins.loadedPlugins.value=[].concat(k(e.plugins.loadedPlugins.value),[yu])},dataplaneEventsQueue:{init:function(e,t,n,i,r){var o=e.lifecycle.writeKey.value;t.setAuthHeader(o);var a,s=(a=e.loadOptions.value.queueOptions,te(du,a));return new lr("".concat("rudder","_").concat(o),s,function(n,i,o){var a=pu(n,e,o,r),s=a.data,u=a.url,l=a.headers;t.getAsyncData({url:u,options:{method:"POST",headers:l,data:s,sendRawData:!0},isRawResponse:!0,timeout:3e4,callback:function(e,t){var n,a;if(K(null==t?void 0:t.error))i(null);else{var s=Ri(null!==(n=null==t||null===(a=t.xhr)||void 0===a?void 0:a.status)&&void 0!==n?n:0);if(gu(t,s,o,r),s){var u,l=ji;null!=t&&t.timedOut?l="client-timeout":q(null==t||null===(u=t.xhr)||void 0===u?void 0:u.status)&&(l="server-".concat(t.xhr.status)),i(t,{retryReason:l})}else i(null)}}})},n,e.capabilities.storage.isLocalStorageAvailable.value?Ti:Oi,r,function(e){var t,n=Fe(),i=e.map(function(e){return e.event});return null===(t=fu(i,n,r))||void 0===t?void 0:t.length})},enqueue:function(e,t,n,i,r){n.sentAt=Fe(),Qi(n,r);var o=e.lifecycle.activeDataplaneUrl.value,a=hu(o,n.type),s={AnonymousId:ce(n.anonymousId)};t.addItem({url:a,headers:s,event:n})}}}},bu=h(h({},{}),{BeaconQueue:dr,CustomConsentManager:fr,DeviceModeDestinations:va,DeviceModeTransformation:Ea,ExternalAnonymousId:Sa,GoogleLinker:Na,IubendaConsentManager:Fa,KetchConsentManager:Ka,NativeDestinationQueue:$a,OneTrustConsentManager:ts,StorageEncryption:is,StorageEncryptionLegacy:uu,StorageMigrator:cu,XhrQueue:mu}),ku=function(){return s(function e(t,n,i){o(this,e),this.engine=t,this.errorHandler=n,this.logger=i,this.onError=this.onError.bind(this)},[{key:"init",value:function(){Cn.lifecycle.status.value="pluginsLoading",this.setActivePlugins(),this.registerLocalPlugins(),this.registerRemotePlugins(),this.attachEffects()}},{key:"attachEffects",value:function(){_t(function(){(0===Cn.plugins.activePlugins.value.length||Cn.plugins.loadedPlugins.value.length+Cn.plugins.failedPlugins.value.length===Cn.plugins.totalPluginsToLoad.value)&&yt(function(){Cn.plugins.ready.value=!0,Cn.lifecycle.status.value="pluginsReady"})})}},{key:"getPluginsToLoadBasedOnConfig",value:function(){var e=this,t=Cn.plugins.pluginsToLoadFromConfig.value;if(!t)return[];t=t.filter(function(t){return!Ii.includes(t)||(e.logger.warn(function(e,t){return"".concat(e).concat(Ge).concat(t," plugin is deprecated. Please exclude it from the load API options.")}(Ae,t)),!1)});var n=[{configurationStatus:function(){return q(Cn.dataPlaneEvents.eventsQueuePluginName.value)},configurationStatusStr:"Data plane events delivery is enabled",activePluginName:Cn.dataPlaneEvents.eventsQueuePluginName.value,supportedPlugins:Object.values(cn),shouldAddMissingPlugins:!0},{configurationStatus:function(){return Ei(Cn.nativeDestinations.configuredDestinations.value).length>0},configurationStatusStr:"Device mode destinations are connected to the source",supportedPlugins:["DeviceModeDestinations","NativeDestinationQueue"]},{configurationStatus:function(){return Ei(Cn.nativeDestinations.configuredDestinations.value).some(function(e){return e.shouldApplyDeviceModeTransformation})},configurationStatusStr:"Device mode transformations are enabled for at least one destination",supportedPlugins:["DeviceModeTransformation"]},{configurationStatus:function(){return q(Cn.consents.activeConsentManagerPluginName.value)},configurationStatusStr:"Consent management is enabled",activePluginName:Cn.consents.activeConsentManagerPluginName.value,supportedPlugins:Object.values(un)},{configurationStatus:function(){return q(Cn.storage.encryptionPluginName.value)},configurationStatusStr:"Storage encryption is enabled",activePluginName:Cn.storage.encryptionPluginName.value,supportedPlugins:Object.values(ln)},{configurationStatus:function(){return Cn.storage.migrate.value},configurationStatusStr:"Storage migration is enabled",supportedPlugins:["StorageMigrator"]}];return n.forEach(function(n){n.configurationStatus()?(t=t.filter(n.activePluginName?function(e){return!(e!==n.activePluginName&&n.supportedPlugins.includes(e))}:function(e){return q(e)}),e.addMissingPlugins(n,false,t)):t=t.filter(void 0!==n.basePlugins?function(e){return!(n.basePlugins.includes(e)||n.supportedPlugins.includes(e))}:function(e){return!n.supportedPlugins.includes(e)})}),[].concat(k(Object.keys({})),k(t))}},{key:"addMissingPlugins",value:function(e,t,n){var i=e.shouldAddMissingPlugins||t,r=(e.activePluginName?[].concat(k(e.basePlugins||[]),[e.activePluginName]):k(e.supportedPlugins)).filter(function(e){return!n.includes(e)});r.length>0&&(i&&n.push.apply(n,k(r)),this.logger.warn(function(e,t,n,i){var r=1===n.length,o=r?" '".concat(n[0],"' plugin was"):" ['".concat(n.join("', '"),"'] plugins were"),a="".concat(e).concat(Ge).concat(t,", but").concat(o," not configured to load.");return i?"".concat(a," So, ").concat(r?"the plugin":"those plugins"," will be loaded automatically."):"".concat(a," Ignore if this was intentional. Otherwise, consider adding ").concat(r?"it":"them"," to the 'plugins' load API option.")}(Ae,e.configurationStatusStr,r,i)))}},{key:"setActivePlugins",value:function(){var e,t=this.getPluginsToLoadBasedOnConfig(),n=[].concat(k(Object.keys(bu)),k(Ai)),i=[],r=[];t.forEach(function(e){n.includes(e)?i.push(e):r.push(e)}),r.length>0&&this.logger.warn((e=r,"".concat(Ae).concat(Ge,"Ignoring unknown plugins: ").concat(e.join(", "),"."))),yt(function(){Cn.plugins.totalPluginsToLoad.value=t.length,Cn.plugins.activePlugins.value=i,Cn.plugins.failedPlugins.value=r})}},{key:"registerLocalPlugins",value:function(){var e=this;Object.values(bu).forEach(function(t){H(t)&&Cn.plugins.activePlugins.value.includes(t().name)&&e.register([t()])})}},{key:"registerRemotePlugins",value:function(){var e=this,t=(Cn.plugins.activePlugins.value,h({},{}));Promise.all(Object.keys(t).map(function(){var n=i(g().m(function n(i){return g().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,t[i]().then(function(t){return e.register([t.default()])}).catch(function(t){Cn.plugins.failedPlugins.value=[].concat(k(Cn.plugins.failedPlugins.value),[i]),e.onError(t,'Failed to load plugin "'.concat(i,'"'),t)});case 1:return n.a(2)}},n)}));return function(e){return n.apply(this,arguments)}}())).catch(function(t){e.onError(t)})}},{key:"invokeMultiple",value:function(e){try{for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return(t=this.engine).invokeMultiple.apply(t,[e].concat(i))}catch(St){return this.onError(St,e),[]}}},{key:"invokeSingle",value:function(e){try{for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return(t=this.engine).invokeSingle.apply(t,[e].concat(i))}catch(St){return this.onError(St,e),null}}},{key:"register",value:function(e){var t=this;e.forEach(function(e){try{t.engine.register(e,Cn)}catch(St){Cn.plugins.failedPlugins.value=[].concat(k(Cn.plugins.failedPlugins.value),[e.name]),t.onError(St,'Failed to register plugin "'.concat(e.name,'"'))}})}},{key:"unregisterLocalPlugins",value:function(){var e=this;Object.values(bu).forEach(function(t){try{e.engine.unregister(t().name)}catch(St){e.onError(St,'Failed to unregister plugin "'.concat(t().name,'"'))}})}},{key:"onError",value:function(e,t,n){this.errorHandler.onError({error:e,context:Ae,customMessage:t,groupingHash:n})}}])}(),Eu="clientDataInCookie",Au="clientDataInLocalStorage",Iu="clientDataInSessionStorage",Su=["userId","userTraits","anonymousId","groupId","groupTraits","initialReferrer","initialReferringDomain","sessionInfo","authToken"],Tu=u(u(u(u({},Si,Eu),Ti,Au),Oi,"clientDataInMemory"),wi,Iu),wu=function(e){var t,n="function"!=typeof globalThis.URL?function(e){var t=document.createElement("a");return t.href=e,t.hostname}(e):new URL(e).hostname,i=null!==(t=null==n?void 0:n.split("."))&&void 0!==t?t:[],r=i[i.length-1],o=[];if(4===i.length&&r&&r===parseInt(r,10).toString())return o;if(i.length<=1)return i[0]&&-1!==i[0].indexOf("localhost")?["localhost"]:o;for(var a=i.length-2;a>=0;a-=1)o.push(i.slice(a).join("."));return o},Ou=function(){var e=".".concat(function(e){for(var t=wu(e),n=0;n<t.length;n+=1){var i=t[n],r="__tld__",o={domain:"".concat(-1!==i.indexOf("localhost")?"":".").concat(i)};try{if(_i(r,1,o),_i(r))return _i(r,null,o),i}catch(a){try{_i(r,null,o)}catch(s){}}}return""}(globalThis.location.href));return{maxage:31536e6,path:"/",domain:e&&"."!==e?e:void 0,samesite:"Lax",enabled:!0}},Pu=new(function(){return s(function e(t){o(this,e),u(this,"isEnabled",!0),u(this,"length",0),u(this,"data",{}),this.options={enabled:!0},this.logger=t},[{key:"configure",value:function(e){return this.options=te(this.options,null!=e?e:{}),this.isEnabled=Boolean(this.options.enabled),this.options}},{key:"setItem",value:function(e,t){return this.data[e]=t,this.length=Object.keys(this.data).length,t}},{key:"getItem",value:function(e){return e in this.data?this.data[e]:null}},{key:"removeItem",value:function(e){return e in this.data&&delete this.data[e],this.length=Object.keys(this.data).length,null}},{key:"clear",value:function(){this.data={},this.length=0}},{key:"key",value:function(e){var t;return null!==(t=this.keys()[e])&&void 0!==t?t:null}},{key:"keys",value:function(){return Object.keys(this.data)}}])}())(Ft),Cu={exports:{}};var Du=(nu||(nu=1,Cu.exports=function(){function e(e){return e=JSON.stringify(e),!!/^\{[\s\S]*\}$/.test(e)}function t(e){return void 0===e||"function"==typeof e?e+"":JSON.stringify(e)}function n(e){if("string"==typeof e)try{return JSON.parse(e)}catch(St){return e}}function i(e){return"[object Function]"==={}.toString.call(e)}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){var t="_Is_Incognit",n="yes";try{e||(e=window.localStorage),e.setItem(t,n),e.removeItem(t)}catch(St){var i={_data:{},setItem:function(e,t){return i._data[e]=String(t)},getItem:function(e){return i._data.hasOwnProperty(e)?i._data[e]:void 0},removeItem:function(e){return delete i._data[e]},clear:function(){return i._data={}}};e=i}finally{e.getItem(t)===n&&e.removeItem(t)}return e}var a=o();function s(){if(!(this instanceof s))return new s}s.prototype={set:function(n,i){if(n&&!e(n))a.setItem(n,t(i));else if(e(n))for(var r in n)this.set(r,n[r]);return this},get:function(e){if(void 0===e){var t={};return this.forEach(function(e,n){return t[e]=n}),t}if("?"===e.charAt(0))return this.has(e.substr(1));var i=arguments;if(i.length>1){for(var r={},o=0,s=i.length;o<s;o++){var u=n(a.getItem(i[o]));this.has(i[o])&&(r[i[o]]=u)}return r}return n(a.getItem(e))},clear:function(){return a.clear(),this},remove:function(e){var t=this.get(e);return a.removeItem(e),t},has:function(e){return{}.hasOwnProperty.call(this.get(),e)},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},forEach:function(e){for(var t=0,n=a.length;t<n;t++){var i=a.key(t);e(i,this.get(i))}return this},search:function(e){for(var t=this.keys(),n={},i=0,r=t.length;i<r;i++)t[i].indexOf(e)>-1&&(n[t[i]]=this.get(t[i]));return n},len:function(){return a.length}};var u=null;function l(t,n){var o=arguments,a=null;if(u||(u=s()),0===o.length)return u.get();if(1===o.length){if("string"==typeof t)return u.get(t);if(e(t))return u.set(t)}if(2===o.length&&"string"==typeof t){if(!n)return u.remove(t);if(n&&"string"==typeof n)return u.set(t,n);n&&i(n)&&(a=null,a=n(t,u.get(t)),l.set(t,a))}if(2===o.length&&r(t)&&i(n))for(var c=0,d=t.length;c<d;c++)a=n(t[c],u.get(t[c])),l.set(t[c],a);return l}for(var c in s.prototype)l[c]=s.prototype[c];return l}()),Cu.exports),Ru=Dn(Du),Mu=function(){return!V(globalThis.navigator.userAgentData)},Nu={URL:function(){return!H(globalThis.URL)||!H(globalThis.URLSearchParams)},Promise:function(){return!H(globalThis.Promise)},"Number.isNaN":function(){return!H(globalThis.Number.isNaN)},"Number.isInteger":function(){return!H(globalThis.Number.isInteger)},"Array.from":function(){return!H(globalThis.Array.from)},"Array.prototype.find":function(){return!H(globalThis.Array.prototype.find)},"Array.prototype.includes":function(){return!H(globalThis.Array.prototype.includes)},"String.prototype.endsWith":function(){return!H(globalThis.String.prototype.endsWith)},"String.prototype.startsWith":function(){return!H(globalThis.String.prototype.startsWith)},"String.prototype.includes":function(){return!H(globalThis.String.prototype.includes)},"String.prototype.replaceAll":function(){return!H(globalThis.String.prototype.replaceAll)},"String.fromCodePoint":function(){return!H(globalThis.String.fromCodePoint)},"Object.entries":function(){return!H(globalThis.Object.entries)},"Object.values":function(){return!H(globalThis.Object.values)},"Object.assign":function(){return!H(globalThis.Object.assign)},"Object.fromEntries":function(){return!H(globalThis.Object.fromEntries)},"Element.prototype.dataset":function(){return(e=globalThis.document.createElement("div")).setAttribute("data-a-b","c"),!(e.dataset&&"c"===e.dataset.aB);var e},TextEncoder:function(){return!H(globalThis.TextEncoder)||!H(globalThis.TextDecoder)},requestAnimationFrame:function(){return!H(globalThis.requestAnimationFrame)||!H(globalThis.cancelAnimationFrame)},CustomEvent:function(){return!H(globalThis.CustomEvent)},"navigator.sendBeacon":function(){return!H(globalThis.navigator.sendBeacon)},ArrayBuffer:function(){return!H(globalThis.Uint8Array)},Set:function(){return!H(globalThis.Set)},atob:function(){return!H(globalThis.atob)}},xu=function(){return{width:globalThis.screen.width,height:globalThis.screen.height,density:globalThis.devicePixelRatio,innerWidth:globalThis.innerWidth,innerHeight:globalThis.innerHeight}},_u=function(e){return e instanceof DOMException&&(["QuotaExceededError","NS_ERROR_DOM_QUOTA_REACHED"].includes(e.name)||[22,1014].includes(e.code))},Lu=function(){var e,t,n,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ti,o=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,s=(n=r,"".concat(be).concat(Ge,'The "').concat(n,'" storage type is ')),u="unavailable",l=!0;try{switch(r){case Oi:return!0;case Si:e=o,t="test_rudder_cookie";break;case Ti:e=null!=o?o:globalThis.localStorage,t="test_rudder_ls";break;case wi:e=null!=o?o:globalThis.sessionStorage,t="test_rudder_ss";break;default:return!1}if(e&&(e.setItem(t,"true"),e.getItem(t)))return e.removeItem(t),!0;l=!1}catch(c){l=!1,i=c,_u(c)&&(u="full")}return l||null==a||a.warn("".concat(s).concat(u,"."),i),!1},Bu=new(function(){return s(function e(t){o(this,e),u(this,"isSupportAvailable",!0),u(this,"isEnabled",!0),u(this,"length",0),this.options={enabled:!0},this.logger=t},[{key:"configure",value:function(e){return this.options=te(this.options,null!=e?e:{}),this.isSupportAvailable=Lu(Ti),this.isEnabled=Boolean(this.options.enabled&&this.isSupportAvailable),this.options}},{key:"setItem",value:function(e,t){Ru.set(e,t),this.length=Ru.len()}},{key:"getItem",value:function(e){var t=Ru.get(e);return K(t)?null:t}},{key:"removeItem",value:function(e){Ru.remove(e),this.length=Ru.len()}},{key:"clear",value:function(){Ru.clear(),this.length=0}},{key:"key",value:function(e){var t;return null!==(t=this.keys()[e])&&void 0!==t?t:null}},{key:"keys",value:function(){return Ru.keys()}}])}())(Ft),Uu=function(){return s(function e(t){o(this,e),u(this,"isSupportAvailable",!0),u(this,"isEnabled",!0),u(this,"length",0),this.options={enabled:!0},this.logger=t},[{key:"configure",value:function(e){return this.options=te(this.options,null!=e?e:{}),this.isSupportAvailable=Lu(wi),this.isSupportAvailable&&(this.store=globalThis.sessionStorage),this.isEnabled=Boolean(this.options.enabled&&this.isSupportAvailable),this.options}},{key:"setItem",value:function(e,t){this.store&&(this.store.setItem(e,t),this.length=this.store.length)}},{key:"getItem",value:function(e){if(!this.store)return null;var t=this.store.getItem(e);return K(t)?null:t}},{key:"removeItem",value:function(e){this.store&&(this.store.removeItem(e),this.length=this.store.length)}},{key:"clear",value:function(){var e;null===(e=this.store)||void 0===e||e.clear(),this.length=0}},{key:"key",value:function(e){var t,n;return null!==(t=null===(n=this.store)||void 0===n?void 0:n.key(e))&&void 0!==t?t:null}},{key:"keys",value:function(){var e=[];if(!this.store)return e;for(var t=0;t<this.store.length;t+=1){var n=this.store.key(t);null!==n&&e.push(n)}return e}}])}(),ju=new Uu(Ft),Fu=new(function(){return s(function e(t){o(this,e),u(this,"isSupportAvailable",!0),u(this,"isEnabled",!0),u(this,"length",0),this.logger=t},[{key:"configure",value:function(e){return this.options||(this.options=Ou()),this.options=te(this.options,null!=e?e:{}),this.options.sameDomainCookiesOnly&&delete this.options.domain,this.isSupportAvailable=Lu(Si,this),this.isEnabled=Boolean(this.options.enabled&&this.isSupportAvailable),this.options}},{key:"setItem",value:function(e,t){return _i(e,t,this.options,this.logger),this.length=Object.keys(_i()).length,!0}},{key:"getItem",value:function(e){var t=_i(e);return K(t)?null:t}},{key:"removeItem",value:function(e){var t=this.setItem(e,null);return this.length=Object.keys(_i()).length,t}},{key:"clear",value:function(){}},{key:"key",value:function(e){var t;return null!==(t=this.keys()[e])&&void 0!==t?t:null}},{key:"keys",value:function(){return Object.keys(_i())}}])}())(Ft),Gu=function(e){switch(e){case Ti:return Bu;case wi:return ju;case Oi:return Pu;case Si:return Fu;default:return Pu}},Hu=function(){var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e){var t=Fu.configure(e);Cn.storage.cookie.value={maxage:t.maxage,path:t.path,domain:t.domain,samesite:t.samesite,expires:t.expires,secure:t.secure}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),e=t,Bu.configure(e),function(e){Pu.configure(e)}(n),function(e){ju.configure(e)}(i)},zu=function(){return s(function e(t,n,i){var r,a;o(this,e),this.id=t.id,this.name=t.name,this.isEncrypted=null!==(r=t.isEncrypted)&&void 0!==r&&r,this.validKeys=null!==(a=t.validKeys)&&void 0!==a?a:{},this.engine=n,this.noKeyValidation=0===Object.keys(this.validKeys).length,this.noCompoundKey=t.noCompoundKey,this.originalEngine=this.engine,this.errorHandler=t.errorHandler,this.logger=t.logger,this.pluginsManager=i},[{key:"createValidKey",value:function(e){var t,n=this.name,i=this.id,r=this.validKeys,o=this.noKeyValidation,a=this.noCompoundKey;return o?a?e:[n,i,e].join("."):(Object.values(r).forEach(function(r){r===e&&(t=a?e:[n,i,e].join("."))}),t)}},{key:"swapQueueStoreToInMemoryEngine",value:function(){var e=this,t=this.name,n=this.id,i=this.validKeys,r=this.noCompoundKey,o=Gu(Oi);Object.keys(i).forEach(function(a){var s=e.get(i[a]),u=r?a:[t,n,a].join(".");o.setItem(u,s),e.remove(a)}),this.engine=o}},{key:"set",value:function(e,t){var n,i=this.createValidKey(e);if(i)try{this.engine.setItem(i,this.encrypt(Ke(t,!1,[],this.logger)))}catch(o){if(_u(o))this.logger.warn((n="Store ".concat(this.id),"".concat(n).concat(Ge,"The storage is either full or unavailable, so the data will not be persisted. Switching to in-memory storage."))),this.swapQueueStoreToInMemoryEngine(),this.set(e,t);else{var r=function(e){return'Failed to save the value for "'.concat(e,'" to storage')}(e);this.onError(o,r,r)}}}},{key:"get",value:function(e){var t,n=this.createValidKey(e);try{return n?(t=this.decrypt(this.engine.getItem(n)),V(t)||""===t?null:JSON.parse(t)):null}catch(r){var i=function(e){return'Failed to retrieve or parse data for "'.concat(e,'" from storage')}(e);return this.onError(r,i,i),null}}},{key:"remove",value:function(e){var t=this.createValidKey(e);t&&this.engine.removeItem(t)}},{key:"getOriginalEngine",value:function(){return this.originalEngine}},{key:"decrypt",value:function(e){return V(e)?null:this.crypto(e,"decrypt")}},{key:"encrypt",value:function(e){return this.crypto(e,"encrypt")}},{key:"crypto",value:function(e,t){var n=!this.isEncrypted||!e||"string"!=typeof e||""===function(e){return e.replace(/^\s+|\s+$/gm,"")}(e);if(n)return e;var i="storage.".concat(t),r=this.pluginsManager?this.pluginsManager.invokeSingle(i,e):e;return void 0===r?e:null!=r?r:""}},{key:"onError",value:function(e,t,n){this.errorHandler.onError({error:e,context:"Store ".concat(this.id),customMessage:t,groupingHash:n})}}])}(),Qu=function(){return s(function e(t,n,i){o(this,e),u(this,"stores",{}),u(this,"isInitialized",!1),this.errorHandler=n,this.logger=i,this.pluginsManager=t},[{key:"init",value:function(){var e,t,n;if(!this.isInitialized){var i=Cn.loadOptions.value,r={cookieStorageOptions:{samesite:i.sameSiteCookie,secure:i.secureCookie,domain:i.setCookieDomain,sameDomainCookiesOnly:i.sameDomainCookiesOnly},localStorageOptions:{},inMemoryStorageOptions:{},sessionStorageOptions:{}};Hu(ie(te(null!==(e=r.cookieStorageOptions)&&void 0!==e?e:{},null!==(t=null===(n=Cn.storage.cookie)||void 0===n?void 0:n.value)&&void 0!==t?t:{})),ie(r.localStorageOptions),ie(r.inMemoryStorageOptions),ie(r.sessionStorageOptions)),this.initClientDataStores(),this.isInitialized=!0}}},{key:"initClientDataStores",value:function(){var e=this;this.initializeStorageState(),[Oi,Ti,Si,wi].forEach(function(t){var n;null!==(n=Gu(t))&&void 0!==n&&n.isEnabled&&e.setStore({id:Tu[t],name:Tu[t],isEncrypted:!0,noCompoundKey:!0,type:t,errorHandler:e.errorHandler,logger:e.logger})})}},{key:"initializeStorageState",value:function(){var e,t=this,n=Cn.storage.type.value,i=null===(e=Cn.loadOptions.value.storage)||void 0===e?void 0:e.entries,r=Cn.consents.postConsent.value.storage;(q(null==r?void 0:r.type)||q(null==r?void 0:r.entries))&&(n=null==r?void 0:r.type,i=null==r?void 0:r.entries);var o=!0,a={};Su.forEach(function(e){var r,s,l,c=e,d=null===(r=i)||void 0===r||null===(r=r[e])||void 0===r?void 0:r.type,v=function(e,t){var n,i;if(e.consents.preConsent.value.enabled)switch(null===(i=e.consents.preConsent.value.storage)||void 0===i?void 0:i.strategy){case"none":n=Pi;break;case"session":"sessionInfo"!==t&&(n=Pi);break;case"anonymousId":"anonymousId"!==t&&(n=Pi)}return n}(Cn,e),f=null!==(s=null!==(l=null!=v?v:d)&&void 0!==l?l:n)&&void 0!==s?s:zt,g=t.getResolvedStorageTypeForEntry(f,e);g!==Pi&&(o=!1),a=h(h({},a),{},u({},e,{type:g,key:Li[c]}))}),yt(function(){Cn.storage.type.value=n,Cn.storage.entries.value=a,Cn.storage.trulyAnonymousTracking.value=o})}},{key:"getResolvedStorageTypeForEntry",value:function(e,t){var n,i,r,o,a,s=e;switch(e){case Ti:null!==(n=Gu(Ti))&&void 0!==n&&n.isEnabled||(s=Oi);break;case wi:null!==(i=Gu(wi))&&void 0!==i&&i.isEnabled||(s=Oi);break;case Oi:case Pi:break;default:s=null!==(r=Gu(Si))&&void 0!==r&&r.isEnabled?Si:null!==(o=Gu(Ti))&&void 0!==o&&o.isEnabled?Ti:null!==(a=Gu(wi))&&void 0!==a&&a.isEnabled?wi:Oi}return s!==e&&this.logger.warn(function(e,t,n,i){return"".concat(e).concat(Ge,'The storage type "').concat(n,'" is not available for entry "').concat(t,'". The SDK will initialize the entry with "').concat(i,'" storage type instead.')}("StoreManager",t,e,s)),s}},{key:"setStore",value:function(e){var t=Gu(e.type);return this.stores[e.id]=new zu(e,t,this.pluginsManager),this.stores[e.id]}},{key:"getStore",value:function(e){return this.stores[e]}}])}(),Ku=function(e){var t=new URL(e),n=t.host,i=t.protocol,r=n.split(".");return{topDomain:r.length>2?"".concat(r[r.length-2],".").concat(r[r.length-1]):n,protocol:i}},Vu=function(e,t){var n=t?window.location.origin:function(e){var t=Ku(e),n=t.topDomain,i=t.protocol;return"".concat(i,"//").concat(n)}(window.location.href),i=e.startsWith("/")?e.substring(1):e;return"".concat(n,"/").concat(i)},qu=function(e){return null!=e&&e.endsWith("/")?qu(e.substring(0,e.length-1)):e},Xu=function(e){try{return new URL(e).host}catch(t){return null}},Wu=function(e){var t;return null!==(t=Xu(e))&&void 0!==t?t:""},Ju=function(e){var t={};try{var n=new URL(e),i="utm_";n.searchParams.forEach(function(e,n){if(n.startsWith(i)){var r=n.substring(4);"campaign"===r&&(r="name"),t[r]=e}})}catch(r){}return t},Yu="none",$u="immediate",Zu=function(e){return ne(e)||Array.isArray(e)},el=function(e,t){var n,i,r=e.provider,o=r?un[r]:void 0;return r&&!o&&(t.error((n=r,i=un,"".concat(ke).concat(Ge,'The consent manager "').concat(n,'" is not supported. Please choose one of the following supported consent managers: "').concat(Object.keys(i),'".'))),r=void 0),{provider:r,consentManagerPluginName:o}},tl=function(e,t){var n,i,r=[],o=[],a=!1,s=!0===(null==e?void 0:e.enabled);if(ne(e)&&s){var u=el(e,t);i=u.provider,n=u.consentManagerPluginName,Zu(e.allowedConsentIds)&&(r=e.allowedConsentIds,a=!0),Zu(e.deniedConsentIds)&&(o=e.deniedConsentIds,a=!0)}var l={allowedConsentIds:r,deniedConsentIds:o};return{provider:i,consentManagerPluginName:n,initialized:a,enabled:s=s&&Boolean(n),consentsData:l}},nl=function(){var e=document.querySelector("script[data-rsa-write-key]");if(e&&e.dataset.rsaWriteKey===Cn.lifecycle.writeKey.value)return e.src;var t,n=/(?:^|\/)rsa(\.min)?\.js$/,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=I(e))||t){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(document.getElementsByTagName("script"));try{for(i.s();!(t=i.n()).done;){var r=t.value.getAttribute("src");if(r&&n.test(r))return r}}catch(o){i.e(o)}finally{i.f()}},il=function(e){var t,n,i;Cn.reporting.isErrorReportingEnabled.value=!(n=e.source.config,!0!==(null==n||null===(i=n.statsCollection)||void 0===i||null===(i=i.errors)||void 0===i?void 0:i.enabled)||null!==(t=window.chrome)&&void 0!==t&&null!==(t=t.runtime)&&void 0!==t&&t.id),Cn.reporting.isMetricsReportingEnabled.value=function(e){var t;return!0===(null==e||null===(t=e.statsCollection)||void 0===t||null===(t=t.metrics)||void 0===t?void 0:t.enabled)}(e.source.config)},rl=function(e){var t,n,i=Cn.loadOptions.value,r=i.useServerSideCookies,o=i.dataServiceEndpoint,a=i.storage,s=i.setCookieDomain,u=i.sameDomainCookiesOnly,l=null==a?void 0:a.cookie,c=!1;if(r){var d;c=r;var v=null!==(d=l.domain)&&void 0!==d?d:s,f=q(v)&&(n=ue(v),!(Ku(window.location.href).topDomain===n))||u,g=Vu(null!=o?o:"rsaRequest",f);if(Di(g)){t=qu(g);var p=Xu(window.location.href),y=Xu(g);p!==y&&(l=h(h({},l),{},{samesite:"None",secure:!0})),!u&&f&&y!==ue(v)&&(c=!1,e.warn(function(e,t,n){return"".concat(e).concat(Ge,"The provided cookie domain (").concat(t,") does not match the current webpage's domain (").concat(n,"). Hence, the cookies will be set client-side.")}(ke,v,y)))}else c=!1}return{sscEnabled:c,cookieOptions:l,finalDataServiceUrl:t}},ol=function(e){var t,n=Cn.loadOptions.value.storage,i=null==n?void 0:n.type;q(i)&&!function(e){return"string"==typeof e&&Ht.includes(e)}(i)&&(e.warn(function(e,t,n){return"".concat(e).concat(Ge,'The storage type "').concat(t,'" is not supported. Please choose one of the following supported types: "').concat(Ht,'". The default type "').concat(n,'" will be used instead.')}(ke,i,zt)),i=zt);var r,o,a,s=null==n||null===(t=n.encryption)||void 0===t?void 0:t.version,u=s&&ln[s];!K(s)&&K(u)?(e.warn((r=s,o=ln,a=sn,"".concat(ke).concat(Ge,'The storage encryption version "').concat(r,'" is not supported. Please choose one of the following supported versions: "').concat(Object.keys(o),'". The default version "').concat(a,'" will be used instead.'))),s=sn):K(s)&&(s=sn);var l=null==n?void 0:n.migrate,c=l&&s===sn;!0===l&&c!==l&&e.warn(function(e,t,n){return"".concat(e).concat(Ge,"The storage data migration has been disabled because the configured storage encryption version (").concat(t,") is not the latest (").concat(n,"). To enable storage data migration, please update the storage encryption version to the latest version.")}(ke,s,sn));var d=rl(e),v=d.sscEnabled,f=d.finalDataServiceUrl,h=d.cookieOptions;yt(function(){Cn.storage.type.value=i,Cn.storage.cookie.value=h,Cn.serverCookies.isEnabledServerSideCookies.value=v,Cn.serverCookies.dataServiceUrl.value=f,Cn.storage.encryptionPluginName.value=ln[s],Cn.storage.migrate.value=c})},al=function(e){var t,n,i,r,o,a,s,u,l=tl(Cn.loadOptions.value.consentManagement,e),c=l.provider,d=l.consentManagerPluginName,v=l.initialized,f=l.enabled,h=l.consentsData,g=Cn.loadOptions.value.preConsent,p=null!==(t=null==g||null===(n=g.storage)||void 0===n?void 0:n.strategy)&&void 0!==t?t:Yu;q(p)&&!["none","session","anonymousId"].includes(p)&&(p=Yu,e.warn((a=ke,s=null==g||null===(o=g.storage)||void 0===o?void 0:o.strategy,u=Yu,"".concat(a).concat(Ge,'The pre-consent storage strategy "').concat(s,'" is not supported. Please choose one of the following supported strategies: "none, session, anonymousId". The default strategy "').concat(u,'" will be used instead.'))));var y,m=null!==(i=null==g||null===(r=g.events)||void 0===r?void 0:r.delivery)&&void 0!==i?i:$u;q(m)&&!["immediate","buffer"].includes(m)&&(m=$u,e.warn(function(e,t,n){return"".concat(e).concat(Ge,'The pre-consent events delivery type "').concat(t,'" is not supported. Please choose one of the following supported types: "immediate, buffer". The default type "').concat(n,'" will be used instead.')}(ke,null==g||null===(y=g.events)||void 0===y?void 0:y.delivery,$u)));yt(function(){var e;Cn.consents.activeConsentManagerPluginName.value=d,Cn.consents.initialized.value=v,Cn.consents.enabled.value=f,Cn.consents.data.value=h,Cn.consents.provider.value=c,Cn.consents.preConsent.value={enabled:!0===(null===(e=Cn.loadOptions.value.preConsent)||void 0===e?void 0:e.enabled)&&!1===v&&!0===f,storage:{strategy:p},events:{delivery:m}}})},sl=function(e){if(Cn.dataPlaneEvents.deliveryEnabled.value){var t="XhrQueue",n=t;Cn.loadOptions.value.useBeacon&&(Cn.capabilities.isBeaconAvailable.value?n="BeaconQueue":(n=t,e.warn("".concat(ke).concat(Ge,"The Beacon API is not supported by your browser. The events will be sent using XHR instead.")))),yt(function(){Cn.dataPlaneEvents.eventsQueuePluginName.value=n})}},ul=function(e,t,n,i,r){var o=new URLSearchParams({p:"cdn",v:Ze,build:en,writeKey:t,lockIntegrationsVersion:n.toString(),lockPluginsVersion:i.toString()}),a=an,s=o,u="/sourceConfig/",l="";if(Di(e)){var c=new URL(e);qu(c.pathname).endsWith("/sourceConfig")||(c.pathname="".concat(qu(c.pathname),"/sourceConfig/")),c.pathname=Ci(c.pathname),o.forEach(function(e,t){null===c.searchParams.get(t)&&c.searchParams.set(t,e)}),a=c.origin,u=c.pathname,s=c.searchParams,l=c.hash}else r.warn(function(e,t){return"".concat(e).concat(Ge,'The provided source config URL "').concat(t,'" is invalid. Using the default source config URL instead.')}(ke,e));return"".concat(a).concat(u,"?").concat(s).concat(l)},ll=function(e,t,n,i,r,o,a){var s,u,l;if(o){if(!Di(o))return a.error((u=e,l=o,"".concat(ke).concat(Ge,'The base URL "').concat(l,'" for ').concat(u," is not valid."))),null;s=qu(o)}else if(s=n,"cdn"===Cn.context.app.value.installType){var c=nl();c&&(s=c.split("/").slice(0,-1).concat(t).join("/"))}return r&&(s=s.replace(new RegExp("/".concat(nn,"/").concat(en,"/").concat(t,"$")),"/".concat(i,"/").concat(en,"/").concat(t))),s},cl=function(){return s(function e(t,n,i){o(this,e),this.errorHandler=n,this.logger=i,this.httpClient=t,this.onError=this.onError.bind(this),this.processConfig=this.processConfig.bind(this)},[{key:"attachEffects",value:function(){var e=this;_t(function(){e.logger.setMinLogLevel(Cn.lifecycle.logLevel.value)})}},{key:"init",value:function(){var e=this,t=Cn.loadOptions.value,n=t.logLevel,i=t.configUrl,r=t.lockIntegrationsVersion,o=t.lockPluginsVersion,a=t.destSDKBaseURL;t.pluginsSDKBaseURL;var s=t.integrations,u=function(e,t,n,i){return ll("integrations",$t,rn,e,t,n,i)}(Ze,r,a,this.logger);Q(u)||(this.attachEffects(),Cn.lifecycle.activeDataplaneUrl.value=qu(Cn.lifecycle.dataPlaneUrl.value),ol(this.logger),al(this.logger),sl(this.logger),yt(function(){Cn.lifecycle.integrationsCDNPath.value=u,Cn.lifecycle.pluginsCDNPath.value=undefined,n&&(Cn.lifecycle.logLevel.value=n),Cn.lifecycle.sourceConfigUrl.value=ul(i,Cn.lifecycle.writeKey.value,r,o,e.logger),Cn.metrics.metricsServiceUrl.value="".concat(Cn.lifecycle.activeDataplaneUrl.value,"/").concat("rsaMetrics"),Cn.nativeDestinations.loadOnlyIntegrations.value=s}),this.getConfig())}},{key:"onError",value:function(e,t,n){this.errorHandler.onError({error:e,context:ke,customMessage:t,groupingHash:n})}},{key:"processConfig",value:function(e,t){if(q(e)){var n;try{n=z(e)?JSON.parse(e):e}catch(r){return void this.onError(r,Qt)}if(function(e){return Z(e)&&Z(e.source)&&!V(e.source.id)&&Z(e.source.config)&&Array.isArray(e.source.destinations)}(n))if(!1!==n.source.enabled){il(n);var i=n.source.destinations.length>0?n.source.destinations.map(function(e){var t,n,i,r;return{id:e.id,displayName:e.destinationDefinition.displayName,enabled:e.enabled,config:e.config,shouldApplyDeviceModeTransformation:null!==(t=e.shouldApplyDeviceModeTransformation)&&void 0!==t&&t,propagateEventsUntransformedOnError:null!==(n=e.propagateEventsUntransformedOnError)&&void 0!==n&&n,userFriendlyId:(i=e.destinationDefinition.displayName,r=e.id,"".concat(i.replaceAll(" ","-"),"___").concat(r)),isCustomIntegration:"Custom Device Mode"===e.destinationDefinition.displayName}}):[];yt(function(){var e;Cn.source.value={config:n.source.config,name:n.source.name,id:n.source.id,workspaceId:n.source.workspaceId},Cn.nativeDestinations.configuredDestinations.value=i,Cn.plugins.pluginsToLoadFromConfig.value=null!==(e=Cn.loadOptions.value.plugins)&&void 0!==e?e:[],function(e){var t,n=Cn.consents.resolutionStrategy.value;if(Z(e.consentManagementMetadata)){var i,r;Cn.consents.provider.value&&(n=null!==(i=null===(r=e.consentManagementMetadata.providers.find(function(e){return e.provider===Cn.consents.provider.value}))||void 0===r?void 0:r.resolutionStrategy)&&void 0!==i?i:Cn.consents.resolutionStrategy.value),t=e.consentManagementMetadata}"custom"===Cn.consents.provider.value&&(n=void 0),yt(function(){Cn.consents.metadata.value=_(t),Cn.consents.resolutionStrategy.value=n})}(n),Cn.lifecycle.status.value="configured"})}else this.logger.error("The source is disabled. Please enable the source in the dashboard to send events.");else this.onError(new Error(Qt))}else q(t)?this.onError(t.error,qt):this.onError(new Error(qt))}},{key:"getConfig",value:function(){var e,t=this,n=Cn.loadOptions.value.getSourceConfig;if(n){if(!H(n))return void this.logger.error((e=ke,"".concat(e).concat(Ge,'The "getSourceConfig" load API option must be a function that returns valid source configuration data.')));var i=n();i instanceof Promise?i.then(function(e){return t.processConfig(e)}).catch(function(e){t.onError(e,"SourceConfig")}):this.processConfig(i)}else this.httpClient.getAsyncData({url:Cn.lifecycle.sourceConfigUrl.value,options:{headers:{"Content-Type":void 0}},callback:this.processConfig})}}])}(),dl=function(){var e;return(null===(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return document})())||void 0===e?void 0:e.referrer)||"$direct"},vl=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return document},t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return globalThis.location})(),n=function(){for(var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return document})().getElementsByTagName("link"),t="",n=0;e[n];n+=1){var i=e[n];if("canonical"===i.getAttribute("rel")&&!t){var r;t=null!==(r=i.getAttribute("href"))&&void 0!==r?r:"";break}}return t}(e),i=t.pathname,r=t.href,o=r,a=t.search;if(n)try{var s=new URL(n);o=""===s.search?n+a:n,i=s.pathname}catch(d){}var u=function(e){var t=e;try{var n=new URL(e);t=n.origin+n.pathname+n.search}catch(i){}return t}(o),l=e().title,c=dl(e);return{path:i,referrer:c,referring_domain:Wu(c),search:a,title:l,url:u,tab_url:r}},fl="".concat("https://polyfill-fastly.io/v3/polyfill.min.js","?version=3.111.0&features=").concat(Object.keys(Nu).join("%2C")),hl="rudderstackPolyfill",gl=function(){return s(function e(t,n,i){o(this,e),this.httpClient=t,this.errorHandler=n,this.logger=i,this.externalSrcLoader=new ht(this.logger),this.onError=this.onError.bind(this),this.onReady=this.onReady.bind(this)},[{key:"init",value:function(){this.prepareBrowserCapabilities(),this.attachWindowListeners()}},{key:"detectBrowserCapabilities",value:function(){var e=this;yt(function(){var t;Cn.capabilities.storage.isCookieStorageAvailable.value=Lu(Si,Gu(Si),e.logger),Cn.capabilities.storage.isLocalStorageAvailable.value=Lu(Ti,void 0,e.logger),Cn.capabilities.storage.isSessionStorageAvailable.value=Lu(wi,void 0,e.logger),Cn.capabilities.isBeaconAvailable.value=!V(globalThis.navigator.sendBeacon)&&H(globalThis.navigator.sendBeacon),Cn.capabilities.isUaCHAvailable.value=Mu(),Cn.capabilities.isCryptoAvailable.value=!V(globalThis.crypto)&&H(globalThis.crypto.getRandomValues),Cn.capabilities.isIE11.value=Be(),Cn.capabilities.isOnline.value=globalThis.navigator.onLine,Cn.context.userAgent.value=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return globalThis.navigator})();if(K(e))return null;var t=e.userAgent,n=e.brave;if(n&&Object.getPrototypeOf(n).isBrave){var i=t.match(/(chrome)\/([\w.]+)/i);i&&(t="".concat(t," Brave/").concat(i[2]))}return t}(),Cn.context.locale.value=function(){var e,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return globalThis.navigator})();return K(t)?null:null!==(e=t.language)&&void 0!==e?e:t.browserLanguage}(),Cn.context.screen.value=xu(),Cn.context.timezone.value=null!=(t=/([A-Z]+[+-]\d+)/.exec((new Date).toString()))&&t[1]?t[1]:"NA",Mu()&&function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";"none"===n&&e(void 0),"default"===n&&e(navigator.userAgentData),"full"===n&&(null===(t=navigator.userAgentData)||void 0===t||t.getHighEntropyValues(["architecture","bitness","brands","mobile","model","platform","platformVersion","uaFullVersion","fullVersionList","wow64"]).then(function(t){e(t)}).catch(function(){e()}))}(function(e){Cn.context["ua-ch"].value=e},Cn.loadOptions.value.uaChTrackLevel)}),_t(function(){!0===Cn.loadOptions.value.sendAdblockPage&&void 0!==Cn.lifecycle.sourceConfigUrl.value&&ri(e.httpClient)})}},{key:"prepareBrowserCapabilities",value:function(){var e=this;Cn.capabilities.isLegacyDOM.value=function(){for(var e=Object.keys(Nu),t=!1,n=0;n<e.length;n++){var i=Nu[e[n]];if(H(i)&&i()){t=!0;break}}return t}();var t=Cn.loadOptions.value.polyfillURL,n=fl;if(X(t)&&(Di(t)?n=t:this.logger.warn(function(e,t){return"".concat(e).concat(Ge,'The provided polyfill URL "').concat(t,'" is invalid. The default polyfill URL will be used instead.')}(be,t))),Cn.loadOptions.value.polyfillIfRequired&&Cn.capabilities.isLegacyDOM.value&&Di(n)){var i=n!==Cn.loadOptions.value.polyfillURL;if(i){var r="RS_polyfillCallback_".concat(Cn.lifecycle.writeKey.value);globalThis[r]=function(){e.onReady(),delete globalThis[r]},n="".concat(n,"&callback=").concat(r)}this.externalSrcLoader.loadJSFile({url:n,id:hl,async:!0,timeout:1e4,callback:function(t){t?i||e.onReady():e.onError(new Error(function(e,t){return'Failed to load the polyfill script with ID "'.concat(e,'" from URL ').concat(t,".")}(hl,n)))}})}else this.onReady()}},{key:"attachWindowListeners",value:function(){globalThis.addEventListener("offline",function(){Cn.capabilities.isOnline.value=!1}),globalThis.addEventListener("online",function(){Cn.capabilities.isOnline.value=!0}),globalThis.addEventListener("resize",function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];globalThis.clearTimeout(n),n=globalThis.setTimeout(function(){e.apply(t,o)},i)}}(function(){Cn.context.screen.value=xu()},this))}},{key:"onReady",value:function(){this.detectBrowserCapabilities(),Cn.lifecycle.status.value="browserCapabilitiesReady"}},{key:"onError",value:function(e,t){this.errorHandler.onError({error:e,context:be,groupingHash:t})}}])}(),pl=["integrations","anonymousId","originalTimestamp"],yl=["library","consentManagement","userAgent","ua-ch","screen"],ml=["id","anonymous_id","user_id","sent_at","timestamp","received_at","original_timestamp","event","event_text","channel","context_ip","context_request_ip","context_passed_ip","group_id","previous_id"],bl=function(e){return"number"==typeof e&&!Number.isNaN(e)},kl=function(e){return bl(e)&&e>=0&&Number.isInteger(e)},El=["entries"],Al=function(e){var t=e.cutOff,n=Date.now();return Boolean((null==t?void 0:t.enabled)&&t.expiresAt&&n>t.expiresAt)},Il=function(e){return Boolean(!e.expiresAt||Date.now()>e.expiresAt)||Al(e)},Sl=function(e,t){return!!(e&&kl(e)&&(n=10,i=e,i.toString().length>=n))||(t.warn(function(e,t,n){return"".concat(e).concat(Ge,"The provided session ID (").concat(t,') is either invalid, not a positive integer, or not at least "').concat(n,'" digits long. A new session ID will be auto-generated instead.')}(Ie,e,10)),!1);var n,i},Tl=function(e,t){return{id:Sl(e,t)?e:Date.now(),sessionStart:void 0,manualTrack:!0}},wl=function(e){return Boolean(e===Si||e===Ti||e===wi||e===Oi)},Ol=function(){return Le()},Pl=function(e){if(J(e)){var t=fn.entries,n=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(fn,El);return h(h({},n),{},{entries:h(h({},t),{},{anonymousId:e})})}return Z(e)&&Z(e.entries)?te(fn,e):h({},fn)},Cl=function(e){var t=vl(),n={};return Object.keys(t).forEach(function(i){n[i]=(null==e?void 0:e[i])||t[i]}),n.initial_referrer=(null==e?void 0:e.initial_referrer)||Cn.session.initialReferrer.value,n.initial_referring_domain=(null==e?void 0:e.initial_referring_domain)||Cn.session.initialReferringDomain.value,n},Dl=function(e,t,n){Z(e)&&Object.keys(e).forEach(function(e){(ml.includes(e)||ml.includes(e.toLowerCase()))&&n.warn(function(e,t,n,i){return"".concat(e).concat(Ge,'The "').concat(t,'" property defined under "').concat(n,'" is a reserved keyword. Please choose a different property name to avoid conflicts with reserved keywords (').concat(i,").")}(Ee,e,t,ml))})},Rl=function(e,t,n){var i=e;return Object.keys(t).forEach(function(e){if(!pl.includes(e)&&!yl.includes(e))if("context"!==e)i=te(i,u({},e,t[e]));else if(!K(t[e])&&Z(t[e])){var r={};Object.keys(t[e]).forEach(function(n){yl.includes(n)||(r[n]=t[e][n])}),i=te(i,h({},r))}else n.warn("".concat(Ee).concat(Ge,'Please make sure that the "context" property in the event API\'s "options" argument is a valid object literal with key-value pairs.'))}),i},Ml=function(e,t,n){Z(t)&&(!function(e,t){t.anonymousId&&z(t.anonymousId)&&(e.anonymousId=t.anonymousId),ne(t.integrations)&&(e.integrations=t.integrations),t.originalTimestamp&&z(t.originalTimestamp)&&(e.originalTimestamp=t.originalTimestamp)}(e,t),e.context=Rl(e.context,t,n))},Nl=function(e,t,n,i){var r,o,a,s={channel:"web",context:h(h({traits:_(Cn.session.userTraits.value),sessionId:Cn.session.sessionInfo.value.id||void 0,sessionStart:Cn.session.sessionInfo.value.sessionStart||void 0},Cn.consents.enabled.value&&{consentManagement:{deniedConsentIds:_(Cn.consents.data.value.deniedConsentIds),allowedConsentIds:_(Cn.consents.data.value.allowedConsentIds),provider:Cn.consents.provider.value,resolutionStrategy:Cn.consents.resolutionStrategy.value}}),{},{"ua-ch":Cn.context["ua-ch"].value,app:Cn.context.app.value,library:Cn.context.library.value,userAgent:Cn.context.userAgent.value,os:Cn.context.os.value,locale:Cn.context.locale.value,screen:Cn.context.screen.value,campaign:Ju(globalThis.location.href),page:Cl(n),timezone:Cn.context.timezone.value},Cn.autoTrack.enabled.value&&{autoTrack:h({},Cn.autoTrack.pageLifecycle.enabled.value&&{page:{pageViewId:Cn.autoTrack.pageLifecycle.pageViewId.value}})}),originalTimestamp:Fe(),messageId:Le(),userId:e.userId||Cn.session.userId.value};(wl(null===(r=Cn.storage.entries.value.anonymousId)||void 0===r?void 0:r.type)?s.anonymousId=Cn.session.anonymousId.value:s.anonymousId=Ol(),Cn.storage.trulyAnonymousTracking.value&&(s.context.trulyAnonymousTracking=!0),"identify"===e.type)&&(s.context.traits=(null===(o=Cn.storage.entries.value.userTraits)||void 0===o?void 0:o.type)!==Pi?_(Cn.session.userTraits.value):e.context.traits);"group"===e.type&&((e.groupId||Cn.session.groupId.value)&&(s.groupId=e.groupId||Cn.session.groupId.value),(e.traits||Cn.session.groupTraits.value)&&(s.traits=(null===(a=Cn.storage.entries.value.groupTraits)||void 0===a?void 0:a.type)!==Pi?_(Cn.session.groupTraits.value):e.traits));var u,l,c,d=te(e,s);return void 0===d.event&&(d.event=null),void 0===d.properties&&(d.properties=null),Ml(d,t,i),function(e,t){var n=e.properties,i=e.traits,r=e.context.traits;Dl(n,"properties",t),Dl(i,"traits",t),Dl(r,"context.traits",t)}(d,i),d.integrations=(u=d.integrations,l=Cn.loadOptions.value.useGlobalIntegrationsConfigInEvents?null!==(c=Cn.consents.postConsent.value.integrations)&&void 0!==c?c:Cn.nativeDestinations.loadOnlyIntegrations.value:u||Yt,_(l)),d},xl=function(){return s(function e(t){o(this,e),this.logger=t},[{key:"generatePageEvent",value:function(e,t,n,i){var r=null!=n?n:{};return r=function(e,t){var n=(null==t?void 0:t.page)||{},i=e,r=vl();return Object.keys(r).forEach(function(e){K(i[e])&&(i[e]=n[e]||r[e])}),K(i.initial_referrer)&&(i.initial_referrer=n.initial_referrer||Cn.session.initialReferrer.value),K(i.initial_referring_domain)&&(i.initial_referring_domain=n.initial_referring_domain||Cn.session.initialReferringDomain.value),i}(r,i),Nl({properties:r,name:t,category:e,type:"page"},i,r,this.logger)}},{key:"generateTrackEvent",value:function(e,t,n){return Nl({properties:t,event:e,type:"track"},n,void 0,this.logger)}},{key:"generateIdentifyEvent",value:function(e,t,n){return Nl({userId:e,type:"identify",context:{traits:t}},n,void 0,this.logger)}},{key:"generateAliasEvent",value:function(e,t,n){var i=Nl({previousId:t,type:"alias"},n,void 0,this.logger);return i.userId=null!=e?e:i.userId,i}},{key:"generateGroupEvent",value:function(e,t,n){var i={type:"group"};return e&&(i.groupId=e),t&&(i.traits=t),Nl(i,n,void 0,this.logger)}},{key:"create",value:function(e){var t;switch(e.type){case"page":t=this.generatePageEvent(e.category,e.name,e.properties,e.options);break;case"track":t=this.generateTrackEvent(e.name,e.properties,e.options);break;case"identify":t=this.generateIdentifyEvent(e.userId,e.traits,e.options);break;case"alias":t=this.generateAliasEvent(e.to,e.from,e.options);break;default:t=this.generateGroupEvent(e.groupId,e.traits,e.options)}return t}}])}(),_l=function(){return s(function e(t,n,i,r){o(this,e),this.eventRepository=t,this.userSessionManager=n,this.errorHandler=i,this.logger=r,this.eventFactory=new xl(this.logger)},[{key:"init",value:function(){this.eventRepository.init()}},{key:"resume",value:function(){this.eventRepository.resume()}},{key:"addEvent",value:function(e){this.userSessionManager.refreshSession();var t=this.eventFactory.create(e);this.eventRepository.enqueue(t,e.callback)}}])}(),Ll=function(){return s(function e(t,n,i,r,a){o(this,e),this.storeManager=n,this.pluginsManager=t,this.logger=a,this.errorHandler=r,this.httpClient=i,this.onError=this.onError.bind(this),this.serverSideCookieDebounceFuncs={}},[{key:"init",value:function(){this.syncStorageDataToState(),this.registerEffects()}},{key:"syncStorageDataToState",value:function(){this.migrateStorageIfNeeded(),this.migrateDataFromPreviousStorage(),this.setUserId(this.getUserId()),this.setUserTraits(this.getUserTraits()),this.setGroupId(this.getGroupId()),this.setGroupTraits(this.getGroupTraits());var e,t=Cn.loadOptions.value,n=t.externalAnonymousIdCookieName,i=t.anonymousIdOptions;X(n)&&"string"==typeof n&&(e=this.getExternalAnonymousIdByCookieName(n)),this.setAnonymousId(null!=e?e:this.getAnonymousId(i)),this.setAuthToken(this.getAuthToken()),this.setInitialReferrerInfo(),this.configureSessionTracking()}},{key:"configureSessionTracking",value:function(){var e;if(this.isPersistenceEnabledForStorageEntry("sessionInfo")){var t,n,i=this.getConfiguredSessionTrackingInfo(),r=null!==(t=this.getSessionInfo())&&void 0!==t?t:vn.sessionInfo;if((e={autoTrack:i.autoTrack&&!0!==r.manualTrack,timeout:i.timeout,manualTrack:r.manualTrack,expiresAt:r.expiresAt,id:r.id,sessionStart:r.sessionStart}).autoTrack||!0===e.manualTrack){if(!0===(null===(n=i.cutOff)||void 0===n?void 0:n.enabled)){var o;e.cutOff={enabled:!0,duration:i.cutOff.duration,expiresAt:null===(o=r.cutOff)||void 0===o?void 0:o.expiresAt}}}else e=vn.sessionInfo}else e=vn.sessionInfo;Cn.session.sessionInfo.value=e,Cn.session.sessionInfo.value.autoTrack&&this.startOrRenewAutoTracking(Cn.session.sessionInfo.value)}},{key:"setInitialReferrerInfo",value:function(){var e=this.getInitialReferrer(),t=this.getInitialReferringDomain();if(e&&t)this.setInitialReferrer(e),this.setInitialReferringDomain(t);else{var n=e||dl();this.setInitialReferrer(n),this.setInitialReferringDomain(Wu(n))}}},{key:"isPersistenceEnabledForStorageEntry",value:function(e){var t;return wl(null===(t=Cn.storage.entries.value[e])||void 0===t?void 0:t.type)}},{key:"migrateDataFromPreviousStorage",value:function(){var e=this,t=Cn.storage.entries.value,n=[Si,Ti,wi];Object.keys(t).forEach(function(i){var r,o,a=i,s=null===(r=t[a])||void 0===r?void 0:r.type,u=null===(o=e.storeManager)||void 0===o?void 0:o.getStore(Tu[s]);u&&n.forEach(function(t){var n,i=null===(n=e.storeManager)||void 0===n?void 0:n.getStore(Tu[t]);if(i&&t!==s){var r=i.get(Li[a]);(function(e){return X(e)&&""!==e})(r)&&u.set(Li[a],r),i.remove(Li[a])}})})}},{key:"migrateStorageIfNeeded",value:function(e,t){var n=this;if(Cn.storage.migrate.value){var i=null!=e?e:[];if(0===i.length)[Eu,Au,Iu].forEach(function(e){var t,r=null===(t=n.storeManager)||void 0===t?void 0:t.getStore(e);r&&i.push(r)});(null!=t?t:Object.keys(Li)).forEach(function(e){var t=Li[e];i.forEach(function(e){var i,r=null===(i=n.pluginsManager)||void 0===i?void 0:i.invokeSingle("storage.migrate",t,e.engine,n.errorHandler,n.logger);V(r)||e.set(t,r)})})}}},{key:"getConfiguredSessionTrackingInfo",value:function(){var e,t,n=!1!==Cn.loadOptions.value.sessions.autoTrack;if(!n)return{autoTrack:n};var i=null===(e=Cn.loadOptions.value.sessions)||void 0===e?void 0:e.timeout;return kl(i)?t=i:(this.logger.warn(function(e,t,n){return"".concat(e).concat(Ge,'The session timeout value "').concat(t,'" is not a number. The default timeout of ').concat(n," ms will be used instead.")}(Ie,i,at)),t=at),0===t&&(this.logger.warn("".concat(Ie).concat(Ge,"The session timeout value is 0, which disables the automatic session tracking feature. If you want to enable session tracking, please provide a positive integer value for the timeout.")),n=!1),t>0&&t<1e4&&this.logger.warn(function(e,t,n){return"".concat(e).concat(Ge,"The session timeout value ").concat(t," ms is less than the recommended minimum of ").concat(n," ms. Please consider increasing the timeout value to ensure optimal performance and reliability.")}(Ie,t,1e4)),{timeout:t,autoTrack:n,cutOff:this.getCutOffInfo(t)}}},{key:"getCutOffInfo",value:function(e){var t,n=Cn.loadOptions.value.sessions.cutOff,i=!1;return!0===n.enabled&&(t=n.duration,i=!0,kl(t)?t<e&&(this.logger.warn(function(e,t,n){return"".concat(e).concat(Ge,'The session cut off duration value "').concat(t,'" ms is less than the session timeout value "').concat(n,'" ms. The cut off functionality will be disabled.')}(Ie,t,e)),i=!1):(this.logger.warn(function(e,t,n){return"".concat(e).concat(Ge,'The session cut off duration value "').concat(t,'" is not a number. The default cut off duration of ').concat(n," ms will be used instead.")}(Ie,t,ot)),t=ot)),{enabled:i,duration:t}}},{key:"onError",value:function(e,t,n){this.errorHandler.onError({error:e,context:Ie,customMessage:t,groupingHash:n})}},{key:"getEncryptedCookieData",value:function(e,t){var n=this,i=[];return e.forEach(function(e){var r=null==t?void 0:t.encrypt(Ke(e.value,!1,[],n.logger));X(r)&&i.push({name:e.name,value:r})}),i}},{key:"makeRequestToSetCookie",value:function(e,t){var n,i,r,o,a,s,u,l;null===(n=this.httpClient)||void 0===n||n.getAsyncData({url:Cn.serverCookies.dataServiceUrl.value,options:{method:"POST",data:Ke({reqType:"setCookies",workspaceId:null===(i=Cn.source.value)||void 0===i?void 0:i.workspaceId,data:{options:{maxAge:null===(r=Cn.storage.cookie.value)||void 0===r?void 0:r.maxage,path:null===(o=Cn.storage.cookie.value)||void 0===o?void 0:o.path,domain:null===(a=Cn.storage.cookie.value)||void 0===a?void 0:a.domain,sameSite:null===(s=Cn.storage.cookie.value)||void 0===s?void 0:s.samesite,secure:null===(u=Cn.storage.cookie.value)||void 0===u?void 0:u.secure,expires:null===(l=Cn.storage.cookie.value)||void 0===l?void 0:l.expires},cookies:e}}),sendRawData:!0,withCredentials:!0},isRawResponse:!0,callback:t})}},{key:"setServerSideCookies",value:function(e,t,n){var i=this;try{var r=this.getEncryptedCookieData(e,n);r.length>0&&this.makeRequestToSetCookie(r,function(r,o){var a,s,u;200===(null==o||null===(a=o.xhr)||void 0===a?void 0:a.status)?e.forEach(function(e){var r,o=null==n?void 0:n.get(e.name),a=Ke(e.value,!1,[]);Ke(o,!1,[])!==a&&(i.logger.error((r=e.name,"The server failed to set the ".concat(r," cookie. As a fallback, the cookies will be set client side."))),t&&t(e.name,e.value))}):(i.logger.error((u=null==o||null===(s=o.xhr)||void 0===s?void 0:s.status,"The server responded with status ".concat(u," while setting the cookies. As a fallback, the cookies will be set client side."))),e.forEach(function(e){t&&t(e.name,e.value)}))})}catch(St){this.onError(St,Jt,Jt),e.forEach(function(e){t&&t(e.name,e.value)})}}},{key:"syncValueToStorage",value:function(e,t){var n,i=this,r=Cn.storage.entries.value,o=null===(n=r[e])||void 0===n?void 0:n.type;if(wl(o)){var a,s,u=null===(a=this.storeManager)||void 0===a?void 0:a.getStore(Tu[o]),l=null===(s=r[e])||void 0===s?void 0:s.key;t&&(z(t)||ne(t))?Cn.serverCookies.isEnabledServerSideCookies.value&&o===Si?(this.serverSideCookieDebounceFuncs[e]&&globalThis.clearTimeout(this.serverSideCookieDebounceFuncs[e]),this.serverSideCookieDebounceFuncs[e]=globalThis.setTimeout(function(){i.setServerSideCookies([{name:l,value:t}],function(e,t){null==u||u.set(e,t)},u)},10)):null==u||u.set(l,t):null==u||u.remove(l)}}},{key:"registerEffects",value:function(){var e=this;Su.forEach(function(t){_t(function(){e.syncValueToStorage(t,Cn.session[t].value)})})}},{key:"setAnonymousId",value:function(e,t){var n=e;if(z(e)&&n||(n=void 0),this.isPersistenceEnabledForStorageEntry("anonymousId")){var i;if(!n&&t)n=null===(i=this.pluginsManager)||void 0===i?void 0:i.invokeSingle("userSession.anonymousIdGoogleLinker",t);n=n||Ol()}else n=vn.anonymousId;Cn.session.anonymousId.value=n}},{key:"getAnonymousId",value:function(e){var t,n=null===(t=Cn.storage.entries.value.anonymousId)||void 0===t?void 0:t.type;if(wl(n)){var i,r=Cn.session.anonymousId.value;if(r&&r!==vn.anonymousId||(r=this.getEntryValue("anonymousId")),!r&&e)r=null===(i=this.pluginsManager)||void 0===i?void 0:i.invokeSingle("storage.getAnonymousId",Gu,e);Cn.session.anonymousId.value=r||Ol()}return Cn.session.anonymousId.value}},{key:"getEntryValue",value:function(e){var t,n=Cn.storage.entries.value,i=null===(t=n[e])||void 0===t?void 0:t.type;if(wl(i)){var r,o,a,s=null===(r=this.storeManager)||void 0===r?void 0:r.getStore(Tu[i]);this.migrateStorageIfNeeded([s],[e]);var u=null===(o=n[e])||void 0===o?void 0:o.key;return null!==(a=null==s?void 0:s.get(u))&&void 0!==a?a:null}return null}},{key:"getExternalAnonymousIdByCookieName",value:function(e){var t,n=Gu(Si);return null!=n&&n.isEnabled&&null!==(t=n.getItem(e))&&void 0!==t?t:null}},{key:"getUserId",value:function(){return this.getEntryValue("userId")}},{key:"getUserTraits",value:function(){return this.getEntryValue("userTraits")}},{key:"getGroupId",value:function(){return this.getEntryValue("groupId")}},{key:"getGroupTraits",value:function(){return this.getEntryValue("groupTraits")}},{key:"getInitialReferrer",value:function(){return this.getEntryValue("initialReferrer")}},{key:"getInitialReferringDomain",value:function(){return this.getEntryValue("initialReferringDomain")}},{key:"getSessionInfo",value:function(){return this.getEntryValue("sessionInfo")}},{key:"getAuthToken",value:function(){return this.getEntryValue("authToken")}},{key:"getSessionId",value:function(){var e,t,n=null!==(e=this.getSessionInfo())&&void 0!==e?e:vn.sessionInfo;return(n.autoTrack&&!Il(n)||n.manualTrack)&&null!==(t=n.id)&&void 0!==t?t:null}},{key:"refreshSession",value:function(){var e,t=null!==(e=this.getSessionInfo())&&void 0!==e?e:vn.sessionInfo;(t.autoTrack||t.manualTrack)&&(t.autoTrack&&(this.startOrRenewAutoTracking(t),t=Cn.session.sessionInfo.value),void 0===t.sessionStart?t=h(h({},t),{},{sessionStart:!0}):t.sessionStart&&(t=h(h({},t),{},{sessionStart:!1}))),Cn.session.sessionInfo.value=t,"readyExecuted"!==Cn.lifecycle.status.value&&this.syncValueToStorage("sessionInfo",t)}},{key:"resetAndStartNewSession",value:function(){var e=Cn.session,t=e.sessionInfo.value,n=t.manualTrack,i=t.autoTrack,r=t.timeout,o=t.cutOff;if(i){var a=h(h({},vn.sessionInfo),{},{timeout:r});o&&(a.cutOff={enabled:o.enabled,duration:o.duration}),e.sessionInfo.value=a,this.startOrRenewAutoTracking(e.sessionInfo.value)}else n&&this.startManualTrackingInternal()}},{key:"reset",value:function(e){var t=this,n=Cn.session,i=Pl(e);yt(function(){Object.keys(vn).forEach(function(e){var r=e;if(!0===i.entries[r])switch(e){case"anonymousId":t.setAnonymousId();break;case"sessionInfo":t.resetAndStartNewSession();break;default:n[r].value=vn[r]}})})}},{key:"setUserId",value:function(e){Cn.session.userId.value=this.isPersistenceEnabledForStorageEntry("userId")&&e?e:vn.userId}},{key:"setUserTraits",value:function(e){var t;Cn.session.userTraits.value=this.isPersistenceEnabledForStorageEntry("userTraits")&&Z(e)?te(null!==(t=Cn.session.userTraits.value)&&void 0!==t?t:vn.userTraits,e):vn.userTraits}},{key:"setGroupId",value:function(e){Cn.session.groupId.value=this.isPersistenceEnabledForStorageEntry("groupId")&&e?e:vn.groupId}},{key:"setGroupTraits",value:function(e){var t;Cn.session.groupTraits.value=this.isPersistenceEnabledForStorageEntry("groupTraits")&&Z(e)?te(null!==(t=Cn.session.groupTraits.value)&&void 0!==t?t:vn.groupTraits,e):vn.groupTraits}},{key:"setInitialReferrer",value:function(e){Cn.session.initialReferrer.value=this.isPersistenceEnabledForStorageEntry("initialReferrer")&&e?e:vn.initialReferrer}},{key:"setInitialReferringDomain",value:function(e){Cn.session.initialReferringDomain.value=this.isPersistenceEnabledForStorageEntry("initialReferringDomain")&&e?e:vn.initialReferringDomain}},{key:"startOrRenewAutoTracking",value:function(e){var t=e;if(Il(e))t=function(e){var t=e.timeout,n=e.cutOff,i=Date.now();return h({id:i,expiresAt:i+t,timeout:t,autoTrack:!0},n&&{cutOff:n})}(e);else{var n=Date.now(),i=e.timeout;t.expiresAt=n+i}if(Al(t)&&(t.cutOff.expiresAt=void 0),t.cutOff){var r=function(e){var t;if(null!=e&&e.enabled)return null!==(t=e.expiresAt)&&void 0!==t?t:kl(e.duration)?Date.now()+e.duration:void 0}(t.cutOff);t.cutOff.expiresAt=r}Cn.session.sessionInfo.value=t}},{key:"start",value:function(e){Cn.session.sessionInfo.value=Tl(e,this.logger)}},{key:"startManualTrackingInternal",value:function(){this.start(Date.now())}},{key:"end",value:function(){Cn.session.sessionInfo.value=vn.sessionInfo}},{key:"setAuthToken",value:function(e){Cn.session.authToken.value=this.isPersistenceEnabledForStorageEntry("authToken")&&e?e:vn.authToken}}])}(),Bl=["BeaconQueue","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ExternalAnonymousId","GoogleLinker","IubendaConsentManager","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],Ul="dataplaneEventsQueue",jl="destinationsEventsQueue",Fl=function(e,t){var n=_(e),i=t.nativeDestinations.integrationsConfig.value,r=function(e,t){return Object.keys(e).filter(function(n){return!0!==e[n]||!t[n]}).reduce(function(t,n){var i=_(t);return i[n]=e[n],i},{})}(e.integrations,i);return n.integrations=te(i,r),n},Gl=function(e,t,n,i){if(q(e))if(H(e))try{e.apply(void 0,k(t))}catch(r){i.error("".concat(n).concat(Ge,"The callback threw an exception"),r)}else i.error(Xt(n))},Hl=function(){return s(function e(t,n,i,r,a){o(this,e),this.pluginsManager=t,this.errorHandler=r,this.httpClient=i,this.logger=a,this.storeManager=n},[{key:"init",value:function(){var e=this;this.dataplaneEventsQueue=this.pluginsManager.invokeSingle("".concat(Ul,".init"),Cn,this.httpClient,this.storeManager,this.errorHandler,this.logger),this.dmtEventsQueue=this.pluginsManager.invokeSingle("".concat("transformEvent",".init"),Cn,this.pluginsManager,this.httpClient,this.storeManager,this.errorHandler,this.logger),this.destinationsEventsQueue=this.pluginsManager.invokeSingle("".concat(jl,".init"),Cn,this.pluginsManager,this.storeManager,this.dmtEventsQueue,this.errorHandler,this.logger),_t(function(){var t,n;!0===Cn.nativeDestinations.clientDestinationsReady.value&&(null===(t=e.destinationsEventsQueue)||void 0===t||t.start(),null===(n=e.dmtEventsQueue)||void 0===n||n.start())});var t,n=function(e){var t;return e.consents.preConsent.value.enabled&&"buffer"===(null===(t=e.consents.preConsent.value.events)||void 0===t?void 0:t.delivery)}(Cn);_t(function(){var i,r,o=!0===Cn.loadOptions.value.bufferDataPlaneEventsUntilReady&&!1===Cn.nativeDestinations.clientDestinationsReady.value;!1!==Cn.nativeDestinations.activeDestinations.value.some(function(e){return ki(e)})&&!1!==o||n||!0===(null===(i=e.dataplaneEventsQueue)||void 0===i?void 0:i.scheduleTimeoutActive)||(globalThis.clearTimeout(t),null===(r=e.dataplaneEventsQueue)||void 0===r||r.start())}),!0===Cn.loadOptions.value.bufferDataPlaneEventsUntilReady&&(t=globalThis.setTimeout(function(){var t,n;!0!==(null===(t=e.dataplaneEventsQueue)||void 0===t?void 0:t.scheduleTimeoutActive)&&(null===(n=e.dataplaneEventsQueue)||void 0===n||n.start())},Cn.loadOptions.value.dataPlaneEventsBufferTimeout))}},{key:"resume",value:function(){var e;if(!0!==(null===(e=this.dataplaneEventsQueue)||void 0===e?void 0:e.scheduleTimeoutActive)){var t,n,i;if(Cn.consents.postConsent.value.discardPreConsentEvents)null===(n=this.dataplaneEventsQueue)||void 0===n||n.clear(),null===(i=this.destinationsEventsQueue)||void 0===i||i.clear();null===(t=this.dataplaneEventsQueue)||void 0===t||t.start()}}},{key:"enqueue",value:function(e,t){var n=Fl(e,Cn);this.pluginsManager.invokeSingle("".concat(Ul,".enqueue"),Cn,this.dataplaneEventsQueue,n,this.errorHandler,this.logger);var i=_(e);this.pluginsManager.invokeSingle("".concat(jl,".enqueue"),Cn,this.destinationsEventsQueue,i,this.errorHandler,this.logger);var r="".concat(e.type.charAt(0).toUpperCase()).concat(e.type.slice(1)).concat(me);Gl(t,[n],r,this.logger)}}])}(),zl=function(e){var t=new CustomEvent(e,{detail:{analyticsInstance:globalThis.rudderanalytics},bubbles:!0,cancelable:!0,composed:!0});globalThis.document.dispatchEvent(t)},Ql=function(){return s(function e(){o(this,e),this.preloadBuffer=new Lt,this.initialized=!1,this.errorHandler=pi,this.logger=Ft,this.externalSrcLoader=new ht(this.logger),this.httpClient=ti,this.httpClient.init(this.errorHandler),this.capabilitiesManager=new gl(this.httpClient,this.errorHandler,this.logger)},[{key:"load",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Cn.lifecycle.status.value||(!function(e){return z(e)&&e.trim().length>0}(e)?this.logger.error(function(e,t){return"".concat(e).concat(Ge,'The write key "').concat(t,'" is invalid. It must be a non-empty string. Please check that the write key is correct and try again.')}(Pe,e)):!function(e){return Di(e)}(t)?this.logger.error(function(e,t){return"".concat(e).concat(Ge,'The data plane URL "').concat(t,'" is invalid. It must be a valid URL string. Please check that the data plane URL is correct and try again.')}(Pe,t)):(yt(function(){Cn.lifecycle.writeKey.value=_(e),Cn.lifecycle.dataPlaneUrl.value=_(t),Cn.loadOptions.value=function(e,t){var n,i=_(t);return z(i.setCookieDomain)||(i.setCookieDomain=void 0),["Strict","Lax","None"].includes(i.sameSiteCookie)||(i.sameSiteCookie=void 0),i.secureCookie=ae(i.secureCookie,e.secureCookie),i.sameDomainCookiesOnly=ae(i.sameDomainCookiesOnly,e.sameDomainCookiesOnly),["none","default","full"].includes(i.uaChTrackLevel)||(i.uaChTrackLevel=void 0),i.integrations=oe(i.integrations),Array.isArray(i.plugins)||(i.plugins=Bl),i.useGlobalIntegrationsConfigInEvents=ae(i.useGlobalIntegrationsConfigInEvents,e.useGlobalIntegrationsConfigInEvents),i.bufferDataPlaneEventsUntilReady=ae(i.bufferDataPlaneEventsUntilReady,e.bufferDataPlaneEventsUntilReady),i.sendAdblockPage=ae(i.sendAdblockPage,e.sendAdblockPage),i.useServerSideCookies=ae(i.useServerSideCookies,e.useServerSideCookies),z(i.dataServiceEndpoint)||(i.dataServiceEndpoint=void 0),i.sendAdblockPageOptions=oe(i.sendAdblockPageOptions),i.loadIntegration=ae(i.loadIntegration,e.loadIntegration),ne(i.storage)?(i.storage.migrate=ae(i.storage.migrate,null===(n=e.storage)||void 0===n?void 0:n.migrate),i.storage.cookie=oe(i.storage.cookie),i.storage.encryption=oe(i.storage.encryption),i.storage=re(i.storage)):i.storage=void 0,i.destinationsQueueOptions=oe(i.destinationsQueueOptions),i.queueOptions=oe(i.queueOptions),i.lockIntegrationsVersion=ae(i.lockIntegrationsVersion,e.lockIntegrationsVersion),i.lockPluginsVersion=ae(i.lockPluginsVersion,e.lockPluginsVersion),bl(i.dataPlaneEventsBufferTimeout)||(i.dataPlaneEventsBufferTimeout=void 0),i.beaconQueueOptions=oe(i.beaconQueueOptions),i.preConsent=oe(i.preConsent),i.sourceConfigurationOverride=oe(i.sourceConfigurationOverride),te(e,re(i))}(Cn.loadOptions.value,i),Cn.lifecycle.status.value="mounted"}),this.logger.setMinLogLevel(null!==(n=Cn.loadOptions.value.logLevel)&&void 0!==n?n:Ut),ut("state",Cn,e),this.startLifecycle()))}},{key:"startLifecycle",value:function(){var e=this;_t(function(){try{switch(Cn.lifecycle.status.value){case"mounted":e.onMounted();break;case"browserCapabilitiesReady":e.onBrowserCapabilitiesReady();break;case"configured":e.onConfigured();break;case"pluginsLoading":case"destinationsLoading":case"readyExecuted":default:break;case"pluginsReady":e.onPluginsReady();break;case"initialized":e.onInitialized();break;case"loaded":e.onLoaded();break;case"destinationsReady":e.onDestinationsReady();break;case"ready":e.onReady()}}catch(n){var t="Failed to load the SDK";e.errorHandler.onError({error:n,context:Pe,customMessage:t,groupingHash:t})}})}},{key:"onBrowserCapabilitiesReady",value:function(){dt(this),this.prepareInternalServices(),this.loadConfig()}},{key:"onLoaded",value:function(){this.processBufferedEvents(),!0===Cn.consents.preConsent.value.enabled?Cn.lifecycle.status.value="ready":this.loadDestinations()}},{key:"onMounted",value:function(){this.capabilitiesManager.init()}},{key:"enqueuePreloadBufferEvents",value:function(e){var t=this;Array.isArray(e)&&e.forEach(function(e){return t.preloadBuffer.enqueue(_(e))})}},{key:"processDataInPreloadBuffer",value:function(){for(;this.preloadBuffer.size()>0;){var e=this.preloadBuffer.dequeue();e&&vt(k(e),this)}}},{key:"prepareInternalServices",value:function(){this.pluginsManager=new ku(mi,this.errorHandler,this.logger),this.storeManager=new Qu(this.pluginsManager,this.errorHandler,this.logger),this.configManager=new cl(this.httpClient,this.errorHandler,this.logger),this.userSessionManager=new Ll(this.pluginsManager,this.storeManager,this.httpClient,this.errorHandler,this.logger),this.eventRepository=new Hl(this.pluginsManager,this.storeManager,this.httpClient,this.errorHandler,this.logger),this.eventManager=new _l(this.eventRepository,this.userSessionManager,this.errorHandler,this.logger)}},{key:"loadConfig",value:function(){var e;Cn.lifecycle.writeKey.value&&this.httpClient.setAuthHeader(Cn.lifecycle.writeKey.value),null===(e=this.configManager)||void 0===e||e.init()}},{key:"onPluginsReady",value:function(){var e,t,n,i,r;(null===(e=this.storeManager)||void 0===e||e.init(),null===(t=this.userSessionManager)||void 0===t||t.init(),Cn.consents.enabled.value&&!Cn.consents.initialized.value)&&(null===(i=this.pluginsManager)||void 0===i||i.invokeSingle("consentManager.init",Cn,this.logger),!1===Cn.consents.preConsent.value.enabled&&(null===(r=this.pluginsManager)||void 0===r||r.invokeSingle("consentManager.updateConsentsInfo",Cn,this.storeManager,this.logger)));null===(n=this.eventManager)||void 0===n||n.init(),Cn.lifecycle.status.value="initialized"}},{key:"onConfigured",value:function(){var e;null===(e=this.pluginsManager)||void 0===e||e.init()}},{key:"onInitialized",value:function(){this.processDataInPreloadBuffer(),yt(function(){Cn.lifecycle.loaded.value=!0,Cn.lifecycle.status.value="loaded"}),this.initialized=!0;var e=Cn.loadOptions.value.onLoaded;Gl(e,[globalThis.rudderanalytics],Oe,this.logger),zl("RSA_Initialised")}},{key:"onReady",value:function(){var e=this;Cn.lifecycle.status.value="readyExecuted",Cn.eventBuffer.readyCallbacksArray.value.forEach(function(t){Gl(t,[],we,e.logger)}),zl("RSA_Ready")}},{key:"processBufferedEvents",value:function(){for(var e=Cn.eventBuffer.toBeProcessedArray.value;e.length>0;){var t=e.shift();if(Cn.eventBuffer.toBeProcessedArray.value=e,t){var n,i=t[0];if(H(this[i]))(n=this)[i].apply(n,k(t.slice(1)).concat([!0]))}e=Cn.eventBuffer.toBeProcessedArray.value}}},{key:"loadDestinations",value:function(){var e,t;if("destinationsLoading"!==Cn.lifecycle.status.value&&"destinationsReady"!==Cn.lifecycle.status.value){null===(e=this.pluginsManager)||void 0===e||e.invokeSingle("nativeDestinations.setActiveDestinations",Cn,this.pluginsManager,this.errorHandler,this.logger);var n=Cn.nativeDestinations.activeDestinations.value.length;0!==n?(Cn.lifecycle.status.value="destinationsLoading",null===(t=this.pluginsManager)||void 0===t||t.invokeSingle("nativeDestinations.load",Cn,this.externalSrcLoader,this.errorHandler,this.logger),_t(function(){(0===n||Cn.nativeDestinations.initializedDestinations.value.length+Cn.nativeDestinations.failedDestinations.value.length===n)&&yt(function(){Cn.lifecycle.status.value="destinationsReady",Cn.nativeDestinations.clientDestinationsReady.value=!0})})):Cn.lifecycle.status.value="destinationsReady"}}},{key:"onDestinationsReady",value:function(){"ready"!==Cn.lifecycle.status.value&&(Cn.lifecycle.status.value="ready")}},{key:"ready",value:function(e){var t="ready";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(t," invocation")),H(e)?"readyExecuted"===Cn.lifecycle.status.value?Gl(e,[],we,this.logger):Cn.eventBuffer.readyCallbacksArray.value=[].concat(k(Cn.eventBuffer.readyCallbacksArray.value),[e]):this.logger.error(Xt(we))):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[t,e]])}},{key:"page",value:function(e){var t,n="page";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(n," event")),Cn.metrics.triggered.value+=1,null===(t=this.eventManager)||void 0===t||t.addEvent({type:"page",category:e.category,name:e.name,properties:e.properties,options:e.options,callback:e.callback}),!0===Cn.capabilities.isAdBlocked.value&&e.category!==et&&this.page(ve(et,"ad-block page request",{path:"/ad-blocked"},Cn.loadOptions.value.sendAdblockPageOptions))):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[n,e]])}},{key:"track",value:function(e){var t,n="track";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(n," event - ").concat(e.name)),Cn.metrics.triggered.value+=1,null===(t=this.eventManager)||void 0===t||t.addEvent({type:n,name:e.name||void 0,properties:e.properties,options:e.options,callback:e.callback})):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[n,e]])}},{key:"identify",value:function(e){var t,n,i="identify";if(Cn.lifecycle.loaded.value){var r;if(this.errorHandler.leaveBreadcrumb("New ".concat(i," event")),Cn.metrics.triggered.value+=1,Boolean(e.userId&&Cn.session.userId.value&&e.userId!==Cn.session.userId.value)&&this.reset(),!Q(e.userId))null===(r=this.userSessionManager)||void 0===r||r.setUserId(e.userId);null===(t=this.userSessionManager)||void 0===t||t.setUserTraits(e.traits),null===(n=this.eventManager)||void 0===n||n.addEvent({type:i,userId:e.userId,traits:e.traits,options:e.options,callback:e.callback})}else Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[i,e]])}},{key:"alias",value:function(e){var t,n,i,r="alias";if(Cn.lifecycle.loaded.value){this.errorHandler.leaveBreadcrumb("New ".concat(r," event")),Cn.metrics.triggered.value+=1;var o=null!==(t=e.from)&&void 0!==t?t:this.getUserId()||(null===(n=this.userSessionManager)||void 0===n?void 0:n.getAnonymousId());null===(i=this.eventManager)||void 0===i||i.addEvent({type:r,to:e.to,from:o,options:e.options,callback:e.callback})}else Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[r,e]])}},{key:"group",value:function(e){var t,n,i="group";if(Cn.lifecycle.loaded.value){var r;if(this.errorHandler.leaveBreadcrumb("New ".concat(i," event")),Cn.metrics.triggered.value+=1,!Q(e.groupId))null===(r=this.userSessionManager)||void 0===r||r.setGroupId(e.groupId);null===(t=this.userSessionManager)||void 0===t||t.setGroupTraits(e.traits),null===(n=this.eventManager)||void 0===n||n.addEvent({type:i,groupId:e.groupId,traits:e.traits,options:e.options,callback:e.callback})}else Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[i,e]])}},{key:"reset",value:function(e){var t,n="reset";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(n," invocation")),null===(t=this.userSessionManager)||void 0===t||t.reset(e)):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[n,e]])}},{key:"getAnonymousId",value:function(e){var t;return null===(t=this.userSessionManager)||void 0===t?void 0:t.getAnonymousId(e)}},{key:"setAnonymousId",value:function(e,t){var n,i="setAnonymousId";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(i," invocation")),null===(n=this.userSessionManager)||void 0===n||n.setAnonymousId(e,t)):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[i,e,t]])}},{key:"getUserId",value:function(){return Cn.session.userId.value}},{key:"getUserTraits",value:function(){return Cn.session.userTraits.value}},{key:"getGroupId",value:function(){return Cn.session.groupId.value}},{key:"getGroupTraits",value:function(){return Cn.session.groupTraits.value}},{key:"startSession",value:function(e){var t,n="startSession";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(n," invocation")),null===(t=this.userSessionManager)||void 0===t||t.start(e)):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[n,e]])}},{key:"endSession",value:function(){var e,t="endSession";Cn.lifecycle.loaded.value?(this.errorHandler.leaveBreadcrumb("New ".concat(t," invocation")),null===(e=this.userSessionManager)||void 0===e||e.end()):Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[t]])}},{key:"getSessionId",value:function(){var e,t=null===(e=this.userSessionManager)||void 0===e?void 0:e.getSessionId();return null!=t?t:null}},{key:"consent",value:function(e){var t,n,i,r=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Cn.lifecycle.loaded.value){var a;if(this.errorHandler.leaveBreadcrumb("New consent invocation"),yt(function(){Cn.consents.preConsent.value=h(h({},Cn.consents.preConsent.value),{},{enabled:!1}),Cn.consents.postConsent.value=function(e){var t={sendPageEvent:!1,trackConsent:!1,discardPreConsentEvents:!1};if(Z(e)){var n=_(e);t.storage=n.storage,ne(n.integrations)&&(t.integrations=n.integrations),t.discardPreConsentEvents=!0===n.discardPreConsentEvents,t.sendPageEvent=!0===n.sendPageEvent,t.trackConsent=!0===n.trackConsent,ne(n.consentManagement)&&(t.consentManagement=te(n.consentManagement,{enabled:Cn.consents.enabled.value}))}return t}(e);var t=tl(Cn.consents.postConsent.value.consentManagement,r.logger),n=t.initialized,i=t.consentsData;Cn.consents.initialized.value=n,Cn.consents.data.value=i}),Cn.consents.enabled.value&&!Cn.consents.initialized.value)null===(a=this.pluginsManager)||void 0===a||a.invokeSingle("consentManager.updateConsentsInfo",Cn,this.storeManager,this.logger);null===(t=this.storeManager)||void 0===t||t.initializeStorageState(),null===(n=this.userSessionManager)||void 0===n||n.syncStorageDataToState(),null===(i=this.eventManager)||void 0===i||i.resume(),this.loadDestinations(),this.sendTrackingEvents(o)}else Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[["consent",e]])}},{key:"sendTrackingEvents",value:function(e){if(Cn.consents.postConsent.value.trackConsent){var t=fe("Consent Management Interaction");e?Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[["track",t]]):this.track(t)}if(Cn.consents.postConsent.value.sendPageEvent){var n=ve();e?Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[["page",n]]):this.page(n)}}},{key:"setAuthToken",value:function(e){var t;null===(t=this.userSessionManager)||void 0===t||t.setAuthToken(e)}},{key:"addCustomIntegration",value:function(e,t){var n="addCustomIntegration";if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var i;this.errorHandler.leaveBreadcrumb("New ".concat(n," invocation")),null===(i=this.pluginsManager)||void 0===i||i.invokeSingle("nativeDestinations.addCustomIntegration",e,t,Cn,this.logger)}else{if(Cn.lifecycle.loaded.value)return void this.logger.error(function(e,t){return"".concat(e).concat(Ge,'Cannot add custom integration for destination ID "').concat(t,'" after the SDK is loaded.')}(Pe,e));Cn.eventBuffer.toBeProcessedArray.value=[].concat(k(Cn.eventBuffer.toBeProcessedArray.value),[[n,e,t]])}}}])}(),Kl=function(){return s(function e(){o(this,e),u(this,"analyticsInstances",{}),u(this,"defaultAnalyticsKey",""),u(this,"logger",Ft);try{if(e.globalSingleton)return e.globalSingleton;e.initializeGlobalResources(),this.setDefaultInstanceKey=this.setDefaultInstanceKey.bind(this),this.getAnalyticsInstance=this.getAnalyticsInstance.bind(this),this.load=this.load.bind(this),this.ready=this.ready.bind(this),this.triggerBufferedLoadEvent=this.triggerBufferedLoadEvent.bind(this),this.page=this.page.bind(this),this.track=this.track.bind(this),this.identify=this.identify.bind(this),this.alias=this.alias.bind(this),this.group=this.group.bind(this),this.reset=this.reset.bind(this),this.getAnonymousId=this.getAnonymousId.bind(this),this.setAnonymousId=this.setAnonymousId.bind(this),this.getUserId=this.getUserId.bind(this),this.getUserTraits=this.getUserTraits.bind(this),this.getGroupId=this.getGroupId.bind(this),this.getGroupTraits=this.getGroupTraits.bind(this),this.startSession=this.startSession.bind(this),this.endSession=this.endSession.bind(this),this.getSessionId=this.getSessionId.bind(this),this.setAuthToken=this.setAuthToken.bind(this),this.consent=this.consent.bind(this),this.addCustomIntegration=this.addCustomIntegration.bind(this),this.createSafeAnalyticsInstance(),e.globalSingleton=this,Cn.autoTrack.pageLifecycle.pageViewId.value=Le(),Cn.autoTrack.pageLifecycle.pageLoadedTimestamp.value=Date.now(),this.triggerBufferedLoadEvent(),globalThis.rudderanalytics=this}catch(t){Ye(t)}},[{key:"createSafeAnalyticsInstance",value:function(){Cn.lifecycle.safeAnalyticsInstance.value={page:this.page.bind(this),track:this.track.bind(this),identify:this.identify.bind(this),alias:this.alias.bind(this),group:this.group.bind(this),getAnonymousId:this.getAnonymousId.bind(this),getUserId:this.getUserId.bind(this),getUserTraits:this.getUserTraits.bind(this),getGroupId:this.getGroupId.bind(this),getGroupTraits:this.getGroupTraits.bind(this),getSessionId:this.getSessionId.bind(this)}}},{key:"setDefaultInstanceKey",value:function(e){z(e)&&e&&(this.defaultAnalyticsKey=e)}},{key:"getAnalyticsInstance",value:function(e){try{var t=e;return z(t)&&t||(t=this.defaultAnalyticsKey),Boolean(this.analyticsInstances[t])||(this.analyticsInstances[t]=new Ql),this.analyticsInstances[t]}catch(n){return void Ye(n)}}},{key:"load",value:function(e,t,n){try{var i;if(this.analyticsInstances[e])return;this.setDefaultInstanceKey(e),this.trackPageLifecycleEvents(n);var r=lt(tt);!function(e){var t="consent",n=e.filter(function(e){return e[0]===t}),i=e.filter(function(e){return e[0]!==t});e.splice.apply(e,[0,e.length].concat(k(n),k(i)))}(r),ut(tt,_(r)),null===(i=this.getAnalyticsInstance(e))||void 0===i||i.load(e,t,qe(n))}catch(o){Ye(o)}}},{key:"trackPageLifecycleEvents",value:function(e){var t=null!=e?e:{},n=t.autoTrack,i=t.useBeacon,r=null!=n?n:{},o=r.enabled,a=void 0!==o&&o,s=r.options,u=void 0===s?{}:s,l=r.pageLifecycle,c=null!=l?l:{},d=c.events,v=void 0===d?[ye.UNLOADED]:d,f=c.enabled,h=void 0===f?a:f,g=c.options,p=void 0===g?u:g;Cn.autoTrack.pageLifecycle.enabled.value=h,Cn.autoTrack.enabled.value=a||h,h&&this.setupPageUnloadTracking(v,i,p)}},{key:"setupPageUnloadTracking",value:function(e,t,n){var i=this;(0===e.length||e.includes(ye.UNLOADED))&&(!0===t?Ue(function(e){if(!1===e&&Cn.lifecycle.loaded.value){var t=Date.now(),r=t-Cn.autoTrack.pageLifecycle.pageLoadedTimestamp.value;i.track(ye.UNLOADED,{timeOnPage:r},h(h({},n),{},{originalTimestamp:je(new Date(t))}))}}):this.logger.warn("".concat("RudderStackAnalytics").concat(Ge,'Page Unloaded event can only be tracked when the Beacon transport is active. Please enable "useBeacon" load API option.')))}},{key:"triggerBufferedLoadEvent",value:function(){var e=Array.isArray(globalThis.rudderanalytics)?globalThis.rudderanalytics:[],t=function(e){for(var t=[],n=0;n<e.length;){if(e[n]&&"load"===e[n][0]){t=_(e[n]),e.splice(n,1);break}n+=1}return t}(e);ut(tt,_(k(e))),t.length>0&&(t.shift(),this.load.apply(null,t))}},{key:"ready",value:function(e){try{var t;null===(t=this.getAnalyticsInstance())||void 0===t||t.ready(qe(e))}catch(n){Ye(n)}}},{key:"page",value:function(e,t,n,i,r){try{var o;null===(o=this.getAnalyticsInstance())||void 0===o||o.page(ve(qe(e),qe(t),qe(n),qe(i),qe(r)))}catch(a){Ye(a)}}},{key:"track",value:function(e,t,n,i){try{var r;null===(r=this.getAnalyticsInstance())||void 0===r||r.track(fe(qe(e),qe(t),qe(n),qe(i)))}catch(o){Ye(o)}}},{key:"identify",value:function(e,t,n,i){try{var r;null===(r=this.getAnalyticsInstance())||void 0===r||r.identify(he(qe(e),qe(t),qe(n),qe(i)))}catch(o){Ye(o)}}},{key:"alias",value:function(e,t,n,i){try{var r;null===(r=this.getAnalyticsInstance())||void 0===r||r.alias(ge(qe(e),qe(t),qe(n),qe(i)))}catch(o){Ye(o)}}},{key:"group",value:function(e,t,n,i){try{var r;null===(r=this.getAnalyticsInstance())||void 0===r||r.group(pe(qe(e),qe(t),qe(n),qe(i)))}catch(o){Ye(o)}}},{key:"reset",value:function(e){try{var t;null===(t=this.getAnalyticsInstance())||void 0===t||t.reset(qe(e))}catch(n){Ye(n)}}},{key:"getAnonymousId",value:function(e){try{var t;return null===(t=this.getAnalyticsInstance())||void 0===t?void 0:t.getAnonymousId(qe(e))}catch(n){return void Ye(n)}}},{key:"setAnonymousId",value:function(e,t){try{var n;null===(n=this.getAnalyticsInstance())||void 0===n||n.setAnonymousId(qe(e),qe(t))}catch(i){Ye(i)}}},{key:"getUserId",value:function(){try{var e;return null===(e=this.getAnalyticsInstance())||void 0===e?void 0:e.getUserId()}catch(t){return void Ye(t)}}},{key:"getUserTraits",value:function(){try{var e;return null===(e=this.getAnalyticsInstance())||void 0===e?void 0:e.getUserTraits()}catch(t){return void Ye(t)}}},{key:"getGroupId",value:function(){try{var e;return null===(e=this.getAnalyticsInstance())||void 0===e?void 0:e.getGroupId()}catch(t){return void Ye(t)}}},{key:"getGroupTraits",value:function(){try{var e;return null===(e=this.getAnalyticsInstance())||void 0===e?void 0:e.getGroupTraits()}catch(t){return void Ye(t)}}},{key:"startSession",value:function(e){try{var t;null===(t=this.getAnalyticsInstance())||void 0===t||t.startSession(qe(e))}catch(n){Ye(n)}}},{key:"endSession",value:function(){try{var e;null===(e=this.getAnalyticsInstance())||void 0===e||e.endSession()}catch(t){Ye(t)}}},{key:"getSessionId",value:function(){try{var e;return null===(e=this.getAnalyticsInstance())||void 0===e?void 0:e.getSessionId()}catch(t){return void Ye(t)}}},{key:"setAuthToken",value:function(e){try{var t;null===(t=this.getAnalyticsInstance())||void 0===t||t.setAuthToken(qe(e))}catch(n){Ye(n)}}},{key:"consent",value:function(e){try{var t;null===(t=this.getAnalyticsInstance())||void 0===t||t.consent(qe(e))}catch(n){Ye(n)}}},{key:"addCustomIntegration",value:function(e,t){try{var n;null===(n=this.getAnalyticsInstance())||void 0===n||n.addCustomIntegration(qe(e),qe(t))}catch(i){Ye(i)}}}],[{key:"initializeGlobalResources",value:function(){pi.init(),Fu.configure(),Bu.configure(),ju.configure(),Pu.configure()}}])}();u(Kl,"globalSingleton",null);var Vl=new Kl,ql=Vl.setDefaultInstanceKey,Xl=Vl.getAnalyticsInstance,Wl=Vl.load,Jl=Vl.ready,Yl=Vl.page,$l=Vl.track,Zl=Vl.identify,ec=Vl.alias,tc=Vl.group,nc=Vl.reset,ic=Vl.getAnonymousId,rc=Vl.setAnonymousId,oc=Vl.getUserId,ac=Vl.getUserTraits,sc=Vl.getGroupId,uc=Vl.getGroupTraits,lc=Vl.startSession,cc=Vl.endSession,dc=Vl.getSessionId,vc=Vl.consent,fc=Vl.setAuthToken,hc=Vl.addCustomIntegration;return e.addCustomIntegration=hc,e.alias=ec,e.consent=vc,e.endSession=cc,e.getAnalyticsInstance=Xl,e.getAnonymousId=ic,e.getGroupId=sc,e.getGroupTraits=uc,e.getSessionId=dc,e.getUserId=oc,e.getUserTraits=ac,e.group=tc,e.identify=Zl,e.load=Wl,e.page=Yl,e.ready=Jl,e.reset=nc,e.setAnonymousId=rc,e.setAuthToken=fc,e.setDefaultInstanceKey=ql,e.startSession=lc,e.track=$l,e}({});
//# sourceMappingURL=rsa.min.js.map
